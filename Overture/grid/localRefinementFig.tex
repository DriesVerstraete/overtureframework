\begin{figure}[htb]
\psset{xunit=0.9in,yunit=0.9in,runit=0.9in,linewidth=0.4pt}
\begin{center}\pspicture(-3.875,-1.7)(3.875,1.5)
% \psline(-3.875,-1.74)(3.875,-1.74)\psline(3.875,-1.74)(3.875,1.5)\psline(3.875,1.5)(-3.875,1.5)\psline(-3.875,1.5)(-3.875,-1.74)% Frame
  \rput{0}(-0.4,1.2){% Legend
    \psframe[fillcolor=grayninety,fillstyle=solid,linecolor=grayninety](-0.1,-2.4)(0.9,0.0)%
    \psline[linecolor=steelblue](-0.1,-2.4)(0.9,-2.4)\psline[linecolor=steelblue]( 0.9,-2.4)(0.9, 0.0)%
    \footnotesize\psset{labelsep=10pt}%
    \rput{0}(0.40,-0.20){\underline{LEGEND}}%
    \rput{0}(0.00,-0.55){\psset{linecolor=blue}\pscircle(0,0){3pt}\uput[0](0,0.075){base grid}\uput[0](0,-0.075){center}}%
    \rput{0}(0.00,-0.95){\psset{linecolor=red}\pscircle(0,0){1.5pt}\uput[0](0,0.075){refinement}\uput[0](0,-0.075){center}}%
    \rput{0}(0.42,-2.05){refinement}\rput{0}(0.42,-2.20){grid}%
    \rput{0}(0.10,-1.60){%
      \multirput{0}(0,-0.3)(0,0.3){3}{\psset{linecolor=red}\qline(0,0)(0.6,0)}%
      \multirput{0}(0,-0.3)(0.3,0){3}{\psset{linecolor=red}\qline(0,0)(0,0.6)}%
    }%
  }%
  \multirput{0}(-2.25,0)(4.5,0){2}{% Gridlines
    \psframe[fillcolor=grayninety,fillstyle=solid,linecolor=grayninety](-1.2,-1.2)(1.2,1.2)
  }%
  \multirput{0}(-2.25,0)(4.5,0){2}{% Gridlines
    \psset{linecolor=blue}
    \multirput{0}(-1.2,-1.2)(0,0.6){5}{\qline(0,0)(2.4,0)}
    \multirput{0}(-1.2,-1.2)(0.6,0){5}{\qline(0,0)(0,2.4)}
  }%
  \rput{0}(-2.25,0){\psset{linecolor=red}\multirput{0}(-0.6,-0.6)(0,0.3){5}{\qline(0,0)(1.2,0)}\multirput{0}(-0.6,-0.6)(0.3,0){5}{\qline(0,0)(0,1.2)}}% Refinement
  \rput{0}( 2.25,0){\psset{linecolor=red}\multirput{0}(-0.6,-0.6)(0,0.3){5}{\qline(0,0)(1.2,0)}\multirput{0}(-0.6,-0.6)(0.3,0){5}{\qline(0,0)(0,1.2)}}% Refinement
  \rput{0}(-2.25,0){% Centers
    \psset{linecolor=blue}\multirput{0}(0,-1.2)(0,0.6){5}{\multirput{0}(-1.2,0)(0.6,0){5}{\pscircle(0,0){3pt}}}%
    \psset{linecolor=red}\multirput{0}(0,-0.6)(0,0.3){5}{\multirput{0}(-0.6,0)(0.3,0){5}{\pscircle(0,0){1.5pt}}}%
  }%
  \rput{0}(2.25,0){% Centers
    \psset{linecolor=blue}\multirput{0}(0,-0.9)(0,0.6){4}{\multirput{0}(-0.9,0)(0.6,0){4}{\pscircle(0,0){3pt}}}%
    \psset{linecolor=red}\multirput{0}(0,-0.45)(0,0.3){4}{\multirput{0}(-0.45,0)(0.3,0){4}{\pscircle(0,0){1.5pt}}}%
  }%
%* *wdh* 090416 -- trouble with these next in ps2pdf --
%*     These add :   |---- range [1:3] -----| along the bottom and side
%*  \rput{0}(-2.25,0){% Range of refinement
%*    \footnotesize\psset{linecolor=blue}\blue
%*    \pcline[offset=-.2]{|-|}(-0.6,-1.2)(0.6,-1.2)\lput*{:U}{range [1:3]}%
%*    \pcline[offset=.2]{|-|}(-1.2,-0.6)(-1.2,0.6)\lput*{:U}{range [1:3]}%
%*  }%
%*  \rput{0}( 2.25,0){% Range of refinement
%*    \footnotesize\psset{linecolor=blue}\blue
%*    \pcline[offset=-.15]{|-|}(-0.3,-1.2)(0.3,-1.2)\lput{:U}{\rput{0}(0,-.15){range [1:2]}}%
%*    \pcline[offset=.15]{|-|}(-1.2,-0.3)(-1.2,0.3)\lput{:U}{\rput{0}(0,.15){range [1:2]}}%
%*  }%
  \rput{0}(-2.25,0){% Center numbers
    \footnotesize\psset{linecolor=blue}\blue
    \rput{0}(-1.2,-1.2){\uput[0](-.0275,.0625){0}}%
    \rput{0}(-0.6,-1.2){\uput[0](-.0275,.0625){1}}%
    \rput{0}( 0.0,-1.2){\uput[0](-.0275,.0625){2}}%
    \rput{0}( 0.6,-1.2){\uput[0](-.0275,.0625){3}}%
    \rput{0}( 1.2,-1.2){\uput[0](-.0275,.0625){4}}%
    \rput{0}(-1.2,-0.6){\uput[0](-.0275,.0625){1}}%
    \rput{0}(-1.2, 0.0){\uput[0](-.0275,.0625){2}}%
    \rput{0}(-1.2, 0.6){\uput[0](-.0275,.0625){3}}%
    \rput{0}(-1.2, 1.2){\uput[0](-.0275,.0625){4}}%
    \red
    \rput{0}(-0.6,-0.6){\uput[0](-.0275,.0625){2}}%
    \rput{0}(-0.3,-0.6){\uput[0](-.0275,.0625){3}}%
    \rput{0}( 0.0,-0.6){\uput[0](-.0275,.0625){4}}%
    \rput{0}( 0.3,-0.6){\uput[0](-.0275,.0625){5}}%
    \rput{0}( 0.6,-0.6){\uput[0](-.0275,.0625){6}}%
    \rput{0}(-0.6,-0.3){\uput[0](-.0275,.0625){3}}%
    \rput{0}(-0.6, 0.0){\uput[0](-.0275,.0625){4}}%
    \rput{0}(-0.6, 0.3){\uput[0](-.0275,.0625){5}}%
    \rput{0}(-0.6, 0.6){\uput[0](-.0275,.0625){6}}%
  }%
  \rput{0}(2.25,0){% Center numbers
    \footnotesize\psset{linecolor=blue}\blue
    \rput{0}(-0.9,-0.9){\uput[0](-.0275,.0625){0}}%
    \rput{0}(-0.3,-0.9){\uput[0](-.0275,.0625){1}}%
    \rput{0}( 0.3,-0.9){\uput[0](-.0275,.0625){2}}%
    \rput{0}( 0.9,-0.9){\uput[0](-.0275,.0625){3}}%
    \rput{0}(-0.9,-0.3){\uput[0](-.0275,.0625){1}}%
    \rput{0}(-0.9, 0.3){\uput[0](-.0275,.0625){2}}%
    \rput{0}(-0.9, 0.9){\uput[0](-.0275,.0625){3}}%
    \red
    \rput{0}(-0.45,-0.45){\uput[0](-.0275,.0625){2}}%
    \rput{0}(-0.15,-0.45){\uput[0](-.0275,.0625){3}}%
    \rput{0}( 0.15,-0.45){\uput[0](-.0275,.0625){4}}%
    \rput{0}( 0.45,-0.45){\uput[0](-.0275,.0625){5}}%
    \rput{0}(-0.45,-0.15){\uput[0](-.0275,.0625){3}}%
    \rput{0}(-0.45, 0.15){\uput[0](-.0275,.0625){4}}%
    \rput{0}(-0.45, 0.45){\uput[0](-.0275,.0625){5}}%
  }%
  \rput{0}(-2.25,-1.7){\mbox{\hss Vertex-centered grid\hss}}%
  \rput{0}( 2.25,-1.7){\mbox{\hss Cell-centered grid\hss}}%
% \psgrid
\endpspicture\end{center}
\caption[Alignment of \textbf{MappedGrid} refinements for vertex-centered and for cell-centered grids]
        {Alignment of \textbf{MappedGrid} refinements for vertex-centered and for cell-centered grids.
         In this example, the refinement ratio in each direction is two.
         The range of indices of the base grid discretization points to be refined is indicated;
         for the vertex-centered case the range is [1:3,1:3], while for the cell-centered case the range is [1:2,1:2].
         The base-grid and refinement-grid vertices with indices zero are aligned,
         even though these vertices may lie outside the base grid or the refinement grid.
        \label{GridCollection:AlignmentOfRefinements}}
\end{figure}
