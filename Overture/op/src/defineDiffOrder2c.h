// Define statement functions for difference approximations of order 2 
// To include derivatives of rx use OPTION=RX
#beginMacro defineDifferenceOrder2Components0(u,OPTION)

#define #If #OPTION  = "RX"
#define d12(kd)   1./(2.*dr(kd))
#define d22(kd)   1./(SQR(dr(kd)))
#End

#define u ## r2(i1,i2,i3) (u(i1+1,i2,i3)-u(i1-1,i2,i3))*d12(0)
#define u ## s2(i1,i2,i3) (u(i1,i2+1,i3)-u(i1,i2-1,i3))*d12(1)
#define u ## t2(i1,i2,i3) (u(i1,i2,i3+1)-u(i1,i2,i3-1))*d12(2)

#define u ## rr2(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1+1,i2,i3)+u(i1-1,i2,i3)) )*d22(0)
#define u ## ss2(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1,i2+1,i3)+u(i1,i2-1,i3)) )*d22(1)
#define u ## rs2(i1,i2,i3) (u ## r2(i1,i2+1,i3)-u ## r2(i1,i2-1,i3))*d12(1)
#define u ## tt2(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1,i2,i3+1)+u(i1,i2,i3-1)) )*d22(2)
#define u ## rt2(i1,i2,i3) (u ## r2(i1,i2,i3+1)-u ## r2(i1,i2,i3-1))*d12(2)
#define u ## st2(i1,i2,i3) (u ## s2(i1,i2,i3+1)-u ## s2(i1,i2,i3-1))*d12(2)
#define u ## rrr2(i1,i2,i3) (-2.*(u(i1+1,i2,i3)-u(i1-1,i2,i3))+(u(i1+2,i2,i3)-u(i1-2,i2,i3)) )*d22(0)*d12(0)
#define u ## sss2(i1,i2,i3) (-2.*(u(i1,i2+1,i3)-u(i1,i2-1,i3))+(u(i1,i2+2,i3)-u(i1,i2-2,i3)) )*d22(1)*d12(1)
#define u ## ttt2(i1,i2,i3) (-2.*(u(i1,i2,i3+1)-u(i1,i2,i3-1))+(u(i1,i2,i3+2)-u(i1,i2,i3-2)) )*d22(2)*d12(2)

#define #If #OPTION  = "RX"
#define rxr2(i1,i2,i3) (rx(i1+1,i2,i3)-rx(i1-1,i2,i3))*d12(0)
#define rxs2(i1,i2,i3) (rx(i1,i2+1,i3)-rx(i1,i2-1,i3))*d12(1)
#define rxt2(i1,i2,i3) (rx(i1,i2,i3+1)-rx(i1,i2,i3-1))*d12(2)
#define rxrr2(i1,i2,i3) (-2.*rx(i1,i2,i3)+(rx(i1+1,i2,i3)+rx(i1-1,i2,i3)) )*d22(0)
#define rxss2(i1,i2,i3) (-2.*rx(i1,i2,i3)+(rx(i1,i2+1,i3)+rx(i1,i2-1,i3)) )*d22(1)
#define rxrs2(i1,i2,i3) (rx ## r2(i1,i2+1,i3)-rx ## r2(i1,i2-1,i3))*d12(1)
#define ryr2(i1,i2,i3) (ry(i1+1,i2,i3)-ry(i1-1,i2,i3))*d12(0)
#define rys2(i1,i2,i3) (ry(i1,i2+1,i3)-ry(i1,i2-1,i3))*d12(1)
#define ryt2(i1,i2,i3) (ry(i1,i2,i3+1)-ry(i1,i2,i3-1))*d12(2)
#define ryrr2(i1,i2,i3) (-2.*ry(i1,i2,i3)+(ry(i1+1,i2,i3)+ry(i1-1,i2,i3)) )*d22(0)
#define ryss2(i1,i2,i3) (-2.*ry(i1,i2,i3)+(ry(i1,i2+1,i3)+ry(i1,i2-1,i3)) )*d22(1)
#define ryrs2(i1,i2,i3) (ry ## r2(i1,i2+1,i3)-ry ## r2(i1,i2-1,i3))*d12(1)
#define rzr2(i1,i2,i3) (rz(i1+1,i2,i3)-rz(i1-1,i2,i3))*d12(0)
#define rzs2(i1,i2,i3) (rz(i1,i2+1,i3)-rz(i1,i2-1,i3))*d12(1)
#define rzt2(i1,i2,i3) (rz(i1,i2,i3+1)-rz(i1,i2,i3-1))*d12(2)
#define rzrr2(i1,i2,i3) (-2.*rz(i1,i2,i3)+(rz(i1+1,i2,i3)+rz(i1-1,i2,i3)) )*d22(0)
#define rzss2(i1,i2,i3) (-2.*rz(i1,i2,i3)+(rz(i1,i2+1,i3)+rz(i1,i2-1,i3)) )*d22(1)
#define rzrs2(i1,i2,i3) (rz ## r2(i1,i2+1,i3)-rz ## r2(i1,i2-1,i3))*d12(1)
#define sxr2(i1,i2,i3) (sx(i1+1,i2,i3)-sx(i1-1,i2,i3))*d12(0)
#define sxs2(i1,i2,i3) (sx(i1,i2+1,i3)-sx(i1,i2-1,i3))*d12(1)
#define sxt2(i1,i2,i3) (sx(i1,i2,i3+1)-sx(i1,i2,i3-1))*d12(2)
#define sxrr2(i1,i2,i3) (-2.*sx(i1,i2,i3)+(sx(i1+1,i2,i3)+sx(i1-1,i2,i3)) )*d22(0)
#define sxss2(i1,i2,i3) (-2.*sx(i1,i2,i3)+(sx(i1,i2+1,i3)+sx(i1,i2-1,i3)) )*d22(1)
#define sxrs2(i1,i2,i3) (sx ## r2(i1,i2+1,i3)-sx ## r2(i1,i2-1,i3))*d12(1)
#define syr2(i1,i2,i3) (sy(i1+1,i2,i3)-sy(i1-1,i2,i3))*d12(0)
#define sys2(i1,i2,i3) (sy(i1,i2+1,i3)-sy(i1,i2-1,i3))*d12(1)
#define syt2(i1,i2,i3) (sy(i1,i2,i3+1)-sy(i1,i2,i3-1))*d12(2)
#define syrr2(i1,i2,i3) (-2.*sy(i1,i2,i3)+(sy(i1+1,i2,i3)+sy(i1-1,i2,i3)) )*d22(0)
#define syss2(i1,i2,i3) (-2.*sy(i1,i2,i3)+(sy(i1,i2+1,i3)+sy(i1,i2-1,i3)) )*d22(1)
#define syrs2(i1,i2,i3) (sy ## r2(i1,i2+1,i3)-sy ## r2(i1,i2-1,i3))*d12(1)
#define szr2(i1,i2,i3) (sz(i1+1,i2,i3)-sz(i1-1,i2,i3))*d12(0)
#define szs2(i1,i2,i3) (sz(i1,i2+1,i3)-sz(i1,i2-1,i3))*d12(1)
#define szt2(i1,i2,i3) (sz(i1,i2,i3+1)-sz(i1,i2,i3-1))*d12(2)
#define szrr2(i1,i2,i3) (-2.*sz(i1,i2,i3)+(sz(i1+1,i2,i3)+sz(i1-1,i2,i3)) )*d22(0)
#define szss2(i1,i2,i3) (-2.*sz(i1,i2,i3)+(sz(i1,i2+1,i3)+sz(i1,i2-1,i3)) )*d22(1)
#define szrs2(i1,i2,i3) (sz ## r2(i1,i2+1,i3)-sz ## r2(i1,i2-1,i3))*d12(1)
#define txr2(i1,i2,i3) (tx(i1+1,i2,i3)-tx(i1-1,i2,i3))*d12(0)
#define txs2(i1,i2,i3) (tx(i1,i2+1,i3)-tx(i1,i2-1,i3))*d12(1)
#define txt2(i1,i2,i3) (tx(i1,i2,i3+1)-tx(i1,i2,i3-1))*d12(2)
#define txrr2(i1,i2,i3) (-2.*tx(i1,i2,i3)+(tx(i1+1,i2,i3)+tx(i1-1,i2,i3)) )*d22(0)
#define txss2(i1,i2,i3) (-2.*tx(i1,i2,i3)+(tx(i1,i2+1,i3)+tx(i1,i2-1,i3)) )*d22(1)
#define txrs2(i1,i2,i3) (tx ## r2(i1,i2+1,i3)-tx ## r2(i1,i2-1,i3))*d12(1)
#define tyr2(i1,i2,i3) (ty(i1+1,i2,i3)-ty(i1-1,i2,i3))*d12(0)
#define tys2(i1,i2,i3) (ty(i1,i2+1,i3)-ty(i1,i2-1,i3))*d12(1)
#define tyt2(i1,i2,i3) (ty(i1,i2,i3+1)-ty(i1,i2,i3-1))*d12(2)
#define tyrr2(i1,i2,i3) (-2.*ty(i1,i2,i3)+(ty(i1+1,i2,i3)+ty(i1-1,i2,i3)) )*d22(0)
#define tyss2(i1,i2,i3) (-2.*ty(i1,i2,i3)+(ty(i1,i2+1,i3)+ty(i1,i2-1,i3)) )*d22(1)
#define tyrs2(i1,i2,i3) (ty ## r2(i1,i2+1,i3)-ty ## r2(i1,i2-1,i3))*d12(1)
#define tzr2(i1,i2,i3) (tz(i1+1,i2,i3)-tz(i1-1,i2,i3))*d12(0)
#define tzs2(i1,i2,i3) (tz(i1,i2+1,i3)-tz(i1,i2-1,i3))*d12(1)
#define tzt2(i1,i2,i3) (tz(i1,i2,i3+1)-tz(i1,i2,i3-1))*d12(2)
#define tzrr2(i1,i2,i3) (-2.*tz(i1,i2,i3)+(tz(i1+1,i2,i3)+tz(i1-1,i2,i3)) )*d22(0)
#define tzss2(i1,i2,i3) (-2.*tz(i1,i2,i3)+(tz(i1,i2+1,i3)+tz(i1,i2-1,i3)) )*d22(1)
#define tzrs2(i1,i2,i3) (tz ## r2(i1,i2+1,i3)-tz ## r2(i1,i2-1,i3))*d12(1)
#End

#define u ## x21(i1,i2,i3)  rx(i1,i2,i3)*u ## r2(i1,i2,i3)
#define u ## y21(i1,i2,i3) 0
#define u ## z21(i1,i2,i3) 0

#define u ## x22(i1,i2,i3)  rx(i1,i2,i3)*u ## r2(i1,i2,i3)+sx(i1,i2,i3)*u ## s2(i1,i2,i3)
#define u ## y22(i1,i2,i3)  ry(i1,i2,i3)*u ## r2(i1,i2,i3)+sy(i1,i2,i3)*u ## s2(i1,i2,i3)
#define u ## z22(i1,i2,i3) 0
#define u ## x23(i1,i2,i3) rx(i1,i2,i3)*u ## r2(i1,i2,i3)+sx(i1,i2,i3)*u ## s2(i1,i2,i3)+tx(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## y23(i1,i2,i3) ry(i1,i2,i3)*u ## r2(i1,i2,i3)+sy(i1,i2,i3)*u ## s2(i1,i2,i3)+ty(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## z23(i1,i2,i3) rz(i1,i2,i3)*u ## r2(i1,i2,i3)+sz(i1,i2,i3)*u ## s2(i1,i2,i3)+tz(i1,i2,i3)*u ## t2(i1,i2,i3)

#define #If #OPTION  = "RX"
#define rxx21(i1,i2,i3)  rx(i1,i2,i3)*rxr2(i1,i2,i3)
#define rxx22(i1,i2,i3)  rx(i1,i2,i3)*rxr2(i1,i2,i3)+sx(i1,i2,i3)*rxs2(i1,i2,i3)
#define rxy22(i1,i2,i3)  ry(i1,i2,i3)*rxr2(i1,i2,i3)+sy(i1,i2,i3)*rxs2(i1,i2,i3)
#define rxx23(i1,i2,i3) rx(i1,i2,i3)*rxr2(i1,i2,i3)+sx(i1,i2,i3)*rxs2(i1,i2,i3)+tx(i1,i2,i3)*rxt2(i1,i2,i3)
#define rxy23(i1,i2,i3) ry(i1,i2,i3)*rxr2(i1,i2,i3)+sy(i1,i2,i3)*rxs2(i1,i2,i3)+ty(i1,i2,i3)*rxt2(i1,i2,i3)
#define rxz23(i1,i2,i3) rz(i1,i2,i3)*rxr2(i1,i2,i3)+sz(i1,i2,i3)*rxs2(i1,i2,i3)+tz(i1,i2,i3)*rxt2(i1,i2,i3)
#define ryx22(i1,i2,i3)  rx(i1,i2,i3)*ryr2(i1,i2,i3)+sx(i1,i2,i3)*rys2(i1,i2,i3)
#define ryy22(i1,i2,i3)  ry(i1,i2,i3)*ryr2(i1,i2,i3)+sy(i1,i2,i3)*rys2(i1,i2,i3)
#define ryx23(i1,i2,i3) rx(i1,i2,i3)*ryr2(i1,i2,i3)+sx(i1,i2,i3)*rys2(i1,i2,i3)+tx(i1,i2,i3)*ryt2(i1,i2,i3)
#define ryy23(i1,i2,i3) ry(i1,i2,i3)*ryr2(i1,i2,i3)+sy(i1,i2,i3)*rys2(i1,i2,i3)+ty(i1,i2,i3)*ryt2(i1,i2,i3)
#define ryz23(i1,i2,i3) rz(i1,i2,i3)*ryr2(i1,i2,i3)+sz(i1,i2,i3)*rys2(i1,i2,i3)+tz(i1,i2,i3)*ryt2(i1,i2,i3)
#define rzx22(i1,i2,i3)  rx(i1,i2,i3)*rzr2(i1,i2,i3)+sx(i1,i2,i3)*rzs2(i1,i2,i3)
#define rzy22(i1,i2,i3)  ry(i1,i2,i3)*rzr2(i1,i2,i3)+sy(i1,i2,i3)*rzs2(i1,i2,i3)
#define rzx23(i1,i2,i3) rx(i1,i2,i3)*rzr2(i1,i2,i3)+sx(i1,i2,i3)*rzs2(i1,i2,i3)+tx(i1,i2,i3)*rzt2(i1,i2,i3)
#define rzy23(i1,i2,i3) ry(i1,i2,i3)*rzr2(i1,i2,i3)+sy(i1,i2,i3)*rzs2(i1,i2,i3)+ty(i1,i2,i3)*rzt2(i1,i2,i3)
#define rzz23(i1,i2,i3) rz(i1,i2,i3)*rzr2(i1,i2,i3)+sz(i1,i2,i3)*rzs2(i1,i2,i3)+tz(i1,i2,i3)*rzt2(i1,i2,i3)
#define sxx22(i1,i2,i3)  rx(i1,i2,i3)*sxr2(i1,i2,i3)+sx(i1,i2,i3)*sxs2(i1,i2,i3)
#define sxy22(i1,i2,i3)  ry(i1,i2,i3)*sxr2(i1,i2,i3)+sy(i1,i2,i3)*sxs2(i1,i2,i3)
#define sxx23(i1,i2,i3) rx(i1,i2,i3)*sxr2(i1,i2,i3)+sx(i1,i2,i3)*sxs2(i1,i2,i3)+tx(i1,i2,i3)*sxt2(i1,i2,i3)
#define sxy23(i1,i2,i3) ry(i1,i2,i3)*sxr2(i1,i2,i3)+sy(i1,i2,i3)*sxs2(i1,i2,i3)+ty(i1,i2,i3)*sxt2(i1,i2,i3)
#define sxz23(i1,i2,i3) rz(i1,i2,i3)*sxr2(i1,i2,i3)+sz(i1,i2,i3)*sxs2(i1,i2,i3)+tz(i1,i2,i3)*sxt2(i1,i2,i3)
#define syx22(i1,i2,i3)  rx(i1,i2,i3)*syr2(i1,i2,i3)+sx(i1,i2,i3)*sys2(i1,i2,i3)
#define syy22(i1,i2,i3)  ry(i1,i2,i3)*syr2(i1,i2,i3)+sy(i1,i2,i3)*sys2(i1,i2,i3)
#define syx23(i1,i2,i3) rx(i1,i2,i3)*syr2(i1,i2,i3)+sx(i1,i2,i3)*sys2(i1,i2,i3)+tx(i1,i2,i3)*syt2(i1,i2,i3)
#define syy23(i1,i2,i3) ry(i1,i2,i3)*syr2(i1,i2,i3)+sy(i1,i2,i3)*sys2(i1,i2,i3)+ty(i1,i2,i3)*syt2(i1,i2,i3)
#define syz23(i1,i2,i3) rz(i1,i2,i3)*syr2(i1,i2,i3)+sz(i1,i2,i3)*sys2(i1,i2,i3)+tz(i1,i2,i3)*syt2(i1,i2,i3)
#define szx22(i1,i2,i3)  rx(i1,i2,i3)*szr2(i1,i2,i3)+sx(i1,i2,i3)*szs2(i1,i2,i3)
#define szy22(i1,i2,i3)  ry(i1,i2,i3)*szr2(i1,i2,i3)+sy(i1,i2,i3)*szs2(i1,i2,i3)
#define szx23(i1,i2,i3) rx(i1,i2,i3)*szr2(i1,i2,i3)+sx(i1,i2,i3)*szs2(i1,i2,i3)+tx(i1,i2,i3)*szt2(i1,i2,i3)
#define szy23(i1,i2,i3) ry(i1,i2,i3)*szr2(i1,i2,i3)+sy(i1,i2,i3)*szs2(i1,i2,i3)+ty(i1,i2,i3)*szt2(i1,i2,i3)
#define szz23(i1,i2,i3) rz(i1,i2,i3)*szr2(i1,i2,i3)+sz(i1,i2,i3)*szs2(i1,i2,i3)+tz(i1,i2,i3)*szt2(i1,i2,i3)
#define txx22(i1,i2,i3)  rx(i1,i2,i3)*txr2(i1,i2,i3)+sx(i1,i2,i3)*txs2(i1,i2,i3)
#define txy22(i1,i2,i3)  ry(i1,i2,i3)*txr2(i1,i2,i3)+sy(i1,i2,i3)*txs2(i1,i2,i3)
#define txx23(i1,i2,i3) rx(i1,i2,i3)*txr2(i1,i2,i3)+sx(i1,i2,i3)*txs2(i1,i2,i3)+tx(i1,i2,i3)*txt2(i1,i2,i3)
#define txy23(i1,i2,i3) ry(i1,i2,i3)*txr2(i1,i2,i3)+sy(i1,i2,i3)*txs2(i1,i2,i3)+ty(i1,i2,i3)*txt2(i1,i2,i3)
#define txz23(i1,i2,i3) rz(i1,i2,i3)*txr2(i1,i2,i3)+sz(i1,i2,i3)*txs2(i1,i2,i3)+tz(i1,i2,i3)*txt2(i1,i2,i3)
#define tyx22(i1,i2,i3)  rx(i1,i2,i3)*tyr2(i1,i2,i3)+sx(i1,i2,i3)*tys2(i1,i2,i3)
#define tyy22(i1,i2,i3)  ry(i1,i2,i3)*tyr2(i1,i2,i3)+sy(i1,i2,i3)*tys2(i1,i2,i3)
#define tyx23(i1,i2,i3) rx(i1,i2,i3)*tyr2(i1,i2,i3)+sx(i1,i2,i3)*tys2(i1,i2,i3)+tx(i1,i2,i3)*tyt2(i1,i2,i3)
#define tyy23(i1,i2,i3) ry(i1,i2,i3)*tyr2(i1,i2,i3)+sy(i1,i2,i3)*tys2(i1,i2,i3)+ty(i1,i2,i3)*tyt2(i1,i2,i3)
#define tyz23(i1,i2,i3) rz(i1,i2,i3)*tyr2(i1,i2,i3)+sz(i1,i2,i3)*tys2(i1,i2,i3)+tz(i1,i2,i3)*tyt2(i1,i2,i3)
#define tzx22(i1,i2,i3)  rx(i1,i2,i3)*tzr2(i1,i2,i3)+sx(i1,i2,i3)*tzs2(i1,i2,i3)
#define tzy22(i1,i2,i3)  ry(i1,i2,i3)*tzr2(i1,i2,i3)+sy(i1,i2,i3)*tzs2(i1,i2,i3)
#define tzx23(i1,i2,i3) rx(i1,i2,i3)*tzr2(i1,i2,i3)+sx(i1,i2,i3)*tzs2(i1,i2,i3)+tx(i1,i2,i3)*tzt2(i1,i2,i3)
#define tzy23(i1,i2,i3) ry(i1,i2,i3)*tzr2(i1,i2,i3)+sy(i1,i2,i3)*tzs2(i1,i2,i3)+ty(i1,i2,i3)*tzt2(i1,i2,i3)
#define tzz23(i1,i2,i3) rz(i1,i2,i3)*tzr2(i1,i2,i3)+sz(i1,i2,i3)*tzs2(i1,i2,i3)+tz(i1,i2,i3)*tzt2(i1,i2,i3)
#End

#define u ## xx21(i1,i2,i3) (SQR(rx(i1,i2,i3)))*u ## rr2(i1,i2,i3)+(rxx22(i1,i2,i3))*u ## r2(i1,i2,i3)
#define u ## yy21(i1,i2,i3) 0
#define u ## xy21(i1,i2,i3) 0
#define u ## xz21(i1,i2,i3) 0
#define u ## yz21(i1,i2,i3) 0
#define u ## zz21(i1,i2,i3) 0
#define u ## laplacian21(i1,i2,i3) u ## xx21(i1,i2,i3)
#define u ## xx22(i1,i2,i3) (SQR(rx(i1,i2,i3)))*u ## rr2(i1,i2,i3)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3)+(SQR(sx(i1,i2,i3)))*u ## ss2(i1,i2,i3)+(rxx22(i1,i2,i3))*u ## r2(i1,i2,i3)+(sxx22(i1,i2,i3))*u ## s2(i1,i2,i3)
#define u ## yy22(i1,i2,i3) (SQR(ry(i1,i2,i3)))*u ## rr2(i1,i2,i3)+2.*(ry(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3)+(SQR(sy(i1,i2,i3)))*u ## ss2(i1,i2,i3)+(ryy22(i1,i2,i3))*u ## r2(i1,i2,i3)+(syy22(i1,i2,i3))*u ## s2(i1,i2,i3)
#define u ## xy22(i1,i2,i3) rx(i1,i2,i3)*ry(i1,i2,i3)*u ## rr2(i1,i2,i3)+(rx(i1,i2,i3)*sy(i1,i2,i3)+ry(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3)+sx(i1,i2,i3)*sy(i1,i2,i3)*u ## ss2(i1,i2,i3)+rxy22(i1,i2,i3)*u ## r2(i1,i2,i3)+sxy22(i1,i2,i3)*u ## s2(i1,i2,i3)
#define u ## xz22(i1,i2,i3) 0
#define u ## yz22(i1,i2,i3) 0
#define u ## zz22(i1,i2,i3) 0
#define u ## laplacian22(i1,i2,i3) (SQR(rx(i1,i2,i3))+SQR(ry(i1,i2,i3)))*u ## rr2(i1,i2,i3)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3)+ ry(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3)+(SQR(sx(i1,i2,i3))+SQR(sy(i1,i2,i3)))*u ## ss2(i1,i2,i3)+(rxx22(i1,i2,i3)+ryy22(i1,i2,i3))*u ## r2(i1,i2,i3)+(sxx22(i1,i2,i3)+syy22(i1,i2,i3))*u ## s2(i1,i2,i3)
#define u ## xx23(i1,i2,i3) SQR(rx(i1,i2,i3))*u ## rr2(i1,i2,i3)+SQR(sx(i1,i2,i3))*u ## ss2(i1,i2,i3)+SQR(tx(i1,i2,i3))*u ## tt2(i1,i2,i3)+2.*rx(i1,i2,i3)*sx(i1,i2,i3)*u ## rs2(i1,i2,i3)+2.*rx(i1,i2,i3)*tx(i1,i2,i3)*u ## rt2(i1,i2,i3)+2.*sx(i1,i2,i3)*tx(i1,i2,i3)*u ## st2(i1,i2,i3)+rxx23(i1,i2,i3)*u ## r2(i1,i2,i3)+sxx23(i1,i2,i3)*u ## s2(i1,i2,i3)+txx23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## yy23(i1,i2,i3) SQR(ry(i1,i2,i3))*u ## rr2(i1,i2,i3)+SQR(sy(i1,i2,i3))*u ## ss2(i1,i2,i3)+SQR(ty(i1,i2,i3))*u ## tt2(i1,i2,i3)+2.*ry(i1,i2,i3)*sy(i1,i2,i3)*u ## rs2(i1,i2,i3)+2.*ry(i1,i2,i3)*ty(i1,i2,i3)*u ## rt2(i1,i2,i3)+2.*sy(i1,i2,i3)*ty(i1,i2,i3)*u ## st2(i1,i2,i3)+ryy23(i1,i2,i3)*u ## r2(i1,i2,i3)+syy23(i1,i2,i3)*u ## s2(i1,i2,i3)+tyy23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## zz23(i1,i2,i3) SQR(rz(i1,i2,i3))*u ## rr2(i1,i2,i3)+SQR(sz(i1,i2,i3))*u ## ss2(i1,i2,i3)+SQR(tz(i1,i2,i3))*u ## tt2(i1,i2,i3)+2.*rz(i1,i2,i3)*sz(i1,i2,i3)*u ## rs2(i1,i2,i3)+2.*rz(i1,i2,i3)*tz(i1,i2,i3)*u ## rt2(i1,i2,i3)+2.*sz(i1,i2,i3)*tz(i1,i2,i3)*u ## st2(i1,i2,i3)+rzz23(i1,i2,i3)*u ## r2(i1,i2,i3)+szz23(i1,i2,i3)*u ## s2(i1,i2,i3)+tzz23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## xy23(i1,i2,i3) rx(i1,i2,i3)*ry(i1,i2,i3)*u ## rr2(i1,i2,i3)+sx(i1,i2,i3)*sy(i1,i2,i3)*u ## ss2(i1,i2,i3)+tx(i1,i2,i3)*ty(i1,i2,i3)*u ## tt2(i1,i2,i3)+(rx(i1,i2,i3)*sy(i1,i2,i3)+ry(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3)+(rx(i1,i2,i3)*ty(i1,i2,i3)+ry(i1,i2,i3)*tx(i1,i2,i3))*u ## rt2(i1,i2,i3)+(sx(i1,i2,i3)*ty(i1,i2,i3)+sy(i1,i2,i3)*tx(i1,i2,i3))*u ## st2(i1,i2,i3)+rxy23(i1,i2,i3)*u ## r2(i1,i2,i3)+sxy23(i1,i2,i3)*u ## s2(i1,i2,i3)+txy23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## xz23(i1,i2,i3) rx(i1,i2,i3)*rz(i1,i2,i3)*u ## rr2(i1,i2,i3)+sx(i1,i2,i3)*sz(i1,i2,i3)*u ## ss2(i1,i2,i3)+tx(i1,i2,i3)*tz(i1,i2,i3)*u ## tt2(i1,i2,i3)+(rx(i1,i2,i3)*sz(i1,i2,i3)+rz(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3)+(rx(i1,i2,i3)*tz(i1,i2,i3)+rz(i1,i2,i3)*tx(i1,i2,i3))*u ## rt2(i1,i2,i3)+(sx(i1,i2,i3)*tz(i1,i2,i3)+sz(i1,i2,i3)*tx(i1,i2,i3))*u ## st2(i1,i2,i3)+rxz23(i1,i2,i3)*u ## r2(i1,i2,i3)+sxz23(i1,i2,i3)*u ## s2(i1,i2,i3)+txz23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## yz23(i1,i2,i3) ry(i1,i2,i3)*rz(i1,i2,i3)*u ## rr2(i1,i2,i3)+sy(i1,i2,i3)*sz(i1,i2,i3)*u ## ss2(i1,i2,i3)+ty(i1,i2,i3)*tz(i1,i2,i3)*u ## tt2(i1,i2,i3)+(ry(i1,i2,i3)*sz(i1,i2,i3)+rz(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3)+(ry(i1,i2,i3)*tz(i1,i2,i3)+rz(i1,i2,i3)*ty(i1,i2,i3))*u ## rt2(i1,i2,i3)+(sy(i1,i2,i3)*tz(i1,i2,i3)+sz(i1,i2,i3)*ty(i1,i2,i3))*u ## st2(i1,i2,i3)+ryz23(i1,i2,i3)*u ## r2(i1,i2,i3)+syz23(i1,i2,i3)*u ## s2(i1,i2,i3)+tyz23(i1,i2,i3)*u ## t2(i1,i2,i3)
#define u ## laplacian23(i1,i2,i3) (SQR(rx(i1,i2,i3))+SQR(ry(i1,i2,i3))+SQR(rz(i1,i2,i3)))*u ## rr2(i1,i2,i3)+(SQR(sx(i1,i2,i3))+SQR(sy(i1,i2,i3))+SQR(sz(i1,i2,i3)))*u ## ss2(i1,i2,i3)+(SQR(tx(i1,i2,i3))+SQR(ty(i1,i2,i3))+SQR(tz(i1,i2,i3)))*u ## tt2(i1,i2,i3)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3)+ ry(i1,i2,i3)*sy(i1,i2,i3)+rz(i1,i2,i3)*sz(i1,i2,i3))*u ## rs2(i1,i2,i3)+2.*(rx(i1,i2,i3)*tx(i1,i2,i3)+ ry(i1,i2,i3)*ty(i1,i2,i3)+rz(i1,i2,i3)*tz(i1,i2,i3))*u ## rt2(i1,i2,i3)+2.*(sx(i1,i2,i3)*tx(i1,i2,i3)+ sy(i1,i2,i3)*ty(i1,i2,i3)+sz(i1,i2,i3)*tz(i1,i2,i3))*u ## st2(i1,i2,i3)+(rxx23(i1,i2,i3)+ryy23(i1,i2,i3)+rzz23(i1,i2,i3))*u ## r2(i1,i2,i3)+(sxx23(i1,i2,i3)+syy23(i1,i2,i3)+szz23(i1,i2,i3))*u ## s2(i1,i2,i3)+(txx23(i1,i2,i3)+tyy23(i1,i2,i3)+tzz23(i1,i2,i3))*u ## t2(i1,i2,i3)
//============================================================================================
// Define derivatives for a rectangular grid
//
//============================================================================================
#define #If #OPTION  = "RX"
#define h12(kd)   1./(2.*dx(kd))
#define h22(kd)   1./(SQR(dx(kd)))
#End

#define u ## x23r(i1,i2,i3) (u(i1+1,i2,i3)-u(i1-1,i2,i3))*h12(0)
#define u ## y23r(i1,i2,i3) (u(i1,i2+1,i3)-u(i1,i2-1,i3))*h12(1)
#define u ## z23r(i1,i2,i3) (u(i1,i2,i3+1)-u(i1,i2,i3-1))*h12(2)

#define u ## xx23r(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1+1,i2,i3)+u(i1-1,i2,i3)) )*h22(0)
#define u ## yy23r(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1,i2+1,i3)+u(i1,i2-1,i3)) )*h22(1)
#define u ## xy23r(i1,i2,i3) (u ## x23r(i1,i2+1,i3)-u ## x23r(i1,i2-1,i3))*h12(1)
#define u ## zz23r(i1,i2,i3) (-2.*u(i1,i2,i3)+(u(i1,i2,i3+1)+u(i1,i2,i3-1)) )*h22(2)
#define u ## xz23r(i1,i2,i3) (u ## x23r(i1,i2,i3+1)-u ## x23r(i1,i2,i3-1))*h12(2)
#define u ## yz23r(i1,i2,i3) (u ## y23r(i1,i2,i3+1)-u ## y23r(i1,i2,i3-1))*h12(2)

#define u ## x21r(i1,i2,i3)  u ## x23r(i1,i2,i3)
#define u ## y21r(i1,i2,i3)  u ## y23r(i1,i2,i3)
#define u ## z21r(i1,i2,i3)  u ## z23r(i1,i2,i3)
#define u ## xx21r(i1,i2,i3)  u ## xx23r(i1,i2,i3)
#define u ## yy21r(i1,i2,i3)  u ## yy23r(i1,i2,i3)
#define u ## zz21r(i1,i2,i3)  u ## zz23r(i1,i2,i3)
#define u ## xy21r(i1,i2,i3)  u ## xy23r(i1,i2,i3)
#define u ## xz21r(i1,i2,i3)  u ## xz23r(i1,i2,i3)
#define u ## yz21r(i1,i2,i3)  u ## yz23r(i1,i2,i3)
#define u ## laplacian21r(i1,i2,i3) u ## xx23r(i1,i2,i3)
#define u ## x22r(i1,i2,i3)  u ## x23r(i1,i2,i3)
#define u ## y22r(i1,i2,i3)  u ## y23r(i1,i2,i3)
#define u ## z22r(i1,i2,i3)  u ## z23r(i1,i2,i3)
#define u ## xx22r(i1,i2,i3)  u ## xx23r(i1,i2,i3)
#define u ## yy22r(i1,i2,i3)  u ## yy23r(i1,i2,i3)
#define u ## zz22r(i1,i2,i3)  u ## zz23r(i1,i2,i3)
#define u ## xy22r(i1,i2,i3)  u ## xy23r(i1,i2,i3)
#define u ## xz22r(i1,i2,i3)  u ## xz23r(i1,i2,i3)
#define u ## yz22r(i1,i2,i3)  u ## yz23r(i1,i2,i3)
#define u ## laplacian22r(i1,i2,i3) u ## xx23r(i1,i2,i3)+u ## yy23r(i1,i2,i3)
#define u ## laplacian23r(i1,i2,i3) u ## xx23r(i1,i2,i3)+u ## yy23r(i1,i2,i3)+u ## zz23r(i1,i2,i3)
#endMacro
// To include derivatives of rx use OPTION=RX
#beginMacro defineDifferenceOrder2Components1(u,OPTION)

#If #OPTION == "RX"
d12(kd) = 1./(2.*dr(kd))
d22(kd) = 1./(SQR(dr(kd)))
#End

u ## r2(i1,i2,i3,kd)=(u(i1+1,i2,i3,kd)-u(i1-1,i2,i3,kd))*d12(0)
u ## s2(i1,i2,i3,kd)=(u(i1,i2+1,i3,kd)-u(i1,i2-1,i3,kd))*d12(1)
u ## t2(i1,i2,i3,kd)=(u(i1,i2,i3+1,kd)-u(i1,i2,i3-1,kd))*d12(2)

u ## rr2(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1+1,i2,i3,kd)+u(i1-1,i2,i3,kd)) )*d22(0)
u ## ss2(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1,i2+1,i3,kd)+u(i1,i2-1,i3,kd)) )*d22(1)
u ## rs2(i1,i2,i3,kd)=(u ## r2(i1,i2+1,i3,kd)-u ## r2(i1,i2-1,i3,kd))*d12(1)
u ## tt2(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1,i2,i3+1,kd)+u(i1,i2,i3-1,kd)) )*d22(2)
u ## rt2(i1,i2,i3,kd)=(u ## r2(i1,i2,i3+1,kd)-u ## r2(i1,i2,i3-1,kd))*d12(2)
u ## st2(i1,i2,i3,kd)=(u ## s2(i1,i2,i3+1,kd)-u ## s2(i1,i2,i3-1,kd))*d12(2)
u ## rrr2(i1,i2,i3,kd)=(-2.*(u(i1+1,i2,i3,kd)-u(i1-1,i2,i3,kd))+(u(i1+2,i2,i3,kd)-u(i1-2,i2,i3,kd)) )*d22(0)*d12(0)
u ## sss2(i1,i2,i3,kd)=(-2.*(u(i1,i2+1,i3,kd)-u(i1,i2-1,i3,kd))+(u(i1,i2+2,i3,kd)-u(i1,i2-2,i3,kd)) )*d22(1)*d12(1)
u ## ttt2(i1,i2,i3,kd)=(-2.*(u(i1,i2,i3+1,kd)-u(i1,i2,i3-1,kd))+(u(i1,i2,i3+2,kd)-u(i1,i2,i3-2,kd)) )*d22(2)*d12(2)

#If #OPTION == "RX"
rxr2(i1,i2,i3)=(rx(i1+1,i2,i3)-rx(i1-1,i2,i3))*d12(0)
rxs2(i1,i2,i3)=(rx(i1,i2+1,i3)-rx(i1,i2-1,i3))*d12(1)
rxt2(i1,i2,i3)=(rx(i1,i2,i3+1)-rx(i1,i2,i3-1))*d12(2)
rxrr2(i1,i2,i3)=(-2.*rx(i1,i2,i3)+(rx(i1+1,i2,i3)+rx(i1-1,i2,i3)) )*d22(0)
rxss2(i1,i2,i3)=(-2.*rx(i1,i2,i3)+(rx(i1,i2+1,i3)+rx(i1,i2-1,i3)) )*d22(1)
rxrs2(i1,i2,i3)=(rx ## r2(i1,i2+1,i3)-rx ## r2(i1,i2-1,i3))*d12(1)
ryr2(i1,i2,i3)=(ry(i1+1,i2,i3)-ry(i1-1,i2,i3))*d12(0)
rys2(i1,i2,i3)=(ry(i1,i2+1,i3)-ry(i1,i2-1,i3))*d12(1)
ryt2(i1,i2,i3)=(ry(i1,i2,i3+1)-ry(i1,i2,i3-1))*d12(2)
ryrr2(i1,i2,i3)=(-2.*ry(i1,i2,i3)+(ry(i1+1,i2,i3)+ry(i1-1,i2,i3)) )*d22(0)
ryss2(i1,i2,i3)=(-2.*ry(i1,i2,i3)+(ry(i1,i2+1,i3)+ry(i1,i2-1,i3)) )*d22(1)
ryrs2(i1,i2,i3)=(ry ## r2(i1,i2+1,i3)-ry ## r2(i1,i2-1,i3))*d12(1)
rzr2(i1,i2,i3)=(rz(i1+1,i2,i3)-rz(i1-1,i2,i3))*d12(0)
rzs2(i1,i2,i3)=(rz(i1,i2+1,i3)-rz(i1,i2-1,i3))*d12(1)
rzt2(i1,i2,i3)=(rz(i1,i2,i3+1)-rz(i1,i2,i3-1))*d12(2)
rzrr2(i1,i2,i3)=(-2.*rz(i1,i2,i3)+(rz(i1+1,i2,i3)+rz(i1-1,i2,i3)) )*d22(0)
rzss2(i1,i2,i3)=(-2.*rz(i1,i2,i3)+(rz(i1,i2+1,i3)+rz(i1,i2-1,i3)) )*d22(1)
rzrs2(i1,i2,i3)=(rz ## r2(i1,i2+1,i3)-rz ## r2(i1,i2-1,i3))*d12(1)
sxr2(i1,i2,i3)=(sx(i1+1,i2,i3)-sx(i1-1,i2,i3))*d12(0)
sxs2(i1,i2,i3)=(sx(i1,i2+1,i3)-sx(i1,i2-1,i3))*d12(1)
sxt2(i1,i2,i3)=(sx(i1,i2,i3+1)-sx(i1,i2,i3-1))*d12(2)
sxrr2(i1,i2,i3)=(-2.*sx(i1,i2,i3)+(sx(i1+1,i2,i3)+sx(i1-1,i2,i3)) )*d22(0)
sxss2(i1,i2,i3)=(-2.*sx(i1,i2,i3)+(sx(i1,i2+1,i3)+sx(i1,i2-1,i3)) )*d22(1)
sxrs2(i1,i2,i3)=(sx ## r2(i1,i2+1,i3)-sx ## r2(i1,i2-1,i3))*d12(1)
syr2(i1,i2,i3)=(sy(i1+1,i2,i3)-sy(i1-1,i2,i3))*d12(0)
sys2(i1,i2,i3)=(sy(i1,i2+1,i3)-sy(i1,i2-1,i3))*d12(1)
syt2(i1,i2,i3)=(sy(i1,i2,i3+1)-sy(i1,i2,i3-1))*d12(2)
syrr2(i1,i2,i3)=(-2.*sy(i1,i2,i3)+(sy(i1+1,i2,i3)+sy(i1-1,i2,i3)) )*d22(0)
syss2(i1,i2,i3)=(-2.*sy(i1,i2,i3)+(sy(i1,i2+1,i3)+sy(i1,i2-1,i3)) )*d22(1)
syrs2(i1,i2,i3)=(sy ## r2(i1,i2+1,i3)-sy ## r2(i1,i2-1,i3))*d12(1)
szr2(i1,i2,i3)=(sz(i1+1,i2,i3)-sz(i1-1,i2,i3))*d12(0)
szs2(i1,i2,i3)=(sz(i1,i2+1,i3)-sz(i1,i2-1,i3))*d12(1)
szt2(i1,i2,i3)=(sz(i1,i2,i3+1)-sz(i1,i2,i3-1))*d12(2)
szrr2(i1,i2,i3)=(-2.*sz(i1,i2,i3)+(sz(i1+1,i2,i3)+sz(i1-1,i2,i3)) )*d22(0)
szss2(i1,i2,i3)=(-2.*sz(i1,i2,i3)+(sz(i1,i2+1,i3)+sz(i1,i2-1,i3)) )*d22(1)
szrs2(i1,i2,i3)=(sz ## r2(i1,i2+1,i3)-sz ## r2(i1,i2-1,i3))*d12(1)
txr2(i1,i2,i3)=(tx(i1+1,i2,i3)-tx(i1-1,i2,i3))*d12(0)
txs2(i1,i2,i3)=(tx(i1,i2+1,i3)-tx(i1,i2-1,i3))*d12(1)
txt2(i1,i2,i3)=(tx(i1,i2,i3+1)-tx(i1,i2,i3-1))*d12(2)
txrr2(i1,i2,i3)=(-2.*tx(i1,i2,i3)+(tx(i1+1,i2,i3)+tx(i1-1,i2,i3)) )*d22(0)
txss2(i1,i2,i3)=(-2.*tx(i1,i2,i3)+(tx(i1,i2+1,i3)+tx(i1,i2-1,i3)) )*d22(1)
txrs2(i1,i2,i3)=(tx ## r2(i1,i2+1,i3)-tx ## r2(i1,i2-1,i3))*d12(1)
tyr2(i1,i2,i3)=(ty(i1+1,i2,i3)-ty(i1-1,i2,i3))*d12(0)
tys2(i1,i2,i3)=(ty(i1,i2+1,i3)-ty(i1,i2-1,i3))*d12(1)
tyt2(i1,i2,i3)=(ty(i1,i2,i3+1)-ty(i1,i2,i3-1))*d12(2)
tyrr2(i1,i2,i3)=(-2.*ty(i1,i2,i3)+(ty(i1+1,i2,i3)+ty(i1-1,i2,i3)) )*d22(0)
tyss2(i1,i2,i3)=(-2.*ty(i1,i2,i3)+(ty(i1,i2+1,i3)+ty(i1,i2-1,i3)) )*d22(1)
tyrs2(i1,i2,i3)=(ty ## r2(i1,i2+1,i3)-ty ## r2(i1,i2-1,i3))*d12(1)
tzr2(i1,i2,i3)=(tz(i1+1,i2,i3)-tz(i1-1,i2,i3))*d12(0)
tzs2(i1,i2,i3)=(tz(i1,i2+1,i3)-tz(i1,i2-1,i3))*d12(1)
tzt2(i1,i2,i3)=(tz(i1,i2,i3+1)-tz(i1,i2,i3-1))*d12(2)
tzrr2(i1,i2,i3)=(-2.*tz(i1,i2,i3)+(tz(i1+1,i2,i3)+tz(i1-1,i2,i3)) )*d22(0)
tzss2(i1,i2,i3)=(-2.*tz(i1,i2,i3)+(tz(i1,i2+1,i3)+tz(i1,i2-1,i3)) )*d22(1)
tzrs2(i1,i2,i3)=(tz ## r2(i1,i2+1,i3)-tz ## r2(i1,i2-1,i3))*d12(1)
#End

u ## x21(i1,i2,i3,kd)= rx(i1,i2,i3)*u ## r2(i1,i2,i3,kd)
u ## y21(i1,i2,i3,kd)=0
u ## z21(i1,i2,i3,kd)=0

u ## x22(i1,i2,i3,kd)= rx(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sx(i1,i2,i3)*u ## s2(i1,i2,i3,kd)
u ## y22(i1,i2,i3,kd)= ry(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sy(i1,i2,i3)*u ## s2(i1,i2,i3,kd)
u ## z22(i1,i2,i3,kd)=0
u ## x23(i1,i2,i3,kd)=rx(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sx(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+tx(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## y23(i1,i2,i3,kd)=ry(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sy(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+ty(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## z23(i1,i2,i3,kd)=rz(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sz(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+tz(i1,i2,i3)*u ## t2(i1,i2,i3,kd)

#If #OPTION == "RX"
rxx21(i1,i2,i3)= rx(i1,i2,i3)*rxr2(i1,i2,i3)
rxx22(i1,i2,i3)= rx(i1,i2,i3)*rxr2(i1,i2,i3)+sx(i1,i2,i3)*rxs2(i1,i2,i3)
rxy22(i1,i2,i3)= ry(i1,i2,i3)*rxr2(i1,i2,i3)+sy(i1,i2,i3)*rxs2(i1,i2,i3)
rxx23(i1,i2,i3)=rx(i1,i2,i3)*rxr2(i1,i2,i3)+sx(i1,i2,i3)*rxs2(i1,i2,i3)+tx(i1,i2,i3)*rxt2(i1,i2,i3)
rxy23(i1,i2,i3)=ry(i1,i2,i3)*rxr2(i1,i2,i3)+sy(i1,i2,i3)*rxs2(i1,i2,i3)+ty(i1,i2,i3)*rxt2(i1,i2,i3)
rxz23(i1,i2,i3)=rz(i1,i2,i3)*rxr2(i1,i2,i3)+sz(i1,i2,i3)*rxs2(i1,i2,i3)+tz(i1,i2,i3)*rxt2(i1,i2,i3)
ryx22(i1,i2,i3)= rx(i1,i2,i3)*ryr2(i1,i2,i3)+sx(i1,i2,i3)*rys2(i1,i2,i3)
ryy22(i1,i2,i3)= ry(i1,i2,i3)*ryr2(i1,i2,i3)+sy(i1,i2,i3)*rys2(i1,i2,i3)
ryx23(i1,i2,i3)=rx(i1,i2,i3)*ryr2(i1,i2,i3)+sx(i1,i2,i3)*rys2(i1,i2,i3)+tx(i1,i2,i3)*ryt2(i1,i2,i3)
ryy23(i1,i2,i3)=ry(i1,i2,i3)*ryr2(i1,i2,i3)+sy(i1,i2,i3)*rys2(i1,i2,i3)+ty(i1,i2,i3)*ryt2(i1,i2,i3)
ryz23(i1,i2,i3)=rz(i1,i2,i3)*ryr2(i1,i2,i3)+sz(i1,i2,i3)*rys2(i1,i2,i3)+tz(i1,i2,i3)*ryt2(i1,i2,i3)
rzx22(i1,i2,i3)= rx(i1,i2,i3)*rzr2(i1,i2,i3)+sx(i1,i2,i3)*rzs2(i1,i2,i3)
rzy22(i1,i2,i3)= ry(i1,i2,i3)*rzr2(i1,i2,i3)+sy(i1,i2,i3)*rzs2(i1,i2,i3)
rzx23(i1,i2,i3)=rx(i1,i2,i3)*rzr2(i1,i2,i3)+sx(i1,i2,i3)*rzs2(i1,i2,i3)+tx(i1,i2,i3)*rzt2(i1,i2,i3)
rzy23(i1,i2,i3)=ry(i1,i2,i3)*rzr2(i1,i2,i3)+sy(i1,i2,i3)*rzs2(i1,i2,i3)+ty(i1,i2,i3)*rzt2(i1,i2,i3)
rzz23(i1,i2,i3)=rz(i1,i2,i3)*rzr2(i1,i2,i3)+sz(i1,i2,i3)*rzs2(i1,i2,i3)+tz(i1,i2,i3)*rzt2(i1,i2,i3)
sxx22(i1,i2,i3)= rx(i1,i2,i3)*sxr2(i1,i2,i3)+sx(i1,i2,i3)*sxs2(i1,i2,i3)
sxy22(i1,i2,i3)= ry(i1,i2,i3)*sxr2(i1,i2,i3)+sy(i1,i2,i3)*sxs2(i1,i2,i3)
sxx23(i1,i2,i3)=rx(i1,i2,i3)*sxr2(i1,i2,i3)+sx(i1,i2,i3)*sxs2(i1,i2,i3)+tx(i1,i2,i3)*sxt2(i1,i2,i3)
sxy23(i1,i2,i3)=ry(i1,i2,i3)*sxr2(i1,i2,i3)+sy(i1,i2,i3)*sxs2(i1,i2,i3)+ty(i1,i2,i3)*sxt2(i1,i2,i3)
sxz23(i1,i2,i3)=rz(i1,i2,i3)*sxr2(i1,i2,i3)+sz(i1,i2,i3)*sxs2(i1,i2,i3)+tz(i1,i2,i3)*sxt2(i1,i2,i3)
syx22(i1,i2,i3)= rx(i1,i2,i3)*syr2(i1,i2,i3)+sx(i1,i2,i3)*sys2(i1,i2,i3)
syy22(i1,i2,i3)= ry(i1,i2,i3)*syr2(i1,i2,i3)+sy(i1,i2,i3)*sys2(i1,i2,i3)
syx23(i1,i2,i3)=rx(i1,i2,i3)*syr2(i1,i2,i3)+sx(i1,i2,i3)*sys2(i1,i2,i3)+tx(i1,i2,i3)*syt2(i1,i2,i3)
syy23(i1,i2,i3)=ry(i1,i2,i3)*syr2(i1,i2,i3)+sy(i1,i2,i3)*sys2(i1,i2,i3)+ty(i1,i2,i3)*syt2(i1,i2,i3)
syz23(i1,i2,i3)=rz(i1,i2,i3)*syr2(i1,i2,i3)+sz(i1,i2,i3)*sys2(i1,i2,i3)+tz(i1,i2,i3)*syt2(i1,i2,i3)
szx22(i1,i2,i3)= rx(i1,i2,i3)*szr2(i1,i2,i3)+sx(i1,i2,i3)*szs2(i1,i2,i3)
szy22(i1,i2,i3)= ry(i1,i2,i3)*szr2(i1,i2,i3)+sy(i1,i2,i3)*szs2(i1,i2,i3)
szx23(i1,i2,i3)=rx(i1,i2,i3)*szr2(i1,i2,i3)+sx(i1,i2,i3)*szs2(i1,i2,i3)+tx(i1,i2,i3)*szt2(i1,i2,i3)
szy23(i1,i2,i3)=ry(i1,i2,i3)*szr2(i1,i2,i3)+sy(i1,i2,i3)*szs2(i1,i2,i3)+ty(i1,i2,i3)*szt2(i1,i2,i3)
szz23(i1,i2,i3)=rz(i1,i2,i3)*szr2(i1,i2,i3)+sz(i1,i2,i3)*szs2(i1,i2,i3)+tz(i1,i2,i3)*szt2(i1,i2,i3)
txx22(i1,i2,i3)= rx(i1,i2,i3)*txr2(i1,i2,i3)+sx(i1,i2,i3)*txs2(i1,i2,i3)
txy22(i1,i2,i3)= ry(i1,i2,i3)*txr2(i1,i2,i3)+sy(i1,i2,i3)*txs2(i1,i2,i3)
txx23(i1,i2,i3)=rx(i1,i2,i3)*txr2(i1,i2,i3)+sx(i1,i2,i3)*txs2(i1,i2,i3)+tx(i1,i2,i3)*txt2(i1,i2,i3)
txy23(i1,i2,i3)=ry(i1,i2,i3)*txr2(i1,i2,i3)+sy(i1,i2,i3)*txs2(i1,i2,i3)+ty(i1,i2,i3)*txt2(i1,i2,i3)
txz23(i1,i2,i3)=rz(i1,i2,i3)*txr2(i1,i2,i3)+sz(i1,i2,i3)*txs2(i1,i2,i3)+tz(i1,i2,i3)*txt2(i1,i2,i3)
tyx22(i1,i2,i3)= rx(i1,i2,i3)*tyr2(i1,i2,i3)+sx(i1,i2,i3)*tys2(i1,i2,i3)
tyy22(i1,i2,i3)= ry(i1,i2,i3)*tyr2(i1,i2,i3)+sy(i1,i2,i3)*tys2(i1,i2,i3)
tyx23(i1,i2,i3)=rx(i1,i2,i3)*tyr2(i1,i2,i3)+sx(i1,i2,i3)*tys2(i1,i2,i3)+tx(i1,i2,i3)*tyt2(i1,i2,i3)
tyy23(i1,i2,i3)=ry(i1,i2,i3)*tyr2(i1,i2,i3)+sy(i1,i2,i3)*tys2(i1,i2,i3)+ty(i1,i2,i3)*tyt2(i1,i2,i3)
tyz23(i1,i2,i3)=rz(i1,i2,i3)*tyr2(i1,i2,i3)+sz(i1,i2,i3)*tys2(i1,i2,i3)+tz(i1,i2,i3)*tyt2(i1,i2,i3)
tzx22(i1,i2,i3)= rx(i1,i2,i3)*tzr2(i1,i2,i3)+sx(i1,i2,i3)*tzs2(i1,i2,i3)
tzy22(i1,i2,i3)= ry(i1,i2,i3)*tzr2(i1,i2,i3)+sy(i1,i2,i3)*tzs2(i1,i2,i3)
tzx23(i1,i2,i3)=rx(i1,i2,i3)*tzr2(i1,i2,i3)+sx(i1,i2,i3)*tzs2(i1,i2,i3)+tx(i1,i2,i3)*tzt2(i1,i2,i3)
tzy23(i1,i2,i3)=ry(i1,i2,i3)*tzr2(i1,i2,i3)+sy(i1,i2,i3)*tzs2(i1,i2,i3)+ty(i1,i2,i3)*tzt2(i1,i2,i3)
tzz23(i1,i2,i3)=rz(i1,i2,i3)*tzr2(i1,i2,i3)+sz(i1,i2,i3)*tzs2(i1,i2,i3)+tz(i1,i2,i3)*tzt2(i1,i2,i3)
#End

u ## xx21(i1,i2,i3,kd)=(SQR(rx(i1,i2,i3)))*u ## rr2(i1,i2,i3,kd)+(rxx22(i1,i2,i3))*u ## r2(i1,i2,i3,kd)
u ## yy21(i1,i2,i3,kd)=0
u ## xy21(i1,i2,i3,kd)=0
u ## xz21(i1,i2,i3,kd)=0
u ## yz21(i1,i2,i3,kd)=0
u ## zz21(i1,i2,i3,kd)=0
u ## laplacian21(i1,i2,i3,kd)=u ## xx21(i1,i2,i3,kd)
u ## xx22(i1,i2,i3,kd)=(SQR(rx(i1,i2,i3)))*u ## rr2(i1,i2,i3,kd)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(SQR(sx(i1,i2,i3)))*u ## ss2(i1,i2,i3,kd)+(rxx22(i1,i2,i3))*u ## r2(i1,i2,i3,kd)+(sxx22(i1,i2,i3))*u ## s2(i1,i2,i3,kd)
u ## yy22(i1,i2,i3,kd)=(SQR(ry(i1,i2,i3)))*u ## rr2(i1,i2,i3,kd)+2.*(ry(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(SQR(sy(i1,i2,i3)))*u ## ss2(i1,i2,i3,kd)+(ryy22(i1,i2,i3))*u ## r2(i1,i2,i3,kd)+(syy22(i1,i2,i3))*u ## s2(i1,i2,i3,kd)
u ## xy22(i1,i2,i3,kd)=rx(i1,i2,i3)*ry(i1,i2,i3)*u ## rr2(i1,i2,i3,kd)+(rx(i1,i2,i3)*sy(i1,i2,i3)+ry(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+sx(i1,i2,i3)*sy(i1,i2,i3)*u ## ss2(i1,i2,i3,kd)+rxy22(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sxy22(i1,i2,i3)*u ## s2(i1,i2,i3,kd)
u ## xz22(i1,i2,i3,kd)=0
u ## yz22(i1,i2,i3,kd)=0
u ## zz22(i1,i2,i3,kd)=0
u ## laplacian22(i1,i2,i3,kd)=(SQR(rx(i1,i2,i3))+SQR(ry(i1,i2,i3)))*u ## rr2(i1,i2,i3,kd)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3)+ ry(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(SQR(sx(i1,i2,i3))+SQR(sy(i1,i2,i3)))*u ## ss2(i1,i2,i3,kd)+(rxx22(i1,i2,i3)+ryy22(i1,i2,i3))*u ## r2(i1,i2,i3,kd)+(sxx22(i1,i2,i3)+syy22(i1,i2,i3))*u ## s2(i1,i2,i3,kd)
u ## xx23(i1,i2,i3,kd)=SQR(rx(i1,i2,i3))*u ## rr2(i1,i2,i3,kd)+SQR(sx(i1,i2,i3))*u ## ss2(i1,i2,i3,kd)+SQR(tx(i1,i2,i3))*u ## tt2(i1,i2,i3,kd)+2.*rx(i1,i2,i3)*sx(i1,i2,i3)*u ## rs2(i1,i2,i3,kd)+2.*rx(i1,i2,i3)*tx(i1,i2,i3)*u ## rt2(i1,i2,i3,kd)+2.*sx(i1,i2,i3)*tx(i1,i2,i3)*u ## st2(i1,i2,i3,kd)+rxx23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sxx23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+txx23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## yy23(i1,i2,i3,kd)=SQR(ry(i1,i2,i3))*u ## rr2(i1,i2,i3,kd)+SQR(sy(i1,i2,i3))*u ## ss2(i1,i2,i3,kd)+SQR(ty(i1,i2,i3))*u ## tt2(i1,i2,i3,kd)+2.*ry(i1,i2,i3)*sy(i1,i2,i3)*u ## rs2(i1,i2,i3,kd)+2.*ry(i1,i2,i3)*ty(i1,i2,i3)*u ## rt2(i1,i2,i3,kd)+2.*sy(i1,i2,i3)*ty(i1,i2,i3)*u ## st2(i1,i2,i3,kd)+ryy23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+syy23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+tyy23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## zz23(i1,i2,i3,kd)=SQR(rz(i1,i2,i3))*u ## rr2(i1,i2,i3,kd)+SQR(sz(i1,i2,i3))*u ## ss2(i1,i2,i3,kd)+SQR(tz(i1,i2,i3))*u ## tt2(i1,i2,i3,kd)+2.*rz(i1,i2,i3)*sz(i1,i2,i3)*u ## rs2(i1,i2,i3,kd)+2.*rz(i1,i2,i3)*tz(i1,i2,i3)*u ## rt2(i1,i2,i3,kd)+2.*sz(i1,i2,i3)*tz(i1,i2,i3)*u ## st2(i1,i2,i3,kd)+rzz23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+szz23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+tzz23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## xy23(i1,i2,i3,kd)=rx(i1,i2,i3)*ry(i1,i2,i3)*u ## rr2(i1,i2,i3,kd)+sx(i1,i2,i3)*sy(i1,i2,i3)*u ## ss2(i1,i2,i3,kd)+tx(i1,i2,i3)*ty(i1,i2,i3)*u ## tt2(i1,i2,i3,kd)+(rx(i1,i2,i3)*sy(i1,i2,i3)+ry(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(rx(i1,i2,i3)*ty(i1,i2,i3)+ry(i1,i2,i3)*tx(i1,i2,i3))*u ## rt2(i1,i2,i3,kd)+(sx(i1,i2,i3)*ty(i1,i2,i3)+sy(i1,i2,i3)*tx(i1,i2,i3))*u ## st2(i1,i2,i3,kd)+rxy23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sxy23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+txy23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## xz23(i1,i2,i3,kd)=rx(i1,i2,i3)*rz(i1,i2,i3)*u ## rr2(i1,i2,i3,kd)+sx(i1,i2,i3)*sz(i1,i2,i3)*u ## ss2(i1,i2,i3,kd)+tx(i1,i2,i3)*tz(i1,i2,i3)*u ## tt2(i1,i2,i3,kd)+(rx(i1,i2,i3)*sz(i1,i2,i3)+rz(i1,i2,i3)*sx(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(rx(i1,i2,i3)*tz(i1,i2,i3)+rz(i1,i2,i3)*tx(i1,i2,i3))*u ## rt2(i1,i2,i3,kd)+(sx(i1,i2,i3)*tz(i1,i2,i3)+sz(i1,i2,i3)*tx(i1,i2,i3))*u ## st2(i1,i2,i3,kd)+rxz23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+sxz23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+txz23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## yz23(i1,i2,i3,kd)=ry(i1,i2,i3)*rz(i1,i2,i3)*u ## rr2(i1,i2,i3,kd)+sy(i1,i2,i3)*sz(i1,i2,i3)*u ## ss2(i1,i2,i3,kd)+ty(i1,i2,i3)*tz(i1,i2,i3)*u ## tt2(i1,i2,i3,kd)+(ry(i1,i2,i3)*sz(i1,i2,i3)+rz(i1,i2,i3)*sy(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+(ry(i1,i2,i3)*tz(i1,i2,i3)+rz(i1,i2,i3)*ty(i1,i2,i3))*u ## rt2(i1,i2,i3,kd)+(sy(i1,i2,i3)*tz(i1,i2,i3)+sz(i1,i2,i3)*ty(i1,i2,i3))*u ## st2(i1,i2,i3,kd)+ryz23(i1,i2,i3)*u ## r2(i1,i2,i3,kd)+syz23(i1,i2,i3)*u ## s2(i1,i2,i3,kd)+tyz23(i1,i2,i3)*u ## t2(i1,i2,i3,kd)
u ## laplacian23(i1,i2,i3,kd)=(SQR(rx(i1,i2,i3))+SQR(ry(i1,i2,i3))+SQR(rz(i1,i2,i3)))*u ## rr2(i1,i2,i3,kd)+(SQR(sx(i1,i2,i3))+SQR(sy(i1,i2,i3))+SQR(sz(i1,i2,i3)))*u ## ss2(i1,i2,i3,kd)+(SQR(tx(i1,i2,i3))+SQR(ty(i1,i2,i3))+SQR(tz(i1,i2,i3)))*u ## tt2(i1,i2,i3,kd)+2.*(rx(i1,i2,i3)*sx(i1,i2,i3)+ ry(i1,i2,i3)*sy(i1,i2,i3)+rz(i1,i2,i3)*sz(i1,i2,i3))*u ## rs2(i1,i2,i3,kd)+2.*(rx(i1,i2,i3)*tx(i1,i2,i3)+ ry(i1,i2,i3)*ty(i1,i2,i3)+rz(i1,i2,i3)*tz(i1,i2,i3))*u ## rt2(i1,i2,i3,kd)+2.*(sx(i1,i2,i3)*tx(i1,i2,i3)+ sy(i1,i2,i3)*ty(i1,i2,i3)+sz(i1,i2,i3)*tz(i1,i2,i3))*u ## st2(i1,i2,i3,kd)+(rxx23(i1,i2,i3)+ryy23(i1,i2,i3)+rzz23(i1,i2,i3))*u ## r2(i1,i2,i3,kd)+(sxx23(i1,i2,i3)+syy23(i1,i2,i3)+szz23(i1,i2,i3))*u ## s2(i1,i2,i3,kd)+(txx23(i1,i2,i3)+tyy23(i1,i2,i3)+tzz23(i1,i2,i3))*u ## t2(i1,i2,i3,kd)
//============================================================================================
// Define derivatives for a rectangular grid
//
//============================================================================================
#If #OPTION == "RX"
h12(kd) = 1./(2.*dx(kd))
h22(kd) = 1./(SQR(dx(kd)))
#End

u ## x23r(i1,i2,i3,kd)=(u(i1+1,i2,i3,kd)-u(i1-1,i2,i3,kd))*h12(0)
u ## y23r(i1,i2,i3,kd)=(u(i1,i2+1,i3,kd)-u(i1,i2-1,i3,kd))*h12(1)
u ## z23r(i1,i2,i3,kd)=(u(i1,i2,i3+1,kd)-u(i1,i2,i3-1,kd))*h12(2)

u ## xx23r(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1+1,i2,i3,kd)+u(i1-1,i2,i3,kd)) )*h22(0)
u ## yy23r(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1,i2+1,i3,kd)+u(i1,i2-1,i3,kd)) )*h22(1)
u ## xy23r(i1,i2,i3,kd)=(u ## x23r(i1,i2+1,i3,kd)-u ## x23r(i1,i2-1,i3,kd))*h12(1)
u ## zz23r(i1,i2,i3,kd)=(-2.*u(i1,i2,i3,kd)+(u(i1,i2,i3+1,kd)+u(i1,i2,i3-1,kd)) )*h22(2)
u ## xz23r(i1,i2,i3,kd)=(u ## x23r(i1,i2,i3+1,kd)-u ## x23r(i1,i2,i3-1,kd))*h12(2)
u ## yz23r(i1,i2,i3,kd)=(u ## y23r(i1,i2,i3+1,kd)-u ## y23r(i1,i2,i3-1,kd))*h12(2)

u ## x21r(i1,i2,i3,kd)= u ## x23r(i1,i2,i3,kd)
u ## y21r(i1,i2,i3,kd)= u ## y23r(i1,i2,i3,kd)
u ## z21r(i1,i2,i3,kd)= u ## z23r(i1,i2,i3,kd)
u ## xx21r(i1,i2,i3,kd)= u ## xx23r(i1,i2,i3,kd)
u ## yy21r(i1,i2,i3,kd)= u ## yy23r(i1,i2,i3,kd)
u ## zz21r(i1,i2,i3,kd)= u ## zz23r(i1,i2,i3,kd)
u ## xy21r(i1,i2,i3,kd)= u ## xy23r(i1,i2,i3,kd)
u ## xz21r(i1,i2,i3,kd)= u ## xz23r(i1,i2,i3,kd)
u ## yz21r(i1,i2,i3,kd)= u ## yz23r(i1,i2,i3,kd)
u ## laplacian21r(i1,i2,i3,kd)=u ## xx23r(i1,i2,i3,kd)
u ## x22r(i1,i2,i3,kd)= u ## x23r(i1,i2,i3,kd)
u ## y22r(i1,i2,i3,kd)= u ## y23r(i1,i2,i3,kd)
u ## z22r(i1,i2,i3,kd)= u ## z23r(i1,i2,i3,kd)
u ## xx22r(i1,i2,i3,kd)= u ## xx23r(i1,i2,i3,kd)
u ## yy22r(i1,i2,i3,kd)= u ## yy23r(i1,i2,i3,kd)
u ## zz22r(i1,i2,i3,kd)= u ## zz23r(i1,i2,i3,kd)
u ## xy22r(i1,i2,i3,kd)= u ## xy23r(i1,i2,i3,kd)
u ## xz22r(i1,i2,i3,kd)= u ## xz23r(i1,i2,i3,kd)
u ## yz22r(i1,i2,i3,kd)= u ## yz23r(i1,i2,i3,kd)
u ## laplacian22r(i1,i2,i3,kd)=u ## xx23r(i1,i2,i3,kd)+u ## yy23r(i1,i2,i3,kd)
u ## laplacian23r(i1,i2,i3,kd)=u ## xx23r(i1,i2,i3,kd)+u ## yy23r(i1,i2,i3,kd)+u ## zz23r(i1,i2,i3,kd)
#endMacro
