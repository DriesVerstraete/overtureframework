! This file was generated by ogmg/doc/neumann.maple
! This macro defines coefficients needed for a line solve of the Neumann and Equation Boundary Condition
! The equation for the 2nd ghost line is derived from the normal derivative of the PDE
! (PDE).r = fr :
! brrr*urrr + brr*urr + br*ur = bsss*usss + ...
! DIR : R,S,T 
! OPTION : LHS or RHS if evaluating the left-hand-side or right-hand-side 
#beginMacro neumannAndEquationLineBC3dOrder4(DIR,OPTION)
 ! define these derivatives of the mapping (which are not normally computed by the standard macros):
ajrxxr=ajrx*ajrxrr + ajsx*ajrxrs + ajtx*ajrxrt + ajrxr*ajrxr +ajsxr*ajrxs + ajtxr*ajrxt
ajrxxs=ajrx*ajrxrs + ajsx*ajrxss + ajtx*ajrxst + ajrxs*ajrxr +ajsxs*ajrxs + ajtxs*ajrxt
ajrxxt=ajrx*ajrxrt + ajsx*ajrxst + ajtx*ajrxtt + ajrxt*ajrxr +ajsxt*ajrxs + ajtxt*ajrxt
ajrxyr=ajry*ajrxrr + ajsy*ajrxrs + ajty*ajrxrt + ajryr*ajrxr +ajsyr*ajrxs + ajtyr*ajrxt
ajrxys=ajry*ajrxrs + ajsy*ajrxss + ajty*ajrxst + ajrys*ajrxr +ajsys*ajrxs + ajtys*ajrxt
ajrxyt=ajry*ajrxrt + ajsy*ajrxst + ajty*ajrxtt + ajryt*ajrxr +ajsyt*ajrxs + ajtyt*ajrxt
ajrxzr=ajrz*ajrxrr + ajsz*ajrxrs + ajtz*ajrxrt + ajrzr*ajrxr +ajszr*ajrxs + ajtzr*ajrxt
ajrxzs=ajrz*ajrxrs + ajsz*ajrxss + ajtz*ajrxst + ajrzs*ajrxr +ajszs*ajrxs + ajtzs*ajrxt
ajrxzt=ajrz*ajrxrt + ajsz*ajrxst + ajtz*ajrxtt + ajrzt*ajrxr +ajszt*ajrxs + ajtzt*ajrxt
ajryxr=ajrx*ajryrr + ajsx*ajryrs + ajtx*ajryrt + ajrxr*ajryr +ajsxr*ajrys + ajtxr*ajryt
ajryxs=ajrx*ajryrs + ajsx*ajryss + ajtx*ajryst + ajrxs*ajryr +ajsxs*ajrys + ajtxs*ajryt
ajryxt=ajrx*ajryrt + ajsx*ajryst + ajtx*ajrytt + ajrxt*ajryr +ajsxt*ajrys + ajtxt*ajryt
ajryyr=ajry*ajryrr + ajsy*ajryrs + ajty*ajryrt + ajryr*ajryr +ajsyr*ajrys + ajtyr*ajryt
ajryys=ajry*ajryrs + ajsy*ajryss + ajty*ajryst + ajrys*ajryr +ajsys*ajrys + ajtys*ajryt
ajryyt=ajry*ajryrt + ajsy*ajryst + ajty*ajrytt + ajryt*ajryr +ajsyt*ajrys + ajtyt*ajryt
ajryzr=ajrz*ajryrr + ajsz*ajryrs + ajtz*ajryrt + ajrzr*ajryr +ajszr*ajrys + ajtzr*ajryt
ajryzs=ajrz*ajryrs + ajsz*ajryss + ajtz*ajryst + ajrzs*ajryr +ajszs*ajrys + ajtzs*ajryt
ajryzt=ajrz*ajryrt + ajsz*ajryst + ajtz*ajrytt + ajrzt*ajryr +ajszt*ajrys + ajtzt*ajryt
ajrzxr=ajrx*ajrzrr + ajsx*ajrzrs + ajtx*ajrzrt + ajrxr*ajrzr +ajsxr*ajrzs + ajtxr*ajrzt
ajrzxs=ajrx*ajrzrs + ajsx*ajrzss + ajtx*ajrzst + ajrxs*ajrzr +ajsxs*ajrzs + ajtxs*ajrzt
ajrzxt=ajrx*ajrzrt + ajsx*ajrzst + ajtx*ajrztt + ajrxt*ajrzr +ajsxt*ajrzs + ajtxt*ajrzt
ajrzyr=ajry*ajrzrr + ajsy*ajrzrs + ajty*ajrzrt + ajryr*ajrzr +ajsyr*ajrzs + ajtyr*ajrzt
ajrzys=ajry*ajrzrs + ajsy*ajrzss + ajty*ajrzst + ajrys*ajrzr +ajsys*ajrzs + ajtys*ajrzt
ajrzyt=ajry*ajrzrt + ajsy*ajrzst + ajty*ajrztt + ajryt*ajrzr +ajsyt*ajrzs + ajtyt*ajrzt
ajrzzr=ajrz*ajrzrr + ajsz*ajrzrs + ajtz*ajrzrt + ajrzr*ajrzr +ajszr*ajrzs + ajtzr*ajrzt
ajrzzs=ajrz*ajrzrs + ajsz*ajrzss + ajtz*ajrzst + ajrzs*ajrzr +ajszs*ajrzs + ajtzs*ajrzt
ajrzzt=ajrz*ajrzrt + ajsz*ajrzst + ajtz*ajrztt + ajrzt*ajrzr +ajszt*ajrzs + ajtzt*ajrzt
ajsxxr=ajrx*ajsxrr + ajsx*ajsxrs + ajtx*ajsxrt + ajrxr*ajsxr +ajsxr*ajsxs + ajtxr*ajsxt
ajsxxs=ajrx*ajsxrs + ajsx*ajsxss + ajtx*ajsxst + ajrxs*ajsxr +ajsxs*ajsxs + ajtxs*ajsxt
ajsxxt=ajrx*ajsxrt + ajsx*ajsxst + ajtx*ajsxtt + ajrxt*ajsxr +ajsxt*ajsxs + ajtxt*ajsxt
ajsxyr=ajry*ajsxrr + ajsy*ajsxrs + ajty*ajsxrt + ajryr*ajsxr +ajsyr*ajsxs + ajtyr*ajsxt
ajsxys=ajry*ajsxrs + ajsy*ajsxss + ajty*ajsxst + ajrys*ajsxr +ajsys*ajsxs + ajtys*ajsxt
ajsxyt=ajry*ajsxrt + ajsy*ajsxst + ajty*ajsxtt + ajryt*ajsxr +ajsyt*ajsxs + ajtyt*ajsxt
ajsxzr=ajrz*ajsxrr + ajsz*ajsxrs + ajtz*ajsxrt + ajrzr*ajsxr +ajszr*ajsxs + ajtzr*ajsxt
ajsxzs=ajrz*ajsxrs + ajsz*ajsxss + ajtz*ajsxst + ajrzs*ajsxr +ajszs*ajsxs + ajtzs*ajsxt
ajsxzt=ajrz*ajsxrt + ajsz*ajsxst + ajtz*ajsxtt + ajrzt*ajsxr +ajszt*ajsxs + ajtzt*ajsxt
ajsyxr=ajrx*ajsyrr + ajsx*ajsyrs + ajtx*ajsyrt + ajrxr*ajsyr +ajsxr*ajsys + ajtxr*ajsyt
ajsyxs=ajrx*ajsyrs + ajsx*ajsyss + ajtx*ajsyst + ajrxs*ajsyr +ajsxs*ajsys + ajtxs*ajsyt
ajsyxt=ajrx*ajsyrt + ajsx*ajsyst + ajtx*ajsytt + ajrxt*ajsyr +ajsxt*ajsys + ajtxt*ajsyt
ajsyyr=ajry*ajsyrr + ajsy*ajsyrs + ajty*ajsyrt + ajryr*ajsyr +ajsyr*ajsys + ajtyr*ajsyt
ajsyys=ajry*ajsyrs + ajsy*ajsyss + ajty*ajsyst + ajrys*ajsyr +ajsys*ajsys + ajtys*ajsyt
ajsyyt=ajry*ajsyrt + ajsy*ajsyst + ajty*ajsytt + ajryt*ajsyr +ajsyt*ajsys + ajtyt*ajsyt
ajsyzr=ajrz*ajsyrr + ajsz*ajsyrs + ajtz*ajsyrt + ajrzr*ajsyr +ajszr*ajsys + ajtzr*ajsyt
ajsyzs=ajrz*ajsyrs + ajsz*ajsyss + ajtz*ajsyst + ajrzs*ajsyr +ajszs*ajsys + ajtzs*ajsyt
ajsyzt=ajrz*ajsyrt + ajsz*ajsyst + ajtz*ajsytt + ajrzt*ajsyr +ajszt*ajsys + ajtzt*ajsyt
ajszxr=ajrx*ajszrr + ajsx*ajszrs + ajtx*ajszrt + ajrxr*ajszr +ajsxr*ajszs + ajtxr*ajszt
ajszxs=ajrx*ajszrs + ajsx*ajszss + ajtx*ajszst + ajrxs*ajszr +ajsxs*ajszs + ajtxs*ajszt
ajszxt=ajrx*ajszrt + ajsx*ajszst + ajtx*ajsztt + ajrxt*ajszr +ajsxt*ajszs + ajtxt*ajszt
ajszyr=ajry*ajszrr + ajsy*ajszrs + ajty*ajszrt + ajryr*ajszr +ajsyr*ajszs + ajtyr*ajszt
ajszys=ajry*ajszrs + ajsy*ajszss + ajty*ajszst + ajrys*ajszr +ajsys*ajszs + ajtys*ajszt
ajszyt=ajry*ajszrt + ajsy*ajszst + ajty*ajsztt + ajryt*ajszr +ajsyt*ajszs + ajtyt*ajszt
ajszzr=ajrz*ajszrr + ajsz*ajszrs + ajtz*ajszrt + ajrzr*ajszr +ajszr*ajszs + ajtzr*ajszt
ajszzs=ajrz*ajszrs + ajsz*ajszss + ajtz*ajszst + ajrzs*ajszr +ajszs*ajszs + ajtzs*ajszt
ajszzt=ajrz*ajszrt + ajsz*ajszst + ajtz*ajsztt + ajrzt*ajszr +ajszt*ajszs + ajtzt*ajszt
ajtxxr=ajrx*ajtxrr + ajsx*ajtxrs + ajtx*ajtxrt + ajrxr*ajtxr +ajsxr*ajtxs + ajtxr*ajtxt
ajtxxs=ajrx*ajtxrs + ajsx*ajtxss + ajtx*ajtxst + ajrxs*ajtxr +ajsxs*ajtxs + ajtxs*ajtxt
ajtxxt=ajrx*ajtxrt + ajsx*ajtxst + ajtx*ajtxtt + ajrxt*ajtxr +ajsxt*ajtxs + ajtxt*ajtxt
ajtxyr=ajry*ajtxrr + ajsy*ajtxrs + ajty*ajtxrt + ajryr*ajtxr +ajsyr*ajtxs + ajtyr*ajtxt
ajtxys=ajry*ajtxrs + ajsy*ajtxss + ajty*ajtxst + ajrys*ajtxr +ajsys*ajtxs + ajtys*ajtxt
ajtxyt=ajry*ajtxrt + ajsy*ajtxst + ajty*ajtxtt + ajryt*ajtxr +ajsyt*ajtxs + ajtyt*ajtxt
ajtxzr=ajrz*ajtxrr + ajsz*ajtxrs + ajtz*ajtxrt + ajrzr*ajtxr +ajszr*ajtxs + ajtzr*ajtxt
ajtxzs=ajrz*ajtxrs + ajsz*ajtxss + ajtz*ajtxst + ajrzs*ajtxr +ajszs*ajtxs + ajtzs*ajtxt
ajtxzt=ajrz*ajtxrt + ajsz*ajtxst + ajtz*ajtxtt + ajrzt*ajtxr +ajszt*ajtxs + ajtzt*ajtxt
ajtyxr=ajrx*ajtyrr + ajsx*ajtyrs + ajtx*ajtyrt + ajrxr*ajtyr +ajsxr*ajtys + ajtxr*ajtyt
ajtyxs=ajrx*ajtyrs + ajsx*ajtyss + ajtx*ajtyst + ajrxs*ajtyr +ajsxs*ajtys + ajtxs*ajtyt
ajtyxt=ajrx*ajtyrt + ajsx*ajtyst + ajtx*ajtytt + ajrxt*ajtyr +ajsxt*ajtys + ajtxt*ajtyt
ajtyyr=ajry*ajtyrr + ajsy*ajtyrs + ajty*ajtyrt + ajryr*ajtyr +ajsyr*ajtys + ajtyr*ajtyt
ajtyys=ajry*ajtyrs + ajsy*ajtyss + ajty*ajtyst + ajrys*ajtyr +ajsys*ajtys + ajtys*ajtyt
ajtyyt=ajry*ajtyrt + ajsy*ajtyst + ajty*ajtytt + ajryt*ajtyr +ajsyt*ajtys + ajtyt*ajtyt
ajtyzr=ajrz*ajtyrr + ajsz*ajtyrs + ajtz*ajtyrt + ajrzr*ajtyr +ajszr*ajtys + ajtzr*ajtyt
ajtyzs=ajrz*ajtyrs + ajsz*ajtyss + ajtz*ajtyst + ajrzs*ajtyr +ajszs*ajtys + ajtzs*ajtyt
ajtyzt=ajrz*ajtyrt + ajsz*ajtyst + ajtz*ajtytt + ajrzt*ajtyr +ajszt*ajtys + ajtzt*ajtyt
ajtzxr=ajrx*ajtzrr + ajsx*ajtzrs + ajtx*ajtzrt + ajrxr*ajtzr +ajsxr*ajtzs + ajtxr*ajtzt
ajtzxs=ajrx*ajtzrs + ajsx*ajtzss + ajtx*ajtzst + ajrxs*ajtzr +ajsxs*ajtzs + ajtxs*ajtzt
ajtzxt=ajrx*ajtzrt + ajsx*ajtzst + ajtx*ajtztt + ajrxt*ajtzr +ajsxt*ajtzs + ajtxt*ajtzt
ajtzyr=ajry*ajtzrr + ajsy*ajtzrs + ajty*ajtzrt + ajryr*ajtzr +ajsyr*ajtzs + ajtyr*ajtzt
ajtzys=ajry*ajtzrs + ajsy*ajtzss + ajty*ajtzst + ajrys*ajtzr +ajsys*ajtzs + ajtys*ajtzt
ajtzyt=ajry*ajtzrt + ajsy*ajtzst + ajty*ajtztt + ajryt*ajtzr +ajsyt*ajtzs + ajtyt*ajtzt
ajtzzr=ajrz*ajtzrr + ajsz*ajtzrs + ajtz*ajtzrt + ajrzr*ajtzr +ajszr*ajtzs + ajtzr*ajtzt
ajtzzs=ajrz*ajtzrs + ajsz*ajtzss + ajtz*ajtzst + ajrzs*ajtzr +ajszs*ajtzs + ajtzs*ajtzt
ajtzzt=ajrz*ajtzrt + ajsz*ajtzst + ajtz*ajtztt + ajrzt*ajtzr +ajszt*ajtzs + ajtzt*ajtzt
! ***************************************************************
! PDE: cxx*uxx + cyy*uyy + czz*uzz + cxy*uxy + cxz*uxz + cyz*uyz + cx*ux + cy*uy + cz*uz + c0 *u = f 
! PDE: cRR*urr + cSS*uss + cTT*utt + cRS*urs + cRT*urt + cST*ust  + ccR*ur + ccS*us + ccT*ut + c0 *u = f 
! =============== Start: Laplace operator: ==================== 
 cxx=1.
 cyy=1.
 czz=1.
 cxy=0.
 cxz=0.
 cyz=0.
 cx=0. 
 cy=0. 
 cz=0.
 c0=0.
 cRR=cxx*ajrx**2+cyy*ajry**2+czz*ajrz**2 +cxy*ajrx*ajry+cxz*ajrx*ajrz+cyz*ajry*ajrz
 cSS=cxx*ajsx**2+cyy*ajsy**2+czz*ajsz**2 +cxy*ajsx*ajsy+cxz*ajsx*ajsz+cyz*ajsy*ajsz
 cTT=cxx*ajtx**2+cyy*ajty**2+czz*ajtz**2 +cxy*ajtx*ajty+cxz*ajtx*ajtz+cyz*ajty*ajtz
 cRS=2.*(cxx*ajrx*ajsx+cyy*ajry*ajsy+czz*ajrz*ajsz) +cxy*(ajrx*ajsy+ajry*ajsx)+cxz*(ajrx*ajsz+ajrz*ajsx)+cyz*(ajry*ajsz+ajrz*ajsy)
 cRT=2.*(cxx*ajrx*ajtx+cyy*ajry*ajty+czz*ajrz*ajtz) +cxy*(ajrx*ajty+ajry*ajtx)+cxz*(ajrx*ajtz+ajrz*ajtx)+cyz*(ajry*ajtz+ajrz*ajty)
 cST=2.*(cxx*ajsx*ajtx+cyy*ajsy*ajty+czz*ajsz*ajtz) +cxy*(ajsx*ajty+ajsy*ajtx)+cxz*(ajsx*ajtz+ajsz*ajtx)+cyz*(ajsy*ajtz+ajsz*ajty)
 ccR=cxx*ajrxx+cyy*ajryy+czz*ajrzz +cxy*ajrxy+cxz*ajrxz+cyz*ajryz + cx*ajrx+cy*ajry+cz*ajrz
 ccS=cxx*ajsxx+cyy*ajsyy+czz*ajszz +cxy*ajsxy+cxz*ajsxz+cyz*ajsyz + cx*ajsx+cy*ajsy+cz*ajsz
 ccT=cxx*ajtxx+cyy*ajtyy+czz*ajtzz +cxy*ajtxy+cxz*ajtxz+cyz*ajtyz + cx*ajtx+cy*ajty+cz*ajtz
! m=1...
 cRRr=2.*(ajrx*ajrxr+ajry*ajryr+ajrz*ajrzr)
 cRSr=2.*(ajrxr*ajsx+ajrx*ajsxr + ajryr*ajsy+ ajry*ajsyr + ajrzr*ajsz+ ajrz*ajszr)
 cRTr=2.*(ajrxr*ajtx+ajrx*ajtxr + ajryr*ajty+ ajry*ajtyr + ajrzr*ajtz+ ajrz*ajtzr)
 ccRr=ajrxxr+ajryyr+ajrzzr
 cRRs=2.*(ajrx*ajrxs+ajry*ajrys+ajrz*ajrzs)
 cRSs=2.*(ajrxs*ajsx+ajrx*ajsxs + ajrys*ajsy+ ajry*ajsys + ajrzs*ajsz+ ajrz*ajszs)
 cRTs=2.*(ajrxs*ajtx+ajrx*ajtxs + ajrys*ajty+ ajry*ajtys + ajrzs*ajtz+ ajrz*ajtzs)
 ccRs=ajrxxs+ajryys+ajrzzs
 cRRt=2.*(ajrx*ajrxt+ajry*ajryt+ajrz*ajrzt)
 cRSt=2.*(ajrxt*ajsx+ajrx*ajsxt + ajryt*ajsy+ ajry*ajsyt + ajrzt*ajsz+ ajrz*ajszt)
 cRTt=2.*(ajrxt*ajtx+ajrx*ajtxt + ajryt*ajty+ ajry*ajtyt + ajrzt*ajtz+ ajrz*ajtzt)
 ccRt=ajrxxt+ajryyt+ajrzzt
! m=2...
 cSSr=2.*(ajsx*ajsxr+ajsy*ajsyr+ajsz*ajszr)
 cSTr=2.*(ajsxr*ajtx+ajsx*ajtxr + ajsyr*ajty+ ajsy*ajtyr + ajszr*ajtz+ ajsz*ajtzr)
 ccSr=ajsxxr+ajsyyr+ajszzr
 cSSs=2.*(ajsx*ajsxs+ajsy*ajsys+ajsz*ajszs)
 cSTs=2.*(ajsxs*ajtx+ajsx*ajtxs + ajsys*ajty+ ajsy*ajtys + ajszs*ajtz+ ajsz*ajtzs)
 ccSs=ajsxxs+ajsyys+ajszzs
 cSSt=2.*(ajsx*ajsxt+ajsy*ajsyt+ajsz*ajszt)
 cSTt=2.*(ajsxt*ajtx+ajsx*ajtxt + ajsyt*ajty+ ajsy*ajtyt + ajszt*ajtz+ ajsz*ajtzt)
 ccSt=ajsxxt+ajsyyt+ajszzt
! m=3...
 cTTr=2.*(ajtx*ajtxr+ajty*ajtyr+ajtz*ajtzr)
 ccTr=ajtxxr+ajtyyr+ajtzzr
 cTTs=2.*(ajtx*ajtxs+ajty*ajtys+ajtz*ajtzs)
 ccTs=ajtxxs+ajtyys+ajtzzs
 cTTt=2.*(ajtx*ajtxt+ajty*ajtyt+ajtz*ajtzt)
 ccTt=ajtxxt+ajtyyt+ajtzzt
 c0r=0.
 c0s=0.
 c0t=0.
! =============== End: Laplace operator: ==================== 
! ---------------- Start: Boundary condition: --------------- 
! BC: a1*u.n + a0*u = g 
! nsign=2*side-1
! a1=1.
! a0=0.


 ! ---------------- Start r direction ---------------
#If #DIR eq "R"
 ! Outward normal : (n1,n2,n3) 
 ani=nsign/sqrt(ajrx**2+ajry**2+ajrz**2)
 n1=ajrx*ani
 n2=ajry*ani
 n3=ajrz*ani
 ! BC : anR*ur + anS*us + anT*ut + a0*u 
 anR=a1*(n1*ajrx+n2*ajry+n3*ajrz)
 anS=a1*(n1*ajsx+n2*ajsy+n3*ajsz)
 anT=a1*(n1*ajtx+n2*ajty+n3*ajtz)
! >>>>>>>
 anis=-(ajrx*ajrxs+ajry*ajrys+ajrz*ajrzs)*ani**3
 aniss=-(ajrx*ajrxss+ajry*ajryss+ajrz*ajrzss+ajrxs*ajrxs+ajrys*ajrys+ajrzs*ajrzs)*ani**3 -3.*(ajrx*ajrxs+ajry*ajrys+ajrz*ajrzs)*ani**2*anis
 n1s=ajrxs*ani + ajrx*anis
 n1ss=ajrxss*ani + 2.*ajrxs*anis + ajrx*aniss
 n2s=ajrys*ani + ajry*anis
 n2ss=ajryss*ani + 2.*ajrys*anis + ajry*aniss
 n3s=ajrzs*ani + ajrz*anis
 n3ss=ajrzss*ani + 2.*ajrzs*anis + ajrz*aniss

 anRs =a1*(n1*ajrxs+n2*ajrys+n3*ajrzs+n1s*ajrx+n2s*ajry+n3s*ajrz)
 anRss=a1*(n1*ajrxss+n2*ajryss+n3*ajrzss+2.*(n1s*ajrxs+n2s*ajrys+n3s*ajrzs)+n1ss*ajrx+n2ss*ajry+n3ss*ajrz)
 anSs =a1*(n1*ajsxs+n2*ajsys+n3*ajszs+n1s*ajsx+n2s*ajsy+n3s*ajsz)
 anSss=a1*(n1*ajsxss+n2*ajsyss+n3*ajszss+2.*(n1s*ajsxs+n2s*ajsys+n3s*ajszs)+n1ss*ajsx+n2ss*ajsy+n3ss*ajsz)
 anTs =a1*(n1*ajtxs+n2*ajtys+n3*ajtzs+n1s*ajtx+n2s*ajty+n3s*ajtz)
 anTss=a1*(n1*ajtxss+n2*ajtyss+n3*ajtzss+2.*(n1s*ajtxs+n2s*ajtys+n3s*ajtzs)+n1ss*ajtx+n2ss*ajty+n3ss*ajtz)
! <<<<<<<
! >>>>>>>
 anit=-(ajrx*ajrxt+ajry*ajryt+ajrz*ajrzt)*ani**3
 anitt=-(ajrx*ajrxtt+ajry*ajrytt+ajrz*ajrztt+ajrxt*ajrxt+ajryt*ajryt+ajrzt*ajrzt)*ani**3 -3.*(ajrx*ajrxt+ajry*ajryt+ajrz*ajrzt)*ani**2*anit
 anist=-(ajrx*ajrxst+ajry*ajryst+ajrz*ajrzst+ajrxs*ajrxt+ajrys*ajryt+ajrzs*ajrzt)*ani**3 -3.*(ajrx*ajrxs+ajry*ajrys+ajrz*ajrzs)*ani**2*anit
 n1t=ajrxt*ani + ajrx*anit
 n1tt=ajrxtt*ani + 2.*ajrxt*anit + ajrx*anitt
 n1st=ajrxst*ani + ajrxt*anis + ajrxs*anit + ajrx*anist
 n2t=ajryt*ani + ajry*anit
 n2tt=ajrytt*ani + 2.*ajryt*anit + ajry*anitt
 n2st=ajryst*ani + ajryt*anis + ajrys*anit + ajry*anist
 n3t=ajrzt*ani + ajrz*anit
 n3tt=ajrztt*ani + 2.*ajrzt*anit + ajrz*anitt
 n3st=ajrzst*ani + ajrzt*anis + ajrzs*anit + ajrz*anist

 anRt =a1*(n1*ajrxt+n2*ajryt+n3*ajrzt+n1t*ajrx+n2t*ajry+n3t*ajrz)
 anRtt=a1*(n1*ajrxtt+n2*ajrytt+n3*ajrztt+2.*(n1t*ajrxt+n2t*ajryt+n3t*ajrzt)+n1tt*ajrx+n2tt*ajry+n3tt*ajrz)
 anRst=a1*(n1*ajrxst+n2*ajryst+n3*ajrzst +n1s*ajrxt+n2s*ajryt+n3s*ajrzt +n1t*ajrxs+n2t*ajrys+n3t*ajrzs +n1st*ajrx+n2st*ajry+n3st*ajrz)
 anSt =a1*(n1*ajsxt+n2*ajsyt+n3*ajszt+n1t*ajsx+n2t*ajsy+n3t*ajsz)
 anStt=a1*(n1*ajsxtt+n2*ajsytt+n3*ajsztt+2.*(n1t*ajsxt+n2t*ajsyt+n3t*ajszt)+n1tt*ajsx+n2tt*ajsy+n3tt*ajsz)
 anSst=a1*(n1*ajsxst+n2*ajsyst+n3*ajszst +n1s*ajsxt+n2s*ajsyt+n3s*ajszt +n1t*ajsxs+n2t*ajsys+n3t*ajszs +n1st*ajsx+n2st*ajsy+n3st*ajsz)
 anTt =a1*(n1*ajtxt+n2*ajtyt+n3*ajtzt+n1t*ajtx+n2t*ajty+n3t*ajtz)
 anTtt=a1*(n1*ajtxtt+n2*ajtytt+n3*ajtztt+2.*(n1t*ajtxt+n2t*ajtyt+n3t*ajtzt)+n1tt*ajtx+n2tt*ajty+n3tt*ajtz)
 anTst=a1*(n1*ajtxst+n2*ajtyst+n3*ajtzst +n1s*ajtxt+n2s*ajtyt+n3s*ajtzt +n1t*ajtxs+n2t*ajtys+n3t*ajtzs +n1st*ajtx+n2st*ajty+n3st*ajtz)
! <<<<<<<
 ! Here are the expressions for the normal derivatives
#If #OPTION eq "LHS"
bn3 = 1
bn2 = 0
bn2 = 0
bn1 = 0
b0  = -(-c0r*anR**3*cRR**2+cRRr*anR**3*cRR*c0-cRS*cRRs*anR**3*c0+cRS*c0s*anR**3*cRR-cRS**2*cRR*a0ss*anR**2-2*cRS**2*cRR*anRs**2*a0+cRRs*anR**2*cRS**2*a0s+cSS*cRR**2*a0ss*anR**2+2*cSS*cRR**2*anRs**2*a0+cRT*c0t*anR**3*cRR-cRT*cRRt*anR**3*c0-cRT**2*cRR*a0tt*anR**2-2*cRT**2*cRR*anRt**2*a0+cRRt*anR**2*cRT**2*a0t+cST*cRR**2*a0st*anR**2+cTT*cRR**2*a0tt*anR**2+2*cTT*cRR**2*anRt**2*a0-ccR**2*anR**2*cRR*a0+ccR*anR**3*cRR*c0+ccS*anR**2*cRR**2*a0s+ccT*anR**2*cRR**2*a0t+c0*anR**2*cRR**2*a0+cRSr*anR**2*cRR**2*a0s+cRTr*anR**2*cRR**2*a0t+ccRr*anR**2*cRR**2*a0-cRRr*anR**2*cRR*cRS*a0s+cRRr*anR*cRR*cRS*anRs*a0-cRRr*anR**2*cRR*cRT*a0t+cRRr*anR*cRR*cRT*anRt*a0-cRRr*anR**2*cRR*ccR*a0+2*cRS**2*cRR*anRs*a0s*anR+cRS**2*cRR*anRss*anR*a0-2*cRS*cRT*cRR*a0st*anR**2+2*cRS*cRT*cRR*anRs*a0t*anR-4*cRS*cRT*cRR*anRs*anRt*a0+2*cRS*cRT*cRR*anRt*a0s*anR+2*cRS*cRT*cRR*anRst*anR*a0-2*cRS*ccR*anR**2*cRR*a0s+2*cRS*ccR*anR*cRR*anRs*a0-cRS*cRSs*anR**2*cRR*a0s+cRS*cRSs*anR*cRR*anRs*a0-cRS*cRTs*anR**2*cRR*a0t+cRS*cRTs*anR*cRR*anRt*a0-cRS*ccRs*anR**2*cRR*a0-cRRs*anR*cRS**2*anRs*a0+cRS*cRRs*anR**2*cRT*a0t-cRS*cRRs*anR*cRT*anRt*a0+cRS*cRRs*anR**2*ccR*a0-2*cSS*cRR**2*anRs*a0s*anR-cSS*cRR**2*anRss*anR*a0+2*cRT**2*cRR*anRt*a0t*anR+cRT**2*cRR*anRtt*anR*a0-2*cRT*ccR*anR**2*cRR*a0t+2*cRT*ccR*anR*cRR*anRt*a0-cRT*cRSt*anR**2*cRR*a0s+cRT*cRSt*anR*cRR*anRs*a0-cRT*cRTt*anR**2*cRR*a0t+cRT*cRTt*anR*cRR*anRt*a0-cRT*ccRt*anR**2*cRR*a0+cRT*cRRt*anR**2*cRS*a0s-cRT*cRRt*anR*cRS*anRs*a0-cRRt*anR*cRT**2*anRt*a0+cRT*cRRt*anR**2*ccR*a0-cST*cRR**2*anRs*a0t*anR+2*cST*cRR**2*anRs*anRt*a0-cST*cRR**2*anRt*a0s*anR-cST*cRR**2*anRst*anR*a0-2*cTT*cRR**2*anRt*a0t*anR-cTT*cRR**2*anRtt*anR*a0-ccS*anR*cRR**2*anRs*a0-ccT*anR*cRR**2*anRt*a0-cRSr*anR*cRR**2*anRs*a0-cRTr*anR*cRR**2*anRt*a0)/anR**3/cRR**3
#End
#If #OPTION eq "RHS"
bsss= -(cSS*cRR**2*anS*anR**2-cRS**2*cRR*anS*anR**2+cRS*cSS*anR**3*cRR)/anR**3/cRR**3
bss = -(cRRr*anR**3*cRR*cSS+cRS*ccS*anR**3*cRR+cRS*cSSs*anR**3*cRR-cRS*cRRs*anR**3*cSS-2*cRS**2*cRR*anSs*anR**2-cRS**2*cRR*a0*anR**2+cRRs*anR**2*cRS**2*anS+2*cSS*cRR**2*anSs*anR**2+cSS*cRR**2*a0*anR**2+cRT*cSSt*anR**3*cRR-cRT*cRRt*anR**3*cSS+cST*cRR**2*anSt*anR**2+ccR*anR**3*cRR*cSS+ccS*anR**2*cRR**2*anS+cRSr*anR**2*cRR**2*anS-cSSr*anR**3*cRR**2-cRRr*anR**2*cRR*cRS*anS+2*cRS**2*cRR*anRs*anS*anR-2*cRS*cRT*cRR*anSt*anR**2+2*cRS*cRT*cRR*anRt*anS*anR-2*cRS*ccR*anR**2*cRR*anS-cRS*cRSs*anR**2*cRR*anS-2*cSS*cRR**2*anRs*anS*anR-cRT*cRSt*anR**2*cRR*anS+cRT*cRRt*anR**2*cRS*anS-cST*cRR**2*anRt*anS*anR)/anR**3/cRR**3
bs  = -(-2*cRT**2*cRR*anRt**2*anS+cRRt*anR**2*cRT**2*anSt+cST*cRR**2*anSst*anR**2+cST*cRR**2*a0t*anR**2+cTT*cRR**2*anStt*anR**2+2*cTT*cRR**2*anRt**2*anS-ccR**2*anR**2*cRR*anS+ccR*anR**3*cRR*ccS-ccSr*anR**3*cRR**2-cRT*cRRt*anR**3*ccS+cRRr*anR**3*cRR*ccS-cRS*cRRs*anR**3*ccS+cRS*c0*anR**3*cRR+cRS*ccSs*anR**3*cRR-cRS**2*cRR*anSss*anR**2-2*cRS**2*cRR*a0s*anR**2-2*cRS**2*cRR*anRs**2*anS+cRRs*anR**2*cRS**2*anSs+cRRs*anR**2*cRS**2*a0+cSS*cRR**2*anSss*anR**2+2*cSS*cRR**2*a0s*anR**2+2*cSS*cRR**2*anRs**2*anS+cRT*ccSt*anR**3*cRR-cRT**2*cRR*anStt*anR**2-cRRr*anR**2*cRR*cRS*a0-cRRr*anR**2*cRR*cRS*anSs-cRRr*anR**2*cRR*cRT*anSt+cRRr*anR*cRR*cRT*anRt*anS+cRRr*anR*cRR*cRS*anRs*anS-cRRr*anR**2*cRR*ccR*anS+2*cRS**2*cRR*anRs*anSs*anR+2*cRS**2*cRR*anRs*a0*anR+cRS**2*cRR*anRss*anR*anS+2*cRS*cRT*cRR*anRs*anSt*anR-2*cRS*cRT*cRR*anSst*anR**2-2*cRS*cRT*cRR*a0t*anR**2-4*cRS*cRT*cRR*anRs*anRt*anS+2*cRS*cRT*cRR*anRt*anSs*anR+2*cRS*cRT*cRR*anRt*a0*anR+2*cRS*cRT*cRR*anRst*anR*anS-2*cRS*ccR*anR**2*cRR*anSs-2*cRS*ccR*anR**2*cRR*a0+2*cRS*ccR*anR*cRR*anRs*anS-cRS*cRSs*anR**2*cRR*anSs-cRS*cRSs*anR**2*cRR*a0+cRS*cRSs*anR*cRR*anRs*anS-cRS*cRTs*anR**2*cRR*anSt+cRS*cRTs*anR*cRR*anRt*anS-cRS*ccRs*anR**2*cRR*anS-cRRs*anR*cRS**2*anRs*anS+cRS*cRRs*anR**2*cRT*anSt+2*cRT**2*cRR*anRt*anSt*anR+cRT**2*cRR*anRtt*anR*anS-2*cRT*ccR*anR**2*cRR*anSt+2*cRT*ccR*anR*cRR*anRt*anS-cRT*cRSt*anR**2*cRR*anSs-cRT*cRSt*anR**2*cRR*a0+cRT*cRSt*anR*cRR*anRs*anS-cRT*cRTt*anR**2*cRR*anSt+cRT*cRTt*anR*cRR*anRt*anS-cRT*ccRt*anR**2*cRR*anS+cRT*cRRt*anR**2*cRS*anSs-cRS*cRRs*anR*cRT*anRt*anS+cRS*cRRs*anR**2*ccR*anS-2*cSS*cRR**2*anRs*anSs*anR-2*cSS*cRR**2*anRs*a0*anR-cSS*cRR**2*anRss*anR*anS-cRRt*anR*cRT**2*anRt*anS+cRT*cRRt*anR**2*ccR*anS-cST*cRR**2*anRs*anSt*anR+2*cST*cRR**2*anRs*anRt*anS-cST*cRR**2*anRt*anSs*anR-cST*cRR**2*anRt*a0*anR-cST*cRR**2*anRst*anR*anS-2*cTT*cRR**2*anRt*anSt*anR-cTT*cRR**2*anRtt*anR*anS+ccS*anR**2*cRR**2*anSs+ccS*anR**2*cRR**2*a0+ccT*anR**2*cRR**2*anSt+c0*anR**2*cRR**2*anS+cRSr*anR**2*cRR**2*anSs+cRSr*anR**2*cRR**2*a0+cRTr*anR**2*cRR**2*anSt+ccRr*anR**2*cRR**2*anS+cRT*cRRt*anR**2*cRS*a0-cRT*cRRt*anR*cRS*anRs*anS-ccS*anR*cRR**2*anRs*anS-ccT*anR*cRR**2*anRt*anS-cRSr*anR*cRR**2*anRs*anS-cRTr*anR*cRR**2*anRt*anS)/anR**3/cRR**3
bttt= -(cRT*cTT*anR**3*cRR+cTT*cRR**2*anT*anR**2-cRT**2*cRR*anT*anR**2)/anR**3/cRR**3
btt = -(-cTTr*anR**3*cRR**2+cRRr*anR**3*cRR*cTT-cRS*cRRs*anR**3*cTT+cRS*cTTs*anR**3*cRR+cRT*cTTt*anR**3*cRR+cRT*ccT*anR**3*cRR-cRT*cRRt*anR**3*cTT-2*cRT**2*cRR*anTt*anR**2-cRT**2*cRR*a0*anR**2+cRRt*anR**2*cRT**2*anT+cST*cRR**2*anTs*anR**2+2*cTT*cRR**2*anTt*anR**2+cTT*cRR**2*a0*anR**2+ccR*anR**3*cRR*cTT+ccT*anR**2*cRR**2*anT+cRTr*anR**2*cRR**2*anT-cRRr*anR**2*cRR*cRT*anT-2*cRS*cRT*cRR*anTs*anR**2+2*cRS*cRT*cRR*anRs*anT*anR-cRS*cRTs*anR**2*cRR*anT+cRS*cRRs*anR**2*cRT*anT+2*cRT**2*cRR*anRt*anT*anR-2*cRT*ccR*anR**2*cRR*anT-cRT*cRTt*anR**2*cRR*anT-cST*cRR**2*anRs*anT*anR-2*cTT*cRR**2*anRt*anT*anR)/anR**3/cRR**3
bt  = -(c0*anR**2*cRR**2*anT-ccTr*anR**3*cRR**2+cRSr*anR**2*cRR**2*anTs+cRTr*anR**2*cRR**2*anTt+cRRr*anR**3*cRR*ccT-cRS*cRRs*anR**3*ccT+cRS*ccTs*anR**3*cRR-cRS**2*cRR*anTss*anR**2-2*cRS**2*cRR*anRs**2*anT+cRRs*anR**2*cRS**2*anTs+cSS*cRR**2*anTss*anR**2+2*cSS*cRR**2*anRs**2*anT+cRT*ccTt*anR**3*cRR+cRT*c0*anR**3*cRR-cRT*cRRt*anR**3*ccT-cRT**2*cRR*anTtt*anR**2-2*cRT**2*cRR*a0t*anR**2-2*cRT**2*cRR*anRt**2*anT+cRRt*anR**2*cRT**2*anTt+cRRt*anR**2*cRT**2*a0+cST*cRR**2*anTst*anR**2+cST*cRR**2*a0s*anR**2+cTT*cRR**2*anTtt*anR**2+2*cTT*cRR**2*a0t*anR**2+2*cTT*cRR**2*anRt**2*anT-ccR**2*anR**2*cRR*anT+ccR*anR**3*cRR*ccT+ccS*anR**2*cRR**2*anTs+ccT*anR**2*cRR**2*anTt+ccT*anR**2*cRR**2*a0-cRRr*anR**2*cRR*cRS*anTs+cRRr*anR*cRR*cRS*anRs*anT+cRRr*anR*cRR*cRT*anRt*anT-cRRr*anR**2*cRR*cRT*anTt-cRRr*anR**2*cRR*cRT*a0+2*cRS**2*cRR*anRs*anTs*anR+2*cRS*cRT*cRR*anRs*anTt*anR-cRRr*anR**2*cRR*ccR*anT+cRS**2*cRR*anRss*anR*anT-2*cRS*cRT*cRR*anTst*anR**2-2*cRS*cRT*cRR*a0s*anR**2+2*cRS*cRT*cRR*anRs*a0*anR-4*cRS*cRT*cRR*anRs*anRt*anT-2*cRS*ccR*anR**2*cRR*anTs+2*cRS*cRT*cRR*anRt*anTs*anR+2*cRS*cRT*cRR*anRst*anR*anT+2*cRS*ccR*anR*cRR*anRs*anT-cRS*cRSs*anR**2*cRR*anTs+cRS*cRSs*anR*cRR*anRs*anT-cRS*cRTs*anR**2*cRR*anTt-cRS*cRTs*anR**2*cRR*a0+cRS*cRTs*anR*cRR*anRt*anT-cRS*ccRs*anR**2*cRR*anT-cRRs*anR*cRS**2*anRs*anT+cRS*cRRs*anR**2*cRT*anTt+cRS*cRRs*anR**2*cRT*a0-cRS*cRRs*anR*cRT*anRt*anT+cRS*cRRs*anR**2*ccR*anT-2*cSS*cRR**2*anRs*anTs*anR-cSS*cRR**2*anRss*anR*anT+2*cRT**2*cRR*anRt*anTt*anR+2*cRT**2*cRR*anRt*a0*anR+cRT**2*cRR*anRtt*anR*anT+2*cRT*ccR*anR*cRR*anRt*anT-cRT*cRSt*anR**2*cRR*anTs+cRT*cRSt*anR*cRR*anRs*anT-cRT*cRTt*anR**2*cRR*anTt-cRT*cRTt*anR**2*cRR*a0+cRT*cRTt*anR*cRR*anRt*anT-cRT*ccRt*anR**2*cRR*anT+cRT*cRRt*anR**2*cRS*anTs-cRT*cRRt*anR*cRS*anRs*anT-cRRt*anR*cRT**2*anRt*anT+cRT*cRRt*anR**2*ccR*anT-cST*cRR**2*anRs*anTt*anR-cST*cRR**2*anRs*a0*anR+2*cST*cRR**2*anRs*anRt*anT-cST*cRR**2*anRt*anTs*anR-cST*cRR**2*anRst*anR*anT-2*cTT*cRR**2*anRt*anTt*anR-2*cTT*cRR**2*anRt*a0*anR-2*cRT*ccR*anR**2*cRR*anTt-2*cRT*ccR*anR**2*cRR*a0-ccT*anR*cRR**2*anRt*anT-cRSr*anR*cRR**2*anRs*anT+cRTr*anR**2*cRR**2*a0+ccRr*anR**2*cRR**2*anT-cTT*cRR**2*anRtt*anR*anT-ccS*anR*cRR**2*anRs*anT-cRTr*anR*cRR**2*anRt*anT)/anR**3/cRR**3
brs = 0
brt = 0
bst = -(cRRr*anR**3*cRR*cST+cRS*ccT*anR**3*cRR+cRS*cSTs*anR**3*cRR-cRS*cRRs*anR**3*cST-2*cRS**2*cRR*anTs*anR**2+cRRs*anR**2*cRS**2*anT+2*cSS*cRR**2*anTs*anR**2+cRT*cSTt*anR**3*cRR+cRT*ccS*anR**3*cRR-cRT*cRRt*anR**3*cST-2*cRT**2*cRR*anSt*anR**2+cRRt*anR**2*cRT**2*anS+cST*cRR**2*anSs*anR**2+cST*cRR**2*anTt*anR**2+cST*cRR**2*a0*anR**2+2*cTT*cRR**2*anSt*anR**2+ccR*anR**3*cRR*cST+ccS*anR**2*cRR**2*anT+ccT*anR**2*cRR**2*anS+cRSr*anR**2*cRR**2*anT+cRTr*anR**2*cRR**2*anS-cSTr*anR**3*cRR**2-cRRr*anR**2*cRR*cRS*anT-cRRr*anR**2*cRR*cRT*anS+2*cRS**2*cRR*anRs*anT*anR+2*cRS*cRT*cRR*anRs*anS*anR-2*cRS*cRT*cRR*anSs*anR**2-2*cRS*cRT*cRR*anTt*anR**2-2*cRS*cRT*cRR*a0*anR**2+2*cRS*cRT*cRR*anRt*anT*anR-2*cRS*ccR*anR**2*cRR*anT-cRS*cRSs*anR**2*cRR*anT-cRS*cRTs*anR**2*cRR*anS+cRS*cRRs*anR**2*cRT*anS-2*cSS*cRR**2*anRs*anT*anR-2*cRT*ccR*anR**2*cRR*anS-cRT*cRSt*anR**2*cRR*anT-cRT*cRTt*anR**2*cRR*anS+cRT*cRRt*anR**2*cRS*anT+2*cRT**2*cRR*anRt*anS*anR-cST*cRR**2*anRt*anT*anR-2*cTT*cRR**2*anRt*anS*anR-cST*cRR**2*anRs*anS*anR)/anR**3/cRR**3
brss= 0
brst= 0
brtt= 0
bsst= -(cRS*cST*anR**3*cRR-cRS**2*cRR*anT*anR**2-2*cRS*cRT*cRR*anS*anR**2+cSS*cRR**2*anT*anR**2+cRT*cSS*anR**3*cRR+cST*cRR**2*anS*anR**2)/anR**3/cRR**3
bstt= -(cRS*cTT*anR**3*cRR-2*cRS*cRT*cRR*anT*anR**2+cRT*cST*anR**3*cRR-cRT**2*cRR*anS*anR**2+cST*cRR**2*anT*anR**2+cTT*cRR**2*anS*anR**2)/anR**3/cRR**3
bf  = -(ffr*anR**3*cRR**2+cRRr*anR**2*cRR*cRS*gs-cRRr*anR*cRR*cRS*anRs*g+cRRr*anR**2*cRR*cRT*gt-cRRr*anR*cRR*cRT*anRt*g+cRRr*anR**2*cRR*ccR*g-cRRr*anR**3*cRR*ff-cRRs*anR**2*cRS**2*gs+cRS**2*cRR*gss*anR**2+2*cRS**2*cRR*anRs**2*g-cRS*ffs*anR**3*cRR+cRS*cRRs*anR**3*ff-cSS*cRR**2*gss*anR**2-2*cSS*cRR**2*anRs**2*g+2*cRT**2*cRR*anRt**2*g-cRT*fft*anR**3*cRR+cRT**2*cRR*gtt*anR**2-cRRt*anR**2*cRT**2*gt+cRT*cRRt*anR**3*ff-cST*cRR**2*gst*anR**2-2*cTT*cRR**2*anRt**2*g-cTT*cRR**2*gtt*anR**2+ccR**2*anR**2*cRR*g-ccR*anR**3*cRR*ff-ccS*anR**2*cRR**2*gs-ccT*anR**2*cRR**2*gt-c0*anR**2*cRR**2*g-cRSr*anR**2*cRR**2*gs-cRTr*anR**2*cRR**2*gt-ccRr*anR**2*cRR**2*g-cRS*cRRs*anR**2*ccR*g-cRS*cRRs*anR**2*cRT*gt+2*cRS*cRT*cRR*gst*anR**2+2*cRS*ccR*anR**2*cRR*gs+cRS*cRSs*anR**2*cRR*gs+cRS*cRTs*anR**2*cRR*gt+cRS*ccRs*anR**2*cRR*g-2*cRS**2*cRR*anRs*gs*anR-cRS**2*cRR*anRss*anR*g-2*cRS*cRT*cRR*anRs*gt*anR+4*cRS*cRT*cRR*anRs*anRt*g-2*cRS*cRT*cRR*anRt*gs*anR-2*cRS*cRT*cRR*anRst*anR*g-2*cRS*ccR*anR*cRR*anRs*g-cRS*cRSs*anR*cRR*anRs*g-cRS*cRTs*anR*cRR*anRt*g+cRRs*anR*cRS**2*anRs*g+cRS*cRRs*anR*cRT*anRt*g+2*cSS*cRR**2*anRs*gs*anR+cSS*cRR**2*anRss*anR*g+2*cRT*ccR*anR**2*cRR*gt+cRT*cRSt*anR**2*cRR*gs+cRT*cRTt*anR**2*cRR*gt+cRT*ccRt*anR**2*cRR*g-cRT*cRRt*anR**2*cRS*gs-cRT*cRRt*anR**2*ccR*g-2*cRT**2*cRR*anRt*gt*anR-cRT**2*cRR*anRtt*anR*g-2*cRT*ccR*anR*cRR*anRt*g-cRT*cRSt*anR*cRR*anRs*g-cRT*cRTt*anR*cRR*anRt*g+cRT*cRRt*anR*cRS*anRs*g+cRRt*anR*cRT**2*anRt*g+cST*cRR**2*anRs*gt*anR-2*cST*cRR**2*anRs*anRt*g+cST*cRR**2*anRt*gs*anR+cST*cRR**2*anRst*anR*g+2*cTT*cRR**2*anRt*gt*anR+cTT*cRR**2*anRtt*anR*g+ccS*anR*cRR**2*anRs*g+ccT*anR*cRR**2*anRt*g+cRSr*anR*cRR**2*anRs*g+cRTr*anR*cRR**2*anRt*g)/anR**3/cRR**3
#End
#End

 ! ---------------- Start s direction ---------------
#If #DIR eq "S"
 ! Outward normal : (n1,n2,n3) 
 ani=nsign/sqrt(ajsx**2+ajsy**2+ajsz**2)
 n1=ajsx*ani
 n2=ajsy*ani
 n3=ajsz*ani
 ! BC : anS*us + anT*ut + anR*ur + a0*u 
 anS=a1*(n1*ajsx+n2*ajsy+n3*ajsz)
 anT=a1*(n1*ajtx+n2*ajty+n3*ajtz)
 anR=a1*(n1*ajrx+n2*ajry+n3*ajrz)
! >>>>>>>
 anit=-(ajsx*ajsxt+ajsy*ajsyt+ajsz*ajszt)*ani**3
 anitt=-(ajsx*ajsxtt+ajsy*ajsytt+ajsz*ajsztt+ajsxt*ajsxt+ajsyt*ajsyt+ajszt*ajszt)*ani**3 -3.*(ajsx*ajsxt+ajsy*ajsyt+ajsz*ajszt)*ani**2*anit
 n1t=ajsxt*ani + ajsx*anit
 n1tt=ajsxtt*ani + 2.*ajsxt*anit + ajsx*anitt
 n2t=ajsyt*ani + ajsy*anit
 n2tt=ajsytt*ani + 2.*ajsyt*anit + ajsy*anitt
 n3t=ajszt*ani + ajsz*anit
 n3tt=ajsztt*ani + 2.*ajszt*anit + ajsz*anitt

 anSt =a1*(n1*ajsxt+n2*ajsyt+n3*ajszt+n1t*ajsx+n2t*ajsy+n3t*ajsz)
 anStt=a1*(n1*ajsxtt+n2*ajsytt+n3*ajsztt+2.*(n1t*ajsxt+n2t*ajsyt+n3t*ajszt)+n1tt*ajsx+n2tt*ajsy+n3tt*ajsz)
 anTt =a1*(n1*ajtxt+n2*ajtyt+n3*ajtzt+n1t*ajtx+n2t*ajty+n3t*ajtz)
 anTtt=a1*(n1*ajtxtt+n2*ajtytt+n3*ajtztt+2.*(n1t*ajtxt+n2t*ajtyt+n3t*ajtzt)+n1tt*ajtx+n2tt*ajty+n3tt*ajtz)
 anRt =a1*(n1*ajrxt+n2*ajryt+n3*ajrzt+n1t*ajrx+n2t*ajry+n3t*ajrz)
 anRtt=a1*(n1*ajrxtt+n2*ajrytt+n3*ajrztt+2.*(n1t*ajrxt+n2t*ajryt+n3t*ajrzt)+n1tt*ajrx+n2tt*ajry+n3tt*ajrz)
! <<<<<<<
! >>>>>>>
 anir=-(ajsx*ajsxr+ajsy*ajsyr+ajsz*ajszr)*ani**3
 anirr=-(ajsx*ajsxrr+ajsy*ajsyrr+ajsz*ajszrr+ajsxr*ajsxr+ajsyr*ajsyr+ajszr*ajszr)*ani**3 -3.*(ajsx*ajsxr+ajsy*ajsyr+ajsz*ajszr)*ani**2*anir
 anirt=-(ajsx*ajsxrt+ajsy*ajsyrt+ajsz*ajszrt+ajsxt*ajsxr+ajsyt*ajsyr+ajszt*ajszr)*ani**3 -3.*(ajsx*ajsxt+ajsy*ajsyt+ajsz*ajszt)*ani**2*anir
 n1r=ajsxr*ani + ajsx*anir
 n1rr=ajsxrr*ani + 2.*ajsxr*anir + ajsx*anirr
 n1rt=ajsxrt*ani + ajsxr*anit + ajsxt*anir + ajsx*anirt
 n2r=ajsyr*ani + ajsy*anir
 n2rr=ajsyrr*ani + 2.*ajsyr*anir + ajsy*anirr
 n2rt=ajsyrt*ani + ajsyr*anit + ajsyt*anir + ajsy*anirt
 n3r=ajszr*ani + ajsz*anir
 n3rr=ajszrr*ani + 2.*ajszr*anir + ajsz*anirr
 n3rt=ajszrt*ani + ajszr*anit + ajszt*anir + ajsz*anirt

 anSr =a1*(n1*ajsxr+n2*ajsyr+n3*ajszr+n1r*ajsx+n2r*ajsy+n3r*ajsz)
 anSrr=a1*(n1*ajsxrr+n2*ajsyrr+n3*ajszrr+2.*(n1r*ajsxr+n2r*ajsyr+n3r*ajszr)+n1rr*ajsx+n2rr*ajsy+n3rr*ajsz)
 anSrt=a1*(n1*ajsxrt+n2*ajsyrt+n3*ajszrt +n1t*ajsxr+n2t*ajsyr+n3t*ajszr +n1r*ajsxt+n2r*ajsyt+n3r*ajszt +n1rt*ajsx+n2rt*ajsy+n3rt*ajsz)
 anTr =a1*(n1*ajtxr+n2*ajtyr+n3*ajtzr+n1r*ajtx+n2r*ajty+n3r*ajtz)
 anTrr=a1*(n1*ajtxrr+n2*ajtyrr+n3*ajtzrr+2.*(n1r*ajtxr+n2r*ajtyr+n3r*ajtzr)+n1rr*ajtx+n2rr*ajty+n3rr*ajtz)
 anTrt=a1*(n1*ajtxrt+n2*ajtyrt+n3*ajtzrt +n1t*ajtxr+n2t*ajtyr+n3t*ajtzr +n1r*ajtxt+n2r*ajtyt+n3r*ajtzt +n1rt*ajtx+n2rt*ajty+n3rt*ajtz)
 anRr =a1*(n1*ajrxr+n2*ajryr+n3*ajrzr+n1r*ajrx+n2r*ajry+n3r*ajrz)
 anRrr=a1*(n1*ajrxrr+n2*ajryrr+n3*ajrzrr+2.*(n1r*ajrxr+n2r*ajryr+n3r*ajrzr)+n1rr*ajrx+n2rr*ajry+n3rr*ajrz)
 anRrt=a1*(n1*ajrxrt+n2*ajryrt+n3*ajrzrt +n1t*ajrxr+n2t*ajryr+n3t*ajrzr +n1r*ajrxt+n2r*ajryt+n3r*ajrzt +n1rt*ajrx+n2rt*ajry+n3rt*ajrz)
! <<<<<<<
 ! Here are the expressions for the normal derivatives
#If #OPTION eq "LHS"
bn3 = 1
bn2 = 0
bn2 = 0
bn1 = 0
b0  = -(-c0s*anS**3*cSS**2+cSSs*anS**3*cSS*c0-cST*cSSt*anS**3*c0+cST*c0t*anS**3*cSS-cST**2*cSS*a0tt*anS**2-2*cST**2*cSS*anSt**2*a0+cSSt*anS**2*cST**2*a0t+cTT*cSS**2*a0tt*anS**2+2*cTT*cSS**2*anSt**2*a0+cRS*c0r*anS**3*cSS-cRS*cSSr*anS**3*c0-cRS**2*cSS*a0rr*anS**2-2*cRS**2*cSS*anSr**2*a0+cSSr*anS**2*cRS**2*a0r+cRT*cSS**2*a0rt*anS**2+cRR*cSS**2*a0rr*anS**2+2*cRR*cSS**2*anSr**2*a0-ccS**2*anS**2*cSS*a0+ccS*anS**3*cSS*c0+ccT*anS**2*cSS**2*a0t+ccR*anS**2*cSS**2*a0r+c0*anS**2*cSS**2*a0+cSTs*anS**2*cSS**2*a0t+cRSs*anS**2*cSS**2*a0r+ccSs*anS**2*cSS**2*a0-cSSs*anS**2*cSS*cST*a0t+cSSs*anS*cSS*cST*anSt*a0-cSSs*anS**2*cSS*cRS*a0r+cSSs*anS*cSS*cRS*anSr*a0-cSSs*anS**2*cSS*ccS*a0+2*cST**2*cSS*anSt*a0t*anS+cST**2*cSS*anStt*anS*a0-2*cST*cRS*cSS*a0rt*anS**2+2*cST*cRS*cSS*anSt*a0r*anS-4*cST*cRS*cSS*anSt*anSr*a0+2*cST*cRS*cSS*anSr*a0t*anS+2*cST*cRS*cSS*anSrt*anS*a0-2*cST*ccS*anS**2*cSS*a0t+2*cST*ccS*anS*cSS*anSt*a0-cST*cSTt*anS**2*cSS*a0t+cST*cSTt*anS*cSS*anSt*a0-cST*cRSt*anS**2*cSS*a0r+cST*cRSt*anS*cSS*anSr*a0-cST*ccSt*anS**2*cSS*a0-cSSt*anS*cST**2*anSt*a0+cST*cSSt*anS**2*cRS*a0r-cST*cSSt*anS*cRS*anSr*a0+cST*cSSt*anS**2*ccS*a0-2*cTT*cSS**2*anSt*a0t*anS-cTT*cSS**2*anStt*anS*a0+2*cRS**2*cSS*anSr*a0r*anS+cRS**2*cSS*anSrr*anS*a0-2*cRS*ccS*anS**2*cSS*a0r+2*cRS*ccS*anS*cSS*anSr*a0-cRS*cSTr*anS**2*cSS*a0t+cRS*cSTr*anS*cSS*anSt*a0-cRS*cRSr*anS**2*cSS*a0r+cRS*cRSr*anS*cSS*anSr*a0-cRS*ccSr*anS**2*cSS*a0+cRS*cSSr*anS**2*cST*a0t-cRS*cSSr*anS*cST*anSt*a0-cSSr*anS*cRS**2*anSr*a0+cRS*cSSr*anS**2*ccS*a0-cRT*cSS**2*anSt*a0r*anS+2*cRT*cSS**2*anSt*anSr*a0-cRT*cSS**2*anSr*a0t*anS-cRT*cSS**2*anSrt*anS*a0-2*cRR*cSS**2*anSr*a0r*anS-cRR*cSS**2*anSrr*anS*a0-ccT*anS*cSS**2*anSt*a0-ccR*anS*cSS**2*anSr*a0-cSTs*anS*cSS**2*anSt*a0-cRSs*anS*cSS**2*anSr*a0)/anS**3/cSS**3
#End
#If #OPTION eq "RHS"
bttt= -(cTT*cSS**2*anT*anS**2-cST**2*cSS*anT*anS**2+cST*cTT*anS**3*cSS)/anS**3/cSS**3
btt = -(cSSs*anS**3*cSS*cTT+cST*ccT*anS**3*cSS+cST*cTTt*anS**3*cSS-cST*cSSt*anS**3*cTT-2*cST**2*cSS*anTt*anS**2-cST**2*cSS*a0*anS**2+cSSt*anS**2*cST**2*anT+2*cTT*cSS**2*anTt*anS**2+cTT*cSS**2*a0*anS**2+cRS*cTTr*anS**3*cSS-cRS*cSSr*anS**3*cTT+cRT*cSS**2*anTr*anS**2+ccS*anS**3*cSS*cTT+ccT*anS**2*cSS**2*anT+cSTs*anS**2*cSS**2*anT-cTTs*anS**3*cSS**2-cSSs*anS**2*cSS*cST*anT+2*cST**2*cSS*anSt*anT*anS-2*cST*cRS*cSS*anTr*anS**2+2*cST*cRS*cSS*anSr*anT*anS-2*cST*ccS*anS**2*cSS*anT-cST*cSTt*anS**2*cSS*anT-2*cTT*cSS**2*anSt*anT*anS-cRS*cSTr*anS**2*cSS*anT+cRS*cSSr*anS**2*cST*anT-cRT*cSS**2*anSr*anT*anS)/anS**3/cSS**3
bt  = -(-2*cRS**2*cSS*anSr**2*anT+cSSr*anS**2*cRS**2*anTr+cRT*cSS**2*anTrt*anS**2+cRT*cSS**2*a0r*anS**2+cRR*cSS**2*anTrr*anS**2+2*cRR*cSS**2*anSr**2*anT-ccS**2*anS**2*cSS*anT+ccS*anS**3*cSS*ccT-ccTs*anS**3*cSS**2-cRS*cSSr*anS**3*ccT+cSSs*anS**3*cSS*ccT-cST*cSSt*anS**3*ccT+cST*c0*anS**3*cSS+cST*ccTt*anS**3*cSS-cST**2*cSS*anTtt*anS**2-2*cST**2*cSS*a0t*anS**2-2*cST**2*cSS*anSt**2*anT+cSSt*anS**2*cST**2*anTt+cSSt*anS**2*cST**2*a0+cTT*cSS**2*anTtt*anS**2+2*cTT*cSS**2*a0t*anS**2+2*cTT*cSS**2*anSt**2*anT+cRS*ccTr*anS**3*cSS-cRS**2*cSS*anTrr*anS**2-cSSs*anS**2*cSS*cST*a0-cSSs*anS**2*cSS*cST*anTt-cSSs*anS**2*cSS*cRS*anTr+cSSs*anS*cSS*cRS*anSr*anT+cSSs*anS*cSS*cST*anSt*anT-cSSs*anS**2*cSS*ccS*anT+2*cST**2*cSS*anSt*anTt*anS+2*cST**2*cSS*anSt*a0*anS+cST**2*cSS*anStt*anS*anT+2*cST*cRS*cSS*anSt*anTr*anS-2*cST*cRS*cSS*anTrt*anS**2-2*cST*cRS*cSS*a0r*anS**2-4*cST*cRS*cSS*anSt*anSr*anT+2*cST*cRS*cSS*anSr*anTt*anS+2*cST*cRS*cSS*anSr*a0*anS+2*cST*cRS*cSS*anSrt*anS*anT-2*cST*ccS*anS**2*cSS*anTt-2*cST*ccS*anS**2*cSS*a0+2*cST*ccS*anS*cSS*anSt*anT-cST*cSTt*anS**2*cSS*anTt-cST*cSTt*anS**2*cSS*a0+cST*cSTt*anS*cSS*anSt*anT-cST*cRSt*anS**2*cSS*anTr+cST*cRSt*anS*cSS*anSr*anT-cST*ccSt*anS**2*cSS*anT-cSSt*anS*cST**2*anSt*anT+cST*cSSt*anS**2*cRS*anTr+2*cRS**2*cSS*anSr*anTr*anS+cRS**2*cSS*anSrr*anS*anT-2*cRS*ccS*anS**2*cSS*anTr+2*cRS*ccS*anS*cSS*anSr*anT-cRS*cSTr*anS**2*cSS*anTt-cRS*cSTr*anS**2*cSS*a0+cRS*cSTr*anS*cSS*anSt*anT-cRS*cRSr*anS**2*cSS*anTr+cRS*cRSr*anS*cSS*anSr*anT-cRS*ccSr*anS**2*cSS*anT+cRS*cSSr*anS**2*cST*anTt-cST*cSSt*anS*cRS*anSr*anT+cST*cSSt*anS**2*ccS*anT-2*cTT*cSS**2*anSt*anTt*anS-2*cTT*cSS**2*anSt*a0*anS-cTT*cSS**2*anStt*anS*anT-cSSr*anS*cRS**2*anSr*anT+cRS*cSSr*anS**2*ccS*anT-cRT*cSS**2*anSt*anTr*anS+2*cRT*cSS**2*anSt*anSr*anT-cRT*cSS**2*anSr*anTt*anS-cRT*cSS**2*anSr*a0*anS-cRT*cSS**2*anSrt*anS*anT-2*cRR*cSS**2*anSr*anTr*anS-cRR*cSS**2*anSrr*anS*anT+ccT*anS**2*cSS**2*anTt+ccT*anS**2*cSS**2*a0+ccR*anS**2*cSS**2*anTr+c0*anS**2*cSS**2*anT+cSTs*anS**2*cSS**2*anTt+cSTs*anS**2*cSS**2*a0+cRSs*anS**2*cSS**2*anTr+ccSs*anS**2*cSS**2*anT+cRS*cSSr*anS**2*cST*a0-cRS*cSSr*anS*cST*anSt*anT-ccT*anS*cSS**2*anSt*anT-ccR*anS*cSS**2*anSr*anT-cSTs*anS*cSS**2*anSt*anT-cRSs*anS*cSS**2*anSr*anT)/anS**3/cSS**3
brrr= -(cRS*cRR*anS**3*cSS+cRR*cSS**2*anR*anS**2-cRS**2*cSS*anR*anS**2)/anS**3/cSS**3
brr = -(-cRRs*anS**3*cSS**2+cSSs*anS**3*cSS*cRR-cST*cSSt*anS**3*cRR+cST*cRRt*anS**3*cSS+cRS*cRRr*anS**3*cSS+cRS*ccR*anS**3*cSS-cRS*cSSr*anS**3*cRR-2*cRS**2*cSS*anRr*anS**2-cRS**2*cSS*a0*anS**2+cSSr*anS**2*cRS**2*anR+cRT*cSS**2*anRt*anS**2+2*cRR*cSS**2*anRr*anS**2+cRR*cSS**2*a0*anS**2+ccS*anS**3*cSS*cRR+ccR*anS**2*cSS**2*anR+cRSs*anS**2*cSS**2*anR-cSSs*anS**2*cSS*cRS*anR-2*cST*cRS*cSS*anRt*anS**2+2*cST*cRS*cSS*anSt*anR*anS-cST*cRSt*anS**2*cSS*anR+cST*cSSt*anS**2*cRS*anR+2*cRS**2*cSS*anSr*anR*anS-2*cRS*ccS*anS**2*cSS*anR-cRS*cRSr*anS**2*cSS*anR-cRT*cSS**2*anSt*anR*anS-2*cRR*cSS**2*anSr*anR*anS)/anS**3/cSS**3
br  = -(c0*anS**2*cSS**2*anR-ccRs*anS**3*cSS**2+cSTs*anS**2*cSS**2*anRt+cRSs*anS**2*cSS**2*anRr+cSSs*anS**3*cSS*ccR-cST*cSSt*anS**3*ccR+cST*ccRt*anS**3*cSS-cST**2*cSS*anRtt*anS**2-2*cST**2*cSS*anSt**2*anR+cSSt*anS**2*cST**2*anRt+cTT*cSS**2*anRtt*anS**2+2*cTT*cSS**2*anSt**2*anR+cRS*ccRr*anS**3*cSS+cRS*c0*anS**3*cSS-cRS*cSSr*anS**3*ccR-cRS**2*cSS*anRrr*anS**2-2*cRS**2*cSS*a0r*anS**2-2*cRS**2*cSS*anSr**2*anR+cSSr*anS**2*cRS**2*anRr+cSSr*anS**2*cRS**2*a0+cRT*cSS**2*anRrt*anS**2+cRT*cSS**2*a0t*anS**2+cRR*cSS**2*anRrr*anS**2+2*cRR*cSS**2*a0r*anS**2+2*cRR*cSS**2*anSr**2*anR-ccS**2*anS**2*cSS*anR+ccS*anS**3*cSS*ccR+ccT*anS**2*cSS**2*anRt+ccR*anS**2*cSS**2*anRr+ccR*anS**2*cSS**2*a0-cSSs*anS**2*cSS*cST*anRt+cSSs*anS*cSS*cST*anSt*anR+cSSs*anS*cSS*cRS*anSr*anR-cSSs*anS**2*cSS*cRS*anRr-cSSs*anS**2*cSS*cRS*a0+2*cST**2*cSS*anSt*anRt*anS+2*cST*cRS*cSS*anSt*anRr*anS-cSSs*anS**2*cSS*ccS*anR+cST**2*cSS*anStt*anS*anR-2*cST*cRS*cSS*anRrt*anS**2-2*cST*cRS*cSS*a0t*anS**2+2*cST*cRS*cSS*anSt*a0*anS-4*cST*cRS*cSS*anSt*anSr*anR-2*cST*ccS*anS**2*cSS*anRt+2*cST*cRS*cSS*anSr*anRt*anS+2*cST*cRS*cSS*anSrt*anS*anR+2*cST*ccS*anS*cSS*anSt*anR-cST*cSTt*anS**2*cSS*anRt+cST*cSTt*anS*cSS*anSt*anR-cST*cRSt*anS**2*cSS*anRr-cST*cRSt*anS**2*cSS*a0+cST*cRSt*anS*cSS*anSr*anR-cST*ccSt*anS**2*cSS*anR-cSSt*anS*cST**2*anSt*anR+cST*cSSt*anS**2*cRS*anRr+cST*cSSt*anS**2*cRS*a0-cST*cSSt*anS*cRS*anSr*anR+cST*cSSt*anS**2*ccS*anR-2*cTT*cSS**2*anSt*anRt*anS-cTT*cSS**2*anStt*anS*anR+2*cRS**2*cSS*anSr*anRr*anS+2*cRS**2*cSS*anSr*a0*anS+cRS**2*cSS*anSrr*anS*anR+2*cRS*ccS*anS*cSS*anSr*anR-cRS*cSTr*anS**2*cSS*anRt+cRS*cSTr*anS*cSS*anSt*anR-cRS*cRSr*anS**2*cSS*anRr-cRS*cRSr*anS**2*cSS*a0+cRS*cRSr*anS*cSS*anSr*anR-cRS*ccSr*anS**2*cSS*anR+cRS*cSSr*anS**2*cST*anRt-cRS*cSSr*anS*cST*anSt*anR-cSSr*anS*cRS**2*anSr*anR+cRS*cSSr*anS**2*ccS*anR-cRT*cSS**2*anSt*anRr*anS-cRT*cSS**2*anSt*a0*anS+2*cRT*cSS**2*anSt*anSr*anR-cRT*cSS**2*anSr*anRt*anS-cRT*cSS**2*anSrt*anS*anR-2*cRR*cSS**2*anSr*anRr*anS-2*cRR*cSS**2*anSr*a0*anS-2*cRS*ccS*anS**2*cSS*anRr-2*cRS*ccS*anS**2*cSS*a0-ccR*anS*cSS**2*anSr*anR-cSTs*anS*cSS**2*anSt*anR+cRSs*anS**2*cSS**2*a0+ccSs*anS**2*cSS**2*anR-cRR*cSS**2*anSrr*anS*anR-ccT*anS*cSS**2*anSt*anR-cRSs*anS*cSS**2*anSr*anR)/anS**3/cSS**3
bst = 0
brs = 0
brt = -(cSSs*anS**3*cSS*cRT+cST*ccR*anS**3*cSS+cST*cRTt*anS**3*cSS-cST*cSSt*anS**3*cRT-2*cST**2*cSS*anRt*anS**2+cSSt*anS**2*cST**2*anR+2*cTT*cSS**2*anRt*anS**2+cRS*cRTr*anS**3*cSS+cRS*ccT*anS**3*cSS-cRS*cSSr*anS**3*cRT-2*cRS**2*cSS*anTr*anS**2+cSSr*anS**2*cRS**2*anT+cRT*cSS**2*anTt*anS**2+cRT*cSS**2*anRr*anS**2+cRT*cSS**2*a0*anS**2+2*cRR*cSS**2*anTr*anS**2+ccS*anS**3*cSS*cRT+ccT*anS**2*cSS**2*anR+ccR*anS**2*cSS**2*anT+cSTs*anS**2*cSS**2*anR+cRSs*anS**2*cSS**2*anT-cRTs*anS**3*cSS**2-cSSs*anS**2*cSS*cST*anR-cSSs*anS**2*cSS*cRS*anT+2*cST**2*cSS*anSt*anR*anS+2*cST*cRS*cSS*anSt*anT*anS-2*cST*cRS*cSS*anTt*anS**2-2*cST*cRS*cSS*anRr*anS**2-2*cST*cRS*cSS*a0*anS**2+2*cST*cRS*cSS*anSr*anR*anS-2*cST*ccS*anS**2*cSS*anR-cST*cSTt*anS**2*cSS*anR-cST*cRSt*anS**2*cSS*anT+cST*cSSt*anS**2*cRS*anT-2*cTT*cSS**2*anSt*anR*anS-2*cRS*ccS*anS**2*cSS*anT-cRS*cSTr*anS**2*cSS*anR-cRS*cRSr*anS**2*cSS*anT+cRS*cSSr*anS**2*cST*anR+2*cRS**2*cSS*anSr*anT*anS-cRT*cSS**2*anSr*anR*anS-2*cRR*cSS**2*anSr*anT*anS-cRT*cSS**2*anSt*anT*anS)/anS**3/cSS**3
bstt= 0
brst= 0
brrs= 0
brtt= -(cST*cRT*anS**3*cSS-cST**2*cSS*anR*anS**2-2*cST*cRS*cSS*anT*anS**2+cTT*cSS**2*anR*anS**2+cRS*cTT*anS**3*cSS+cRT*cSS**2*anT*anS**2)/anS**3/cSS**3
brrt= -(cST*cRR*anS**3*cSS-2*cST*cRS*cSS*anR*anS**2+cRS*cRT*anS**3*cSS-cRS**2*cSS*anT*anS**2+cRT*cSS**2*anR*anS**2+cRR*cSS**2*anT*anS**2)/anS**3/cSS**3
bf  = -(ffs*anS**3*cSS**2+cSSs*anS**2*cSS*cST*gt-cSSs*anS*cSS*cST*anSt*g+cSSs*anS**2*cSS*cRS*gr-cSSs*anS*cSS*cRS*anSr*g+cSSs*anS**2*cSS*ccS*g-cSSs*anS**3*cSS*ff-cSSt*anS**2*cST**2*gt+cST**2*cSS*gtt*anS**2+2*cST**2*cSS*anSt**2*g-cST*fft*anS**3*cSS+cST*cSSt*anS**3*ff-cTT*cSS**2*gtt*anS**2-2*cTT*cSS**2*anSt**2*g+2*cRS**2*cSS*anSr**2*g-cRS*ffr*anS**3*cSS+cRS**2*cSS*grr*anS**2-cSSr*anS**2*cRS**2*gr+cRS*cSSr*anS**3*ff-cRT*cSS**2*grt*anS**2-2*cRR*cSS**2*anSr**2*g-cRR*cSS**2*grr*anS**2+ccS**2*anS**2*cSS*g-ccS*anS**3*cSS*ff-ccT*anS**2*cSS**2*gt-ccR*anS**2*cSS**2*gr-c0*anS**2*cSS**2*g-cSTs*anS**2*cSS**2*gt-cRSs*anS**2*cSS**2*gr-ccSs*anS**2*cSS**2*g-cST*cSSt*anS**2*ccS*g-cST*cSSt*anS**2*cRS*gr+2*cST*cRS*cSS*grt*anS**2+2*cST*ccS*anS**2*cSS*gt+cST*cSTt*anS**2*cSS*gt+cST*cRSt*anS**2*cSS*gr+cST*ccSt*anS**2*cSS*g-2*cST**2*cSS*anSt*gt*anS-cST**2*cSS*anStt*anS*g-2*cST*cRS*cSS*anSt*gr*anS+4*cST*cRS*cSS*anSt*anSr*g-2*cST*cRS*cSS*anSr*gt*anS-2*cST*cRS*cSS*anSrt*anS*g-2*cST*ccS*anS*cSS*anSt*g-cST*cSTt*anS*cSS*anSt*g-cST*cRSt*anS*cSS*anSr*g+cSSt*anS*cST**2*anSt*g+cST*cSSt*anS*cRS*anSr*g+2*cTT*cSS**2*anSt*gt*anS+cTT*cSS**2*anStt*anS*g+2*cRS*ccS*anS**2*cSS*gr+cRS*cSTr*anS**2*cSS*gt+cRS*cRSr*anS**2*cSS*gr+cRS*ccSr*anS**2*cSS*g-cRS*cSSr*anS**2*cST*gt-cRS*cSSr*anS**2*ccS*g-2*cRS**2*cSS*anSr*gr*anS-cRS**2*cSS*anSrr*anS*g-2*cRS*ccS*anS*cSS*anSr*g-cRS*cSTr*anS*cSS*anSt*g-cRS*cRSr*anS*cSS*anSr*g+cRS*cSSr*anS*cST*anSt*g+cSSr*anS*cRS**2*anSr*g+cRT*cSS**2*anSt*gr*anS-2*cRT*cSS**2*anSt*anSr*g+cRT*cSS**2*anSr*gt*anS+cRT*cSS**2*anSrt*anS*g+2*cRR*cSS**2*anSr*gr*anS+cRR*cSS**2*anSrr*anS*g+ccT*anS*cSS**2*anSt*g+ccR*anS*cSS**2*anSr*g+cSTs*anS*cSS**2*anSt*g+cRSs*anS*cSS**2*anSr*g)/anS**3/cSS**3
#End
#End

 ! ---------------- Start t direction ---------------
#If #DIR eq "T"
 ! Outward normal : (n1,n2,n3) 
 ani=nsign/sqrt(ajtx**2+ajty**2+ajtz**2)
 n1=ajtx*ani
 n2=ajty*ani
 n3=ajtz*ani
 ! BC : anT*ut + anR*ur + anS*us + a0*u 
 anT=a1*(n1*ajtx+n2*ajty+n3*ajtz)
 anR=a1*(n1*ajrx+n2*ajry+n3*ajrz)
 anS=a1*(n1*ajsx+n2*ajsy+n3*ajsz)
! >>>>>>>
 anir=-(ajtx*ajtxr+ajty*ajtyr+ajtz*ajtzr)*ani**3
 anirr=-(ajtx*ajtxrr+ajty*ajtyrr+ajtz*ajtzrr+ajtxr*ajtxr+ajtyr*ajtyr+ajtzr*ajtzr)*ani**3 -3.*(ajtx*ajtxr+ajty*ajtyr+ajtz*ajtzr)*ani**2*anir
 n1r=ajtxr*ani + ajtx*anir
 n1rr=ajtxrr*ani + 2.*ajtxr*anir + ajtx*anirr
 n2r=ajtyr*ani + ajty*anir
 n2rr=ajtyrr*ani + 2.*ajtyr*anir + ajty*anirr
 n3r=ajtzr*ani + ajtz*anir
 n3rr=ajtzrr*ani + 2.*ajtzr*anir + ajtz*anirr

 anTr =a1*(n1*ajtxr+n2*ajtyr+n3*ajtzr+n1r*ajtx+n2r*ajty+n3r*ajtz)
 anTrr=a1*(n1*ajtxrr+n2*ajtyrr+n3*ajtzrr+2.*(n1r*ajtxr+n2r*ajtyr+n3r*ajtzr)+n1rr*ajtx+n2rr*ajty+n3rr*ajtz)
 anRr =a1*(n1*ajrxr+n2*ajryr+n3*ajrzr+n1r*ajrx+n2r*ajry+n3r*ajrz)
 anRrr=a1*(n1*ajrxrr+n2*ajryrr+n3*ajrzrr+2.*(n1r*ajrxr+n2r*ajryr+n3r*ajrzr)+n1rr*ajrx+n2rr*ajry+n3rr*ajrz)
 anSr =a1*(n1*ajsxr+n2*ajsyr+n3*ajszr+n1r*ajsx+n2r*ajsy+n3r*ajsz)
 anSrr=a1*(n1*ajsxrr+n2*ajsyrr+n3*ajszrr+2.*(n1r*ajsxr+n2r*ajsyr+n3r*ajszr)+n1rr*ajsx+n2rr*ajsy+n3rr*ajsz)
! <<<<<<<
! >>>>>>>
 anis=-(ajtx*ajtxs+ajty*ajtys+ajtz*ajtzs)*ani**3
 aniss=-(ajtx*ajtxss+ajty*ajtyss+ajtz*ajtzss+ajtxs*ajtxs+ajtys*ajtys+ajtzs*ajtzs)*ani**3 -3.*(ajtx*ajtxs+ajty*ajtys+ajtz*ajtzs)*ani**2*anis
 anirs=-(ajtx*ajtxrs+ajty*ajtyrs+ajtz*ajtzrs+ajtxr*ajtxs+ajtyr*ajtys+ajtzr*ajtzs)*ani**3 -3.*(ajtx*ajtxr+ajty*ajtyr+ajtz*ajtzr)*ani**2*anis
 n1s=ajtxs*ani + ajtx*anis
 n1ss=ajtxss*ani + 2.*ajtxs*anis + ajtx*aniss
 n1rs=ajtxrs*ani + ajtxs*anir + ajtxr*anis + ajtx*anirs
 n2s=ajtys*ani + ajty*anis
 n2ss=ajtyss*ani + 2.*ajtys*anis + ajty*aniss
 n2rs=ajtyrs*ani + ajtys*anir + ajtyr*anis + ajty*anirs
 n3s=ajtzs*ani + ajtz*anis
 n3ss=ajtzss*ani + 2.*ajtzs*anis + ajtz*aniss
 n3rs=ajtzrs*ani + ajtzs*anir + ajtzr*anis + ajtz*anirs

 anTs =a1*(n1*ajtxs+n2*ajtys+n3*ajtzs+n1s*ajtx+n2s*ajty+n3s*ajtz)
 anTss=a1*(n1*ajtxss+n2*ajtyss+n3*ajtzss+2.*(n1s*ajtxs+n2s*ajtys+n3s*ajtzs)+n1ss*ajtx+n2ss*ajty+n3ss*ajtz)
 anTrs=a1*(n1*ajtxrs+n2*ajtyrs+n3*ajtzrs +n1r*ajtxs+n2r*ajtys+n3r*ajtzs +n1s*ajtxr+n2s*ajtyr+n3s*ajtzr +n1rs*ajtx+n2rs*ajty+n3rs*ajtz)
 anRs =a1*(n1*ajrxs+n2*ajrys+n3*ajrzs+n1s*ajrx+n2s*ajry+n3s*ajrz)
 anRss=a1*(n1*ajrxss+n2*ajryss+n3*ajrzss+2.*(n1s*ajrxs+n2s*ajrys+n3s*ajrzs)+n1ss*ajrx+n2ss*ajry+n3ss*ajrz)
 anRrs=a1*(n1*ajrxrs+n2*ajryrs+n3*ajrzrs +n1r*ajrxs+n2r*ajrys+n3r*ajrzs +n1s*ajrxr+n2s*ajryr+n3s*ajrzr +n1rs*ajrx+n2rs*ajry+n3rs*ajrz)
 anSs =a1*(n1*ajsxs+n2*ajsys+n3*ajszs+n1s*ajsx+n2s*ajsy+n3s*ajsz)
 anSss=a1*(n1*ajsxss+n2*ajsyss+n3*ajszss+2.*(n1s*ajsxs+n2s*ajsys+n3s*ajszs)+n1ss*ajsx+n2ss*ajsy+n3ss*ajsz)
 anSrs=a1*(n1*ajsxrs+n2*ajsyrs+n3*ajszrs +n1r*ajsxs+n2r*ajsys+n3r*ajszs +n1s*ajsxr+n2s*ajsyr+n3s*ajszr +n1rs*ajsx+n2rs*ajsy+n3rs*ajsz)
! <<<<<<<
 ! Here are the expressions for the normal derivatives
#If #OPTION eq "LHS"
bn3 = 1
bn2 = 0
bn2 = 0
bn1 = 0
b0  = -(-c0t*anT**3*cTT**2+cTTt*anT**3*cTT*c0-cRT*cTTr*anT**3*c0+cRT*c0r*anT**3*cTT-cRT**2*cTT*a0rr*anT**2-2*cRT**2*cTT*anTr**2*a0+cTTr*anT**2*cRT**2*a0r+cRR*cTT**2*a0rr*anT**2+2*cRR*cTT**2*anTr**2*a0+cST*c0s*anT**3*cTT-cST*cTTs*anT**3*c0-cST**2*cTT*a0ss*anT**2-2*cST**2*cTT*anTs**2*a0+cTTs*anT**2*cST**2*a0s+cRS*cTT**2*a0rs*anT**2+cSS*cTT**2*a0ss*anT**2+2*cSS*cTT**2*anTs**2*a0-ccT**2*anT**2*cTT*a0+ccT*anT**3*cTT*c0+ccR*anT**2*cTT**2*a0r+ccS*anT**2*cTT**2*a0s+c0*anT**2*cTT**2*a0+cRTt*anT**2*cTT**2*a0r+cSTt*anT**2*cTT**2*a0s+ccTt*anT**2*cTT**2*a0-cTTt*anT**2*cTT*cRT*a0r+cTTt*anT*cTT*cRT*anTr*a0-cTTt*anT**2*cTT*cST*a0s+cTTt*anT*cTT*cST*anTs*a0-cTTt*anT**2*cTT*ccT*a0+2*cRT**2*cTT*anTr*a0r*anT+cRT**2*cTT*anTrr*anT*a0-2*cRT*cST*cTT*a0rs*anT**2+2*cRT*cST*cTT*anTr*a0s*anT-4*cRT*cST*cTT*anTr*anTs*a0+2*cRT*cST*cTT*anTs*a0r*anT+2*cRT*cST*cTT*anTrs*anT*a0-2*cRT*ccT*anT**2*cTT*a0r+2*cRT*ccT*anT*cTT*anTr*a0-cRT*cRTr*anT**2*cTT*a0r+cRT*cRTr*anT*cTT*anTr*a0-cRT*cSTr*anT**2*cTT*a0s+cRT*cSTr*anT*cTT*anTs*a0-cRT*ccTr*anT**2*cTT*a0-cTTr*anT*cRT**2*anTr*a0+cRT*cTTr*anT**2*cST*a0s-cRT*cTTr*anT*cST*anTs*a0+cRT*cTTr*anT**2*ccT*a0-2*cRR*cTT**2*anTr*a0r*anT-cRR*cTT**2*anTrr*anT*a0+2*cST**2*cTT*anTs*a0s*anT+cST**2*cTT*anTss*anT*a0-2*cST*ccT*anT**2*cTT*a0s+2*cST*ccT*anT*cTT*anTs*a0-cST*cRTs*anT**2*cTT*a0r+cST*cRTs*anT*cTT*anTr*a0-cST*cSTs*anT**2*cTT*a0s+cST*cSTs*anT*cTT*anTs*a0-cST*ccTs*anT**2*cTT*a0+cST*cTTs*anT**2*cRT*a0r-cST*cTTs*anT*cRT*anTr*a0-cTTs*anT*cST**2*anTs*a0+cST*cTTs*anT**2*ccT*a0-cRS*cTT**2*anTr*a0s*anT+2*cRS*cTT**2*anTr*anTs*a0-cRS*cTT**2*anTs*a0r*anT-cRS*cTT**2*anTrs*anT*a0-2*cSS*cTT**2*anTs*a0s*anT-cSS*cTT**2*anTss*anT*a0-ccR*anT*cTT**2*anTr*a0-ccS*anT*cTT**2*anTs*a0-cRTt*anT*cTT**2*anTr*a0-cSTt*anT*cTT**2*anTs*a0)/anT**3/cTT**3
#End
#If #OPTION eq "RHS"
brrr= -(cRR*cTT**2*anR*anT**2-cRT**2*cTT*anR*anT**2+cRT*cRR*anT**3*cTT)/anT**3/cTT**3
brr = -(cTTt*anT**3*cTT*cRR+cRT*ccR*anT**3*cTT+cRT*cRRr*anT**3*cTT-cRT*cTTr*anT**3*cRR-2*cRT**2*cTT*anRr*anT**2-cRT**2*cTT*a0*anT**2+cTTr*anT**2*cRT**2*anR+2*cRR*cTT**2*anRr*anT**2+cRR*cTT**2*a0*anT**2+cST*cRRs*anT**3*cTT-cST*cTTs*anT**3*cRR+cRS*cTT**2*anRs*anT**2+ccT*anT**3*cTT*cRR+ccR*anT**2*cTT**2*anR+cRTt*anT**2*cTT**2*anR-cRRt*anT**3*cTT**2-cTTt*anT**2*cTT*cRT*anR+2*cRT**2*cTT*anTr*anR*anT-2*cRT*cST*cTT*anRs*anT**2+2*cRT*cST*cTT*anTs*anR*anT-2*cRT*ccT*anT**2*cTT*anR-cRT*cRTr*anT**2*cTT*anR-2*cRR*cTT**2*anTr*anR*anT-cST*cRTs*anT**2*cTT*anR+cST*cTTs*anT**2*cRT*anR-cRS*cTT**2*anTs*anR*anT)/anT**3/cTT**3
br  = -(-2*cST**2*cTT*anTs**2*anR+cTTs*anT**2*cST**2*anRs+cRS*cTT**2*anRrs*anT**2+cRS*cTT**2*a0s*anT**2+cSS*cTT**2*anRss*anT**2+2*cSS*cTT**2*anTs**2*anR-ccT**2*anT**2*cTT*anR+ccT*anT**3*cTT*ccR-ccRt*anT**3*cTT**2-cST*cTTs*anT**3*ccR+cTTt*anT**3*cTT*ccR-cRT*cTTr*anT**3*ccR+cRT*c0*anT**3*cTT+cRT*ccRr*anT**3*cTT-cRT**2*cTT*anRrr*anT**2-2*cRT**2*cTT*a0r*anT**2-2*cRT**2*cTT*anTr**2*anR+cTTr*anT**2*cRT**2*anRr+cTTr*anT**2*cRT**2*a0+cRR*cTT**2*anRrr*anT**2+2*cRR*cTT**2*a0r*anT**2+2*cRR*cTT**2*anTr**2*anR+cST*ccRs*anT**3*cTT-cST**2*cTT*anRss*anT**2-cTTt*anT**2*cTT*cRT*a0-cTTt*anT**2*cTT*cRT*anRr-cTTt*anT**2*cTT*cST*anRs+cTTt*anT*cTT*cST*anTs*anR+cTTt*anT*cTT*cRT*anTr*anR-cTTt*anT**2*cTT*ccT*anR+2*cRT**2*cTT*anTr*anRr*anT+2*cRT**2*cTT*anTr*a0*anT+cRT**2*cTT*anTrr*anT*anR+2*cRT*cST*cTT*anTr*anRs*anT-2*cRT*cST*cTT*anRrs*anT**2-2*cRT*cST*cTT*a0s*anT**2-4*cRT*cST*cTT*anTr*anTs*anR+2*cRT*cST*cTT*anTs*anRr*anT+2*cRT*cST*cTT*anTs*a0*anT+2*cRT*cST*cTT*anTrs*anT*anR-2*cRT*ccT*anT**2*cTT*anRr-2*cRT*ccT*anT**2*cTT*a0+2*cRT*ccT*anT*cTT*anTr*anR-cRT*cRTr*anT**2*cTT*anRr-cRT*cRTr*anT**2*cTT*a0+cRT*cRTr*anT*cTT*anTr*anR-cRT*cSTr*anT**2*cTT*anRs+cRT*cSTr*anT*cTT*anTs*anR-cRT*ccTr*anT**2*cTT*anR-cTTr*anT*cRT**2*anTr*anR+cRT*cTTr*anT**2*cST*anRs+2*cST**2*cTT*anTs*anRs*anT+cST**2*cTT*anTss*anT*anR-2*cST*ccT*anT**2*cTT*anRs+2*cST*ccT*anT*cTT*anTs*anR-cST*cRTs*anT**2*cTT*anRr-cST*cRTs*anT**2*cTT*a0+cST*cRTs*anT*cTT*anTr*anR-cST*cSTs*anT**2*cTT*anRs+cST*cSTs*anT*cTT*anTs*anR-cST*ccTs*anT**2*cTT*anR+cST*cTTs*anT**2*cRT*anRr-cRT*cTTr*anT*cST*anTs*anR+cRT*cTTr*anT**2*ccT*anR-2*cRR*cTT**2*anTr*anRr*anT-2*cRR*cTT**2*anTr*a0*anT-cRR*cTT**2*anTrr*anT*anR-cTTs*anT*cST**2*anTs*anR+cST*cTTs*anT**2*ccT*anR-cRS*cTT**2*anTr*anRs*anT+2*cRS*cTT**2*anTr*anTs*anR-cRS*cTT**2*anTs*anRr*anT-cRS*cTT**2*anTs*a0*anT-cRS*cTT**2*anTrs*anT*anR-2*cSS*cTT**2*anTs*anRs*anT-cSS*cTT**2*anTss*anT*anR+ccR*anT**2*cTT**2*anRr+ccR*anT**2*cTT**2*a0+ccS*anT**2*cTT**2*anRs+c0*anT**2*cTT**2*anR+cRTt*anT**2*cTT**2*anRr+cRTt*anT**2*cTT**2*a0+cSTt*anT**2*cTT**2*anRs+ccTt*anT**2*cTT**2*anR+cST*cTTs*anT**2*cRT*a0-cST*cTTs*anT*cRT*anTr*anR-ccR*anT*cTT**2*anTr*anR-ccS*anT*cTT**2*anTs*anR-cRTt*anT*cTT**2*anTr*anR-cSTt*anT*cTT**2*anTs*anR)/anT**3/cTT**3
bsss= -(cST*cSS*anT**3*cTT+cSS*cTT**2*anS*anT**2-cST**2*cTT*anS*anT**2)/anT**3/cTT**3
bss = -(-cSSt*anT**3*cTT**2+cTTt*anT**3*cTT*cSS-cRT*cTTr*anT**3*cSS+cRT*cSSr*anT**3*cTT+cST*cSSs*anT**3*cTT+cST*ccS*anT**3*cTT-cST*cTTs*anT**3*cSS-2*cST**2*cTT*anSs*anT**2-cST**2*cTT*a0*anT**2+cTTs*anT**2*cST**2*anS+cRS*cTT**2*anSr*anT**2+2*cSS*cTT**2*anSs*anT**2+cSS*cTT**2*a0*anT**2+ccT*anT**3*cTT*cSS+ccS*anT**2*cTT**2*anS+cSTt*anT**2*cTT**2*anS-cTTt*anT**2*cTT*cST*anS-2*cRT*cST*cTT*anSr*anT**2+2*cRT*cST*cTT*anTr*anS*anT-cRT*cSTr*anT**2*cTT*anS+cRT*cTTr*anT**2*cST*anS+2*cST**2*cTT*anTs*anS*anT-2*cST*ccT*anT**2*cTT*anS-cST*cSTs*anT**2*cTT*anS-cRS*cTT**2*anTr*anS*anT-2*cSS*cTT**2*anTs*anS*anT)/anT**3/cTT**3
bs  = -(c0*anT**2*cTT**2*anS-ccSt*anT**3*cTT**2+cRTt*anT**2*cTT**2*anSr+cSTt*anT**2*cTT**2*anSs+cTTt*anT**3*cTT*ccS-cRT*cTTr*anT**3*ccS+cRT*ccSr*anT**3*cTT-cRT**2*cTT*anSrr*anT**2-2*cRT**2*cTT*anTr**2*anS+cTTr*anT**2*cRT**2*anSr+cRR*cTT**2*anSrr*anT**2+2*cRR*cTT**2*anTr**2*anS+cST*ccSs*anT**3*cTT+cST*c0*anT**3*cTT-cST*cTTs*anT**3*ccS-cST**2*cTT*anSss*anT**2-2*cST**2*cTT*a0s*anT**2-2*cST**2*cTT*anTs**2*anS+cTTs*anT**2*cST**2*anSs+cTTs*anT**2*cST**2*a0+cRS*cTT**2*anSrs*anT**2+cRS*cTT**2*a0r*anT**2+cSS*cTT**2*anSss*anT**2+2*cSS*cTT**2*a0s*anT**2+2*cSS*cTT**2*anTs**2*anS-ccT**2*anT**2*cTT*anS+ccT*anT**3*cTT*ccS+ccR*anT**2*cTT**2*anSr+ccS*anT**2*cTT**2*anSs+ccS*anT**2*cTT**2*a0-cTTt*anT**2*cTT*cRT*anSr+cTTt*anT*cTT*cRT*anTr*anS+cTTt*anT*cTT*cST*anTs*anS-cTTt*anT**2*cTT*cST*anSs-cTTt*anT**2*cTT*cST*a0+2*cRT**2*cTT*anTr*anSr*anT+2*cRT*cST*cTT*anTr*anSs*anT-cTTt*anT**2*cTT*ccT*anS+cRT**2*cTT*anTrr*anT*anS-2*cRT*cST*cTT*anSrs*anT**2-2*cRT*cST*cTT*a0r*anT**2+2*cRT*cST*cTT*anTr*a0*anT-4*cRT*cST*cTT*anTr*anTs*anS-2*cRT*ccT*anT**2*cTT*anSr+2*cRT*cST*cTT*anTs*anSr*anT+2*cRT*cST*cTT*anTrs*anT*anS+2*cRT*ccT*anT*cTT*anTr*anS-cRT*cRTr*anT**2*cTT*anSr+cRT*cRTr*anT*cTT*anTr*anS-cRT*cSTr*anT**2*cTT*anSs-cRT*cSTr*anT**2*cTT*a0+cRT*cSTr*anT*cTT*anTs*anS-cRT*ccTr*anT**2*cTT*anS-cTTr*anT*cRT**2*anTr*anS+cRT*cTTr*anT**2*cST*anSs+cRT*cTTr*anT**2*cST*a0-cRT*cTTr*anT*cST*anTs*anS+cRT*cTTr*anT**2*ccT*anS-2*cRR*cTT**2*anTr*anSr*anT-cRR*cTT**2*anTrr*anT*anS+2*cST**2*cTT*anTs*anSs*anT+2*cST**2*cTT*anTs*a0*anT+cST**2*cTT*anTss*anT*anS+2*cST*ccT*anT*cTT*anTs*anS-cST*cRTs*anT**2*cTT*anSr+cST*cRTs*anT*cTT*anTr*anS-cST*cSTs*anT**2*cTT*anSs-cST*cSTs*anT**2*cTT*a0+cST*cSTs*anT*cTT*anTs*anS-cST*ccTs*anT**2*cTT*anS+cST*cTTs*anT**2*cRT*anSr-cST*cTTs*anT*cRT*anTr*anS-cTTs*anT*cST**2*anTs*anS+cST*cTTs*anT**2*ccT*anS-cRS*cTT**2*anTr*anSs*anT-cRS*cTT**2*anTr*a0*anT+2*cRS*cTT**2*anTr*anTs*anS-cRS*cTT**2*anTs*anSr*anT-cRS*cTT**2*anTrs*anT*anS-2*cSS*cTT**2*anTs*anSs*anT-2*cSS*cTT**2*anTs*a0*anT-2*cST*ccT*anT**2*cTT*anSs-2*cST*ccT*anT**2*cTT*a0-ccS*anT*cTT**2*anTs*anS-cRTt*anT*cTT**2*anTr*anS+cSTt*anT**2*cTT**2*a0+ccTt*anT**2*cTT**2*anS-cSS*cTT**2*anTss*anT*anS-ccR*anT*cTT**2*anTr*anS-cSTt*anT*cTT**2*anTs*anS)/anT**3/cTT**3
brt = 0
bst = 0
brs = -(cTTt*anT**3*cTT*cRS+cRT*ccS*anT**3*cTT+cRT*cRSr*anT**3*cTT-cRT*cTTr*anT**3*cRS-2*cRT**2*cTT*anSr*anT**2+cTTr*anT**2*cRT**2*anS+2*cRR*cTT**2*anSr*anT**2+cST*cRSs*anT**3*cTT+cST*ccR*anT**3*cTT-cST*cTTs*anT**3*cRS-2*cST**2*cTT*anRs*anT**2+cTTs*anT**2*cST**2*anR+cRS*cTT**2*anRr*anT**2+cRS*cTT**2*anSs*anT**2+cRS*cTT**2*a0*anT**2+2*cSS*cTT**2*anRs*anT**2+ccT*anT**3*cTT*cRS+ccR*anT**2*cTT**2*anS+ccS*anT**2*cTT**2*anR+cRTt*anT**2*cTT**2*anS+cSTt*anT**2*cTT**2*anR-cRSt*anT**3*cTT**2-cTTt*anT**2*cTT*cRT*anS-cTTt*anT**2*cTT*cST*anR+2*cRT**2*cTT*anTr*anS*anT+2*cRT*cST*cTT*anTr*anR*anT-2*cRT*cST*cTT*anRr*anT**2-2*cRT*cST*cTT*anSs*anT**2-2*cRT*cST*cTT*a0*anT**2+2*cRT*cST*cTT*anTs*anS*anT-2*cRT*ccT*anT**2*cTT*anS-cRT*cRTr*anT**2*cTT*anS-cRT*cSTr*anT**2*cTT*anR+cRT*cTTr*anT**2*cST*anR-2*cRR*cTT**2*anTr*anS*anT-2*cST*ccT*anT**2*cTT*anR-cST*cRTs*anT**2*cTT*anS-cST*cSTs*anT**2*cTT*anR+cST*cTTs*anT**2*cRT*anS+2*cST**2*cTT*anTs*anR*anT-cRS*cTT**2*anTs*anS*anT-2*cSS*cTT**2*anTs*anR*anT-cRS*cTT**2*anTr*anR*anT)/anT**3/cTT**3
brrt= 0
brst= 0
bsst= 0
brrs= -(cRT*cRS*anT**3*cTT-cRT**2*cTT*anS*anT**2-2*cRT*cST*cTT*anR*anT**2+cRR*cTT**2*anS*anT**2+cST*cRR*anT**3*cTT+cRS*cTT**2*anR*anT**2)/anT**3/cTT**3
brss= -(cRT*cSS*anT**3*cTT-2*cRT*cST*cTT*anS*anT**2+cST*cRS*anT**3*cTT-cST**2*cTT*anR*anT**2+cRS*cTT**2*anS*anT**2+cSS*cTT**2*anR*anT**2)/anT**3/cTT**3
bf  = -(fft*anT**3*cTT**2+cTTt*anT**2*cTT*cRT*gr-cTTt*anT*cTT*cRT*anTr*g+cTTt*anT**2*cTT*cST*gs-cTTt*anT*cTT*cST*anTs*g+cTTt*anT**2*cTT*ccT*g-cTTt*anT**3*cTT*ff-cTTr*anT**2*cRT**2*gr+cRT**2*cTT*grr*anT**2+2*cRT**2*cTT*anTr**2*g-cRT*ffr*anT**3*cTT+cRT*cTTr*anT**3*ff-cRR*cTT**2*grr*anT**2-2*cRR*cTT**2*anTr**2*g+2*cST**2*cTT*anTs**2*g-cST*ffs*anT**3*cTT+cST**2*cTT*gss*anT**2-cTTs*anT**2*cST**2*gs+cST*cTTs*anT**3*ff-cRS*cTT**2*grs*anT**2-2*cSS*cTT**2*anTs**2*g-cSS*cTT**2*gss*anT**2+ccT**2*anT**2*cTT*g-ccT*anT**3*cTT*ff-ccR*anT**2*cTT**2*gr-ccS*anT**2*cTT**2*gs-c0*anT**2*cTT**2*g-cRTt*anT**2*cTT**2*gr-cSTt*anT**2*cTT**2*gs-ccTt*anT**2*cTT**2*g-cRT*cTTr*anT**2*ccT*g-cRT*cTTr*anT**2*cST*gs+2*cRT*cST*cTT*grs*anT**2+2*cRT*ccT*anT**2*cTT*gr+cRT*cRTr*anT**2*cTT*gr+cRT*cSTr*anT**2*cTT*gs+cRT*ccTr*anT**2*cTT*g-2*cRT**2*cTT*anTr*gr*anT-cRT**2*cTT*anTrr*anT*g-2*cRT*cST*cTT*anTr*gs*anT+4*cRT*cST*cTT*anTr*anTs*g-2*cRT*cST*cTT*anTs*gr*anT-2*cRT*cST*cTT*anTrs*anT*g-2*cRT*ccT*anT*cTT*anTr*g-cRT*cRTr*anT*cTT*anTr*g-cRT*cSTr*anT*cTT*anTs*g+cTTr*anT*cRT**2*anTr*g+cRT*cTTr*anT*cST*anTs*g+2*cRR*cTT**2*anTr*gr*anT+cRR*cTT**2*anTrr*anT*g+2*cST*ccT*anT**2*cTT*gs+cST*cRTs*anT**2*cTT*gr+cST*cSTs*anT**2*cTT*gs+cST*ccTs*anT**2*cTT*g-cST*cTTs*anT**2*cRT*gr-cST*cTTs*anT**2*ccT*g-2*cST**2*cTT*anTs*gs*anT-cST**2*cTT*anTss*anT*g-2*cST*ccT*anT*cTT*anTs*g-cST*cRTs*anT*cTT*anTr*g-cST*cSTs*anT*cTT*anTs*g+cST*cTTs*anT*cRT*anTr*g+cTTs*anT*cST**2*anTs*g+cRS*cTT**2*anTr*gs*anT-2*cRS*cTT**2*anTr*anTs*g+cRS*cTT**2*anTs*gr*anT+cRS*cTT**2*anTrs*anT*g+2*cSS*cTT**2*anTs*gs*anT+cSS*cTT**2*anTss*anT*g+ccR*anT*cTT**2*anTr*g+ccS*anT*cTT**2*anTs*g+cRTt*anT*cTT**2*anTr*g+cSTt*anT*cTT**2*anTs*g)/anT**3/cTT**3
#End
#End
#endMacro
