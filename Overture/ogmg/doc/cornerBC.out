Corner boundary conditions:
***3D General case: (3D fourth-order NOT valid for u(i1-1,i2-1,i3-1,n) since it appears in RHS)
u2(i1-m1,i2-m2,i3-m3,n) = -m1*u(i1+1,i2,i3,n)+m1*u(i1-1,i2,i3,n)-m2*u(i1,i2+1,i3,n)+m2*u(i1,i2-1,i3,n)-m3*u(i1,i2,i3+1,n)+m3*u(i1,i2,i3-1,n)+u(i1+m1,i2+m2,i3+m3,n)

u4(i1-m1,i2-m2,i3-m3,n)=(-12*m1**2*m3*u(i1+is1,i2,i3-1,n)+12*m1**2*m2*u(i1+is1,i2+1,i3,n)-6*m1*m2**2*u(i1+1,i2+2*is2,i3,n)-3*m1*m2*m3*is1*is2*is3*u(i1-is1,i2+is2,i3-is3,n)-3*m1*m2*m3*is1*is2*is3*u(i1-is1,i2-is2,i3+is3,n)+3*m1*m2*m3*is1*is2*is3*u(i1-is1,i2-is2,i3-is3,n)-12*m1**2*m2*u(i1+is1,i2-1,i3,n)-6*m2**2*m3*u(i1,i2+2*is2,i3+1,n)+12*m2**2*m3*u(i1,i2+is2,i3+1,n)+12*m1*m2**2*u(i1+1,i2+is2,i3,n)+12*m1**2*m3*u(i1+is1,i2,i3+1,n)-6*m1**2*m2*u(i1+2*is1,i2+1,i3,n)+6*m1**2*m3*u(i1+2*is1,i2,i3-1,n)+6*m1*m2**2*u(i1-1,i2+2*is2,i3,n)+6*m2**2*m3*u(i1,i2+2*is2,i3-1,n)-12*m2**2*m3*u(i1,i2+is2,i3-1,n)-6*m1*m3**2*u(i1+1,i2,i3+2*is3,n)+12*m1*m3**2*u(i1+1,i2,i3+is3,n)+6*m1*m3**2*u(i1-1,i2,i3+2*is3,n)-12*m1*m3**2*u(i1-1,i2,i3+is3,n)-6*m2*m3**2*u(i1,i2+1,i3+2*is3,n)+12*m2*m3**2*u(i1,i2+1,i3+is3,n)+6*m2*m3**2*u(i1,i2-1,i3+2*is3,n)-12*m2*m3**2*u(i1,i2-1,i3+is3,n)-6*m1**2*m3*u(i1+2*is1,i2,i3+1,n)+6*m1**2*m2*u(i1+2*is1,i2-1,i3,n)-12*m1*m2**2*u(i1-1,i2+is2,i3,n)-3*m1*m2*m3*is1*is2*is3*u(i1+is1,i2+is2,i3+is3,n)+3*m1*m2*m3*is1*is2*is3*u(i1+is1,i2+is2,i3-is3,n)+3*m1*m2*m3*is1*is2*is3*u(i1+is1,i2-is2,i3+is3,n)-3*m1*m2*m3*is1*is2*is3*u(i1+is1,i2-is2,i3-is3,n)+3*m1*m2*m3*is1*is2*is3*u(i1-is1,i2+is2,i3+is3,n)+(-6*m1*m3**2+4*m1**3-6*m1*m2**2-16*m1)*u(i1+1,i2,i3,n)+12*u(i1+m1,i2+m2,i3+m3,n)+(2*m3**3-2*m3)*u(i1,i2,i3-2,n)+(-4*m3**3+16*m3+6*m1**2*m3+6*m2**2*m3)*u(i1,i2,i3-1,n)+(-16*m3+4*m3**3-6*m1**2*m3-6*m2**2*m3)*u(i1,i2,i3+1,n)+(-2*m3**3+2*m3)*u(i1,i2,i3+2,n)+(2*m2**3-2*m2)*u(i1,i2-2,i3,n)+(6*m2*m3**2+16*m2+6*m1**2*m2-4*m2**3)*u(i1,i2-1,i3,n)+(-6*m2*m3**2-16*m2-6*m1**2*m2+4*m2**3)*u(i1,i2+1,i3,n)+(-2*m2**3+2*m2)*u(i1,i2+2,i3,n)+(-2*m1+2*m1**3)*u(i1-2,i2,i3,n)+(-4*m1**3+6*m1*m3**2+16*m1+6*m1*m2**2)*u(i1-1,i2,i3,n)+(2*m1-2*m1**3)*u(i1+2,i2,i3,n))/12.0

cc(-m1,-m2,-m3)=-1.;
cc(0,0,-2)=cc(0,0,-2)+(2*m3p3-2*m3)/12.0;
cc(0,0,-1)=cc(0,0,-1)+(-4*m3p3+16*m3+6*m1p2*m3+6*m2p2*m3)/12.0;
cc(0,-2,0)=cc(0,-2,0)+(2*m2p3-2*m2)/12.0;
cc(0,-1,0)=cc(0,-1,0)+(6*m2*m3p2+16*m2+6*m1p2*m2-4*m2p3)/12.0;
cc(-2,0,0)=cc(-2,0,0)+(-2*m1+2*m1p3)/12.0;
cc(-1,0,0)=cc(-1,0,0)+(-4*m1p3+6*m1*m3p2+16*m1+6*m1*m2p2)/12.0;
cc(1,0,0)=cc(1,0,0)+(-6*m1*m3p2+4*m1p3-6*m1*m2p2-16*m1)/12.0;
cc(2,0,0)=cc(2,0,0)+(2*m1-2*m1p3)/12.0;
cc(0,1,0)=cc(0,1,0)+(-6*m2*m3p2-16*m2-6*m1p2*m2+4*m2p3)/12.0;
cc(0,2,0)=cc(0,2,0)+(-2*m2p3+2*m2)/12.0;
cc(0,0,1)=cc(0,0,1)+(-16*m3+4*m3p3-6*m1p2*m3-6*m2p2*m3)/12.0;
cc(0,0,2)=cc(0,0,2)+(-2*m3p3+2*m3)/12.0;
cc(is1,0,-1)=cc(is1,0,-1)+(-12*m1p2*m3)/12.0;
cc(2*is1,0,-1)=cc(2*is1,0,-1)+(6*m1p2*m3)/12.0;
cc(is1,-1,0)=cc(is1,-1,0)+(-12*m1p2*m2)/12.0;
cc(2*is1,-1,0)=cc(2*is1,-1,0)+(6*m1p2*m2)/12.0;
cc(is1,1,0)=cc(is1,1,0)+(12*m1p2*m2)/12.0;
cc(2*is1,1,0)=cc(2*is1,1,0)+(-6*m1p2*m2)/12.0;
cc(is1,0,1)=cc(is1,0,1)+(12*m1p2*m3)/12.0;
cc(2*is1,0,1)=cc(2*is1,0,1)+(-6*m1p2*m3)/12.0;
cc(0,is2,-1)=cc(0,is2,-1)+(-12*m2p2*m3)/12.0;
cc(0,2*is2,-1)=cc(0,2*is2,-1)+(6*m2p2*m3)/12.0;
cc(-1,is2,0)=cc(-1,is2,0)+(-12*m1*m2p2)/12.0;
cc(1,is2,0)=cc(1,is2,0)+(12*m1*m2p2)/12.0;
cc(-1,2*is2,0)=cc(-1,2*is2,0)+(6*m1*m2p2)/12.0;
cc(1,2*is2,0)=cc(1,2*is2,0)+(-6*m1*m2p2)/12.0;
cc(0,is2,1)=cc(0,is2,1)+(12*m2p2*m3)/12.0;
cc(0,2*is2,1)=cc(0,2*is2,1)+(-6*m2p2*m3)/12.0;
cc(0,-1,is3)=cc(0,-1,is3)+(-12*m2*m3p2)/12.0;
cc(-1,0,is3)=cc(-1,0,is3)+(-12*m1*m3p2)/12.0;
cc(1,0,is3)=cc(1,0,is3)+(12*m1*m3p2)/12.0;
cc(0,1,is3)=cc(0,1,is3)+(12*m2*m3p2)/12.0;
cc(0,-1,2*is3)=cc(0,-1,2*is3)+(6*m2*m3p2)/12.0;
cc(-1,0,2*is3)=cc(-1,0,2*is3)+(6*m1*m3p2)/12.0;
cc(1,0,2*is3)=cc(1,0,2*is3)+(-6*m1*m3p2)/12.0;
cc(0,1,2*is3)=cc(0,1,2*is3)+(-6*m2*m3p2)/12.0;
cc(-is1,-is2,-is3)=cc(-is1,-is2,-is3)+(3*m1*m2*m3*is1*is2*is3)/12.0;
cc(is1,-is2,-is3)=cc(is1,-is2,-is3)+(-3*m1*m2*m3*is1*is2*is3)/12.0;
cc(-is1,is2,-is3)=cc(-is1,is2,-is3)+(-3*m1*m2*m3*is1*is2*is3)/12.0;
cc(is1,is2,-is3)=cc(is1,is2,-is3)+(3*m1*m2*m3*is1*is2*is3)/12.0;
cc(-is1,-is2,is3)=cc(-is1,-is2,is3)+(-3*m1*m2*m3*is1*is2*is3)/12.0;
cc(is1,-is2,is3)=cc(is1,-is2,is3)+(3*m1*m2*m3*is1*is2*is3)/12.0;
cc(-is1,is2,is3)=cc(-is1,is2,is3)+(3*m1*m2*m3*is1*is2*is3)/12.0;
cc(is1,is2,is3)=cc(is1,is2,is3)+(-3*m1*m2*m3*is1*is2*is3)/12.0;
cc(m1,m2,m3)=cc(m1,m2,m3)+(12)/12.0;
***3D Special case for u(i1-is1,i2-is2,i3-is3,n): (3D fourth-order is valid)
u2(i1-is1,i2-is2,i3-is3,n) = -is1*u(i1+1,i2,i3,n)+is1*u(i1-1,i2,i3,n)-is2*u(i1,i2+1,i3,n)+is2*u(i1,i2-1,i3,n)-is3*u(i1,i2,i3+1,n)+is3*u(i1,i2,i3-1,n)+u(i1+is1,i2+is2,i3+is3,n)

u4(i1-is1,i2-is2,i3-is3,n)=(-4*is3*u(i1+is1,i2,i3-1,n)+2*is3*u(i1+2*is1,i2,i3-1,n)+4*is3*u(i1+is1,i2,i3+1,n)-2*is3*u(i1+2*is1,i2,i3+1,n)-4*is2*u(i1+is1,i2-1,i3,n)+2*is2*u(i1+2*is1,i2-1,i3,n)+4*is2*u(i1+is1,i2+1,i3,n)-2*is2*u(i1+2*is1,i2+1,i3,n)+3*u(i1+is1,i2+is2,i3+is3,n)+u(i1+is1,i2+is2,i3-is3,n)+u(i1+is1,i2-is2,i3+is3,n)-u(i1+is1,i2-is2,i3-is3,n)+u(i1-is1,i2+is2,i3+is3,n)-u(i1-is1,i2+is2,i3-is3,n)-u(i1-is1,i2-is2,i3+is3,n)-2*is2*u(i1,i2+1,i3+2*is3,n)-4*is2*u(i1,i2-1,i3+is3,n)+4*is2*u(i1,i2+1,i3+is3,n)+2*is2*u(i1,i2-1,i3+2*is3,n)+2*is1*u(i1-1,i2,i3+2*is3,n)-2*is1*u(i1+1,i2+2*is2,i3,n)+2*is1*u(i1-1,i2+2*is2,i3,n)-4*is1*u(i1-1,i2,i3+is3,n)-2*is1*u(i1+1,i2,i3+2*is3,n)+4*is1*u(i1+1,i2,i3+is3,n)-4*is1*u(i1-1,i2+is2,i3,n)+4*is1*u(i1+1,i2+is2,i3,n)+2*is3*u(i1,i2+2*is2,i3-1,n)+4*is3*u(i1,i2+is2,i3+1,n)-2*is3*u(i1,i2+2*is2,i3+1,n)-8*is1*u(i1+1,i2,i3,n)+8*is1*u(i1-1,i2,i3,n)-8*is2*u(i1,i2+1,i3,n)+8*is2*u(i1,i2-1,i3,n)-8*is3*u(i1,i2,i3+1,n)+8*is3*u(i1,i2,i3-1,n)-4*is3*u(i1,i2+is2,i3-1,n))/3.0

cc(-m1,-m2,-m3)=-1.;
cc(0,0,-1)=cc(0,0,-1)+(8*is3)/3.0;
cc(0,-1,0)=cc(0,-1,0)+(8*is2)/3.0;
cc(-1,0,0)=cc(-1,0,0)+(8*is1)/3.0;
cc(1,0,0)=cc(1,0,0)+(-8*is1)/3.0;
cc(0,1,0)=cc(0,1,0)+(-8*is2)/3.0;
cc(0,0,1)=cc(0,0,1)+(-8*is3)/3.0;
cc(is1,0,-1)=cc(is1,0,-1)+(-4*is3)/3.0;
cc(2*is1,0,-1)=cc(2*is1,0,-1)+(2*is3)/3.0;
cc(is1,-1,0)=cc(is1,-1,0)+(-4*is2)/3.0;
cc(2*is1,-1,0)=cc(2*is1,-1,0)+(2*is2)/3.0;
cc(is1,1,0)=cc(is1,1,0)+(4*is2)/3.0;
cc(2*is1,1,0)=cc(2*is1,1,0)+(-2*is2)/3.0;
cc(is1,0,1)=cc(is1,0,1)+(4*is3)/3.0;
cc(2*is1,0,1)=cc(2*is1,0,1)+(-2*is3)/3.0;
cc(0,is2,-1)=cc(0,is2,-1)+(-4*is3)/3.0;
cc(0,2*is2,-1)=cc(0,2*is2,-1)+(2*is3)/3.0;
cc(-1,is2,0)=cc(-1,is2,0)+(-4*is1)/3.0;
cc(1,is2,0)=cc(1,is2,0)+(4*is1)/3.0;
cc(-1,2*is2,0)=cc(-1,2*is2,0)+(2*is1)/3.0;
cc(1,2*is2,0)=cc(1,2*is2,0)+(-2*is1)/3.0;
cc(0,is2,1)=cc(0,is2,1)+(4*is3)/3.0;
cc(0,2*is2,1)=cc(0,2*is2,1)+(-2*is3)/3.0;
cc(0,-1,is3)=cc(0,-1,is3)+(-4*is2)/3.0;
cc(-1,0,is3)=cc(-1,0,is3)+(-4*is1)/3.0;
cc(1,0,is3)=cc(1,0,is3)+(4*is1)/3.0;
cc(0,1,is3)=cc(0,1,is3)+(4*is2)/3.0;
cc(0,-1,2*is3)=cc(0,-1,2*is3)+(2*is2)/3.0;
cc(-1,0,2*is3)=cc(-1,0,2*is3)+(2*is1)/3.0;
cc(1,0,2*is3)=cc(1,0,2*is3)+(-2*is1)/3.0;
cc(0,1,2*is3)=cc(0,1,2*is3)+(-2*is2)/3.0;
cc(is1,-is2,-is3)=cc(is1,-is2,-is3)+(-1)/3.0;
cc(-is1,is2,-is3)=cc(-is1,is2,-is3)+(-1)/3.0;
cc(is1,is2,-is3)=cc(is1,is2,-is3)+(1)/3.0;
cc(-is1,-is2,is3)=cc(-is1,-is2,is3)+(-1)/3.0;
cc(is1,-is2,is3)=cc(is1,-is2,is3)+(1)/3.0;
cc(-is1,is2,is3)=cc(-is1,is2,is3)+(1)/3.0;
cc(is1,is2,is3)=cc(is1,is2,is3)+(3)/3.0;
cc(m1,m2,m3)=cc(m1,m2,m3)+(3)/3.0;
***2D General case
u2(i1-m1,i2-m2,i3,n) = -m1*u(i1+1,i2,i3,n)+m1*u(i1-1,i2,i3,n)-m2*u(i1,i2+1,i3,n)+m2*u(i1,i2-1,i3,n)+u(i1+m1,i2+m2,i3,n)

u4(i1-m1,i2-m2,i3,n)=((-m2+m2**3)*u(i1,i2-2,i3,n)+(3*m1**2*m2-2*m2**3+8*m2)*u(i1,i2-1,i3,n)+(-8*m2-3*m1**2*m2+2*m2**3)*u(i1,i2+1,i3,n)+(-m2**3+m2)*u(i1,i2+2,i3,n)+(m1**3-m1)*u(i1-2,i2,i3,n)+(-2*m1**3+8*m1+3*m1*m2**2)*u(i1-1,i2,i3,n)+(-8*m1+2*m1**3-3*m1*m2**2)*u(i1+1,i2,i3,n)+(m1-m1**3)*u(i1+2,i2,i3,n)+6*m1**2*m2*u(i1+is1,i2+1,i3,n)+6*u(i1+m1,i2+m2,i3,n)-3*m1**2*m2*u(i1+2*is1,i2+1,i3,n)-6*m1**2*m2*u(i1+is1,i2-1,i3,n)+3*m1*m2**2*u(i1-1,i2+2*is2,i3,n)+6*m1*m2**2*u(i1+1,i2+is2,i3,n)-6*m1*m2**2*u(i1-1,i2+is2,i3,n)-3*m1*m2**2*u(i1+1,i2+2*is2,i3,n)+3*m1**2*m2*u(i1+2*is1,i2-1,i3,n))/6.0

cc(-m1,-m2,-m3)=-1.;
cc(0,-2,0)=cc(0,-2,0)+(-m2+m2p3)/6.0;
cc(0,-1,0)=cc(0,-1,0)+(3*m1p2*m2-2*m2p3+8*m2)/6.0;
cc(-2,0,0)=cc(-2,0,0)+(m1p3-m1)/6.0;
cc(-1,0,0)=cc(-1,0,0)+(-2*m1p3+8*m1+3*m1*m2p2)/6.0;
cc(1,0,0)=cc(1,0,0)+(-8*m1+2*m1p3-3*m1*m2p2)/6.0;
cc(2,0,0)=cc(2,0,0)+(m1-m1p3)/6.0;
cc(0,1,0)=cc(0,1,0)+(-8*m2-3*m1p2*m2+2*m2p3)/6.0;
cc(0,2,0)=cc(0,2,0)+(-m2p3+m2)/6.0;
cc(is1,-1,0)=cc(is1,-1,0)+(-6*m1p2*m2)/6.0;
cc(2*is1,-1,0)=cc(2*is1,-1,0)+(3*m1p2*m2)/6.0;
cc(is1,1,0)=cc(is1,1,0)+(6*m1p2*m2)/6.0;
cc(2*is1,1,0)=cc(2*is1,1,0)+(-3*m1p2*m2)/6.0;
cc(-1,is2,0)=cc(-1,is2,0)+(-6*m1*m2p2)/6.0;
cc(1,is2,0)=cc(1,is2,0)+(6*m1*m2p2)/6.0;
cc(-1,2*is2,0)=cc(-1,2*is2,0)+(3*m1*m2p2)/6.0;
cc(1,2*is2,0)=cc(1,2*is2,0)+(-3*m1*m2p2)/6.0;
cc(m1,m2,m3)=cc(m1,m2,m3)+(6)/6.0;
***2D Special case for u(i1-is1,i2-is2,i3,n) 
u2(i1-is1,i2-is2,i3,n) = -is1*u(i1+1,i2,i3,n)+is1*u(i1-1,i2,i3,n)-is2*u(i1,i2+1,i3,n)+is2*u(i1,i2-1,i3,n)+u(i1+is1,i2+is2,i3,n)

u4(i1-is1,i2-is2,i3,n)=(2*is1*u(i1+1,i2+is2,i3,n)-2*is1*u(i1-1,i2+is2,i3,n)-3*is1*u(i1+1,i2,i3,n)+3*is1*u(i1-1,i2,i3,n)-is1*u(i1+1,i2+2*is2,i3,n)+is1*u(i1-1,i2+2*is2,i3,n)+2*is2*u(i1+is1,i2+1,i3,n)-is2*u(i1+2*is1,i2+1,i3,n)+3*is2*u(i1,i2-1,i3,n)+is2*u(i1+2*is1,i2-1,i3,n)-2*is2*u(i1+is1,i2-1,i3,n)-3*is2*u(i1,i2+1,i3,n)+2*u(i1+is1,i2+is2,i3,n))/2.0

cc(-m1,-m2,-m3)=-1.;
cc(0,-1,0)=cc(0,-1,0)+(3*is2)/2.0;
cc(-1,0,0)=cc(-1,0,0)+(3*is1)/2.0;
cc(1,0,0)=cc(1,0,0)+(-3*is1)/2.0;
cc(0,1,0)=cc(0,1,0)+(-3*is2)/2.0;
cc(is1,-1,0)=cc(is1,-1,0)+(-2*is2)/2.0;
cc(2*is1,-1,0)=cc(2*is1,-1,0)+(is2)/2.0;
cc(is1,1,0)=cc(is1,1,0)+(2*is2)/2.0;
cc(2*is1,1,0)=cc(2*is1,1,0)+(-is2)/2.0;
cc(-1,is2,0)=cc(-1,is2,0)+(-2*is1)/2.0;
cc(1,is2,0)=cc(1,is2,0)+(2*is1)/2.0;
cc(-1,2*is2,0)=cc(-1,2*is2,0)+(is1)/2.0;
cc(1,2*is2,0)=cc(1,2*is2,0)+(-is1)/2.0;
cc(is1,is2,0)=cc(is1,is2,0)+(2)/2.0;
cc(m1,m2,m3)=cc(m1,m2,m3)+(2)/2.0;
